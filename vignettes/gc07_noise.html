<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Mike Blazanin" />


<title>Dealing with noise</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Dealing with noise</h1>
<h4 class="author">Mike Blazanin</h4>


<div id="TOC">
<ul>
<li><a href="#where-are-we-so-far" id="toc-where-are-we-so-far">Where
are we so far?</a></li>
<li><a href="#introduction" id="toc-introduction">Introduction</a></li>
<li><a href="#FittingDeriv" id="toc-FittingDeriv">Fitting during
derivative calculation</a></li>
<li><a href="#Smoothing" id="toc-Smoothing">Smoothing raw data</a>
<ul>
<li><a href="#smoothing-with-moving-average" id="toc-smoothing-with-moving-average">Smoothing with
moving-average</a></li>
<li><a href="#smoothing-with-moving-median" id="toc-smoothing-with-moving-median">Smoothing with
moving-median</a></li>
<li><a href="#smoothing-with-loess" id="toc-smoothing-with-loess">Smoothing with LOESS</a></li>
<li><a href="#smoothing-with-gam" id="toc-smoothing-with-gam">Smoothing
with GAM</a></li>
<li><a href="#combining-multiple-smoothing-methods" id="toc-combining-multiple-smoothing-methods">Combining multiple
smoothing methods</a></li>
</ul></li>
<li><a href="#DerivsOfSmoothed" id="toc-DerivsOfSmoothed">Calculating
derivatives of smoothed data</a></li>
<li><a href="#SubsetAnalysis" id="toc-SubsetAnalysis">Summarizing on
subsets of derivatives</a></li>
<li><a href="#whats-next" id="toc-whats-next">What’s next?</a></li>
</ul>
</div>

<div id="where-are-we-so-far" class="section level1">
<h1>Where are we so far?</h1>
<ol style="list-style-type: decimal">
<li>Introduction: <code>vignette(&quot;gc01_gcplyr&quot;)</code></li>
<li>Importing and transforming data:
<code>vignette(&quot;gc02_import_transform&quot;)</code></li>
<li>Incorporating design information:
<code>vignette(&quot;gc03_incorporate_designs&quot;)</code></li>
<li>Pre-processing and plotting your data:
<code>vignette(&quot;gc04_preprocess_plot&quot;)</code></li>
<li>Processing your data: <code>vignette(&quot;gc05_process&quot;)</code></li>
<li>Analyzing your data: <code>vignette(&quot;gc06_analyze&quot;)</code></li>
<li><strong>Dealing with noise:</strong>
<code>vignette(&quot;gc07_noise&quot;)</code></li>
<li>Statistics, merging other data, and other resources:
<code>vignette(&quot;gc08_conclusion&quot;)</code></li>
<li>Working with multiple plates:
<code>vignette(&quot;gc09_multiple_plates&quot;)</code></li>
</ol>
<p>So far, we’ve imported and transformed our measures, combined them
with our design information, pre-processed, processed, plotted, and
analyzed our data. Here, we’re going to learn potential strategies for
dealing with noise in our growth curve data.</p>
<p>If you haven’t already, load the necessary packages.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">library</span>(gcplyr)</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="co"># This code was previously explained</span></span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a><span class="co"># Here we&#39;re re-running it so it&#39;s available for us to work with</span></span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a>example_design <span class="ot">&lt;-</span> <span class="fu">make_design</span>(</span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a>  <span class="at">pattern_split =</span> <span class="st">&quot;,&quot;</span>, <span class="at">nrows =</span> <span class="dv">8</span>, <span class="at">ncols =</span> <span class="dv">12</span>,</span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a>  <span class="st">&quot;Bacteria_strain&quot;</span> <span class="ot">=</span> <span class="fu">make_designpattern</span>(</span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">paste</span>(<span class="st">&quot;Strain&quot;</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">48</span>),</span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a>    <span class="at">rows =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>, <span class="at">cols =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>, <span class="at">pattern =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">48</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>),</span>
<span id="cb2-8"><a href="#cb2-8" tabindex="-1"></a>  <span class="st">&quot;Bacteria_strain&quot;</span> <span class="ot">=</span> <span class="fu">make_designpattern</span>(</span>
<span id="cb2-9"><a href="#cb2-9" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">paste</span>(<span class="st">&quot;Strain&quot;</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">48</span>),</span>
<span id="cb2-10"><a href="#cb2-10" tabindex="-1"></a>    <span class="at">rows =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>, <span class="at">cols =</span> <span class="dv">7</span><span class="sc">:</span><span class="dv">12</span>, <span class="at">pattern =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">48</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>),</span>
<span id="cb2-11"><a href="#cb2-11" tabindex="-1"></a>  <span class="st">&quot;Phage&quot;</span> <span class="ot">=</span> <span class="fu">make_designpattern</span>(</span>
<span id="cb2-12"><a href="#cb2-12" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;No Phage&quot;</span>), <span class="at">rows =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>, <span class="at">cols =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>, <span class="at">pattern =</span> <span class="st">&quot;1&quot;</span>),</span>
<span id="cb2-13"><a href="#cb2-13" tabindex="-1"></a>  <span class="st">&quot;Phage&quot;</span> <span class="ot">=</span> <span class="fu">make_designpattern</span>(</span>
<span id="cb2-14"><a href="#cb2-14" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;Phage Added&quot;</span>), <span class="at">rows =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>, <span class="at">cols =</span> <span class="dv">7</span><span class="sc">:</span><span class="dv">12</span>, <span class="at">pattern =</span> <span class="st">&quot;1&quot;</span>))</span></code></pre></div>
</div>
<div id="introduction" class="section level1">
<h1>Introduction</h1>
<p>Oftentimes, growth curve data produced by a plate reader will have
some noise it it. Since <code>gcplyr</code> does model-free analyses,
our approach can sometimes be sensitive to noise, necessitating steps to
reduce the effects of noise.</p>
<p>When assessing the effects of noise in our data, one of the first
steps is simply to visualize our data, including both the raw data and
any derivatives we’ll be analyzing. This is especially important because
per-capita derivatives can be very sensitive to noise, especially when
density is low. By visualizing our data, we can assess whether the noise
we see is likely to throw off our analyses.</p>
<p>Broadly speaking, there are three strategies we can use to deal with
noise:</p>
<ul>
<li><a href="#FittingDeriv">Using fitting during derivative
calculations</a></li>
<li><a href="#Smoothing">Smooth the raw data</a></li>
<li><a href="#SubsetAnalysis">Exclude low-density data points</a></li>
</ul>
<p>Let’s start by pulling out some example data. The example data here
is the same example data we’ve been working with, along with a version
of that data with simulated noise added to it.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a>ex_dat_mrg <span class="ot">&lt;-</span> <span class="fu">make_example</span>(<span class="at">vignette =</span> <span class="dv">7</span>, <span class="at">example =</span> <span class="dv">1</span>)</span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a><span class="co">#&gt; Joining with `by = join_by(Time, Well, Measurements, noise)`</span></span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a><span class="co">#&gt; Warning in merge_dfs(noisy_data, noiseless_data): </span></span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a><span class="co">#&gt; merged_df has more rows than x and than y, this may indicate</span></span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a><span class="co">#&gt;                mis-matched values in the shared column(s) used to merge </span></span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a><span class="co">#&gt;               (e.g. &#39;Well&#39;)</span></span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a><span class="co">#&gt; Joining with `by = join_by(Well)`</span></span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a></span>
<span id="cb3-9"><a href="#cb3-9" tabindex="-1"></a><span class="co"># Plot with a log y-axis</span></span>
<span id="cb3-10"><a href="#cb3-10" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(ex_dat_mrg, noise <span class="sc">==</span> <span class="st">&quot;Yes&quot;</span>),</span>
<span id="cb3-11"><a href="#cb3-11" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> Time, <span class="at">y =</span> Measurements)) <span class="sc">+</span></span>
<span id="cb3-12"><a href="#cb3-12" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb3-13"><a href="#cb3-13" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(ex_dat_mrg, noise <span class="sc">==</span> <span class="st">&quot;No&quot;</span>),</span>
<span id="cb3-14"><a href="#cb3-14" tabindex="-1"></a>            <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb3-15"><a href="#cb3-15" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Well) <span class="sc">+</span></span>
<span id="cb3-16"><a href="#cb3-16" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">trans =</span> <span class="st">&quot;log10&quot;</span>)</span>
<span id="cb3-17"><a href="#cb3-17" tabindex="-1"></a><span class="co">#&gt; Warning: Transformation introduced infinite values in continuous y-axis</span></span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Great! Here we can see how the noisy (points) and noiseless (red
line) data compare. We’ve plotted our data with log-transformed y-axes,
which are useful because exponential growth is a straight line when
plotted on a log scale. log axes also reveal another common pattern:
<strong>random noise tends to have a much larger effect at low
densities</strong>.</p>
<p>This level of noise doesn’t seem like it would mess up calculations
of maximum density or area under the curve much, so that’s not enough of
a reason to smooth. But let’s look at what our derivatives look
like.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a>ex_dat_mrg <span class="ot">&lt;-</span> </span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">group_by</span>(ex_dat_mrg, Well, Bacteria_strain, Phage, noise),</span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a>         <span class="at">deriv_2 =</span> <span class="fu">calc_deriv</span>(<span class="at">x =</span> Time, <span class="at">y =</span> Measurements),</span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a>         <span class="at">derivpercap_2 =</span> <span class="fu">calc_deriv</span>(<span class="at">x =</span> Time, <span class="at">y =</span> Measurements,</span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a>                                   <span class="at">percapita =</span> <span class="cn">TRUE</span>, <span class="at">blank =</span> <span class="dv">0</span>))</span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a></span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a><span class="co"># Plot derivative</span></span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(ex_dat_mrg, noise <span class="sc">==</span> <span class="st">&quot;Yes&quot;</span>),</span>
<span id="cb4-9"><a href="#cb4-9" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> Time, <span class="at">y =</span> deriv_2)) <span class="sc">+</span></span>
<span id="cb4-10"><a href="#cb4-10" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb4-11"><a href="#cb4-11" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(ex_dat_mrg, noise <span class="sc">==</span> <span class="st">&quot;No&quot;</span>),</span>
<span id="cb4-12"><a href="#cb4-12" tabindex="-1"></a>            <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb4-13"><a href="#cb4-13" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Well, <span class="at">scales =</span> <span class="st">&quot;free_y&quot;</span>)</span>
<span id="cb4-14"><a href="#cb4-14" tabindex="-1"></a><span class="co">#&gt; Warning: Removed 4 rows containing missing values (`geom_point()`).</span></span>
<span id="cb4-15"><a href="#cb4-15" tabindex="-1"></a><span class="co">#&gt; Warning: Removed 1 row containing missing values (`geom_line()`).</span></span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a></span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a><span class="co"># Plot per-capita derivative</span></span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(ex_dat_mrg, noise <span class="sc">==</span> <span class="st">&quot;Yes&quot;</span>),</span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> Time, <span class="at">y =</span> derivpercap_2)) <span class="sc">+</span></span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(ex_dat_mrg, noise <span class="sc">==</span> <span class="st">&quot;No&quot;</span>),</span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a>            <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb5-8"><a href="#cb5-8" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Well, <span class="at">scales =</span> <span class="st">&quot;free_y&quot;</span>)</span>
<span id="cb5-9"><a href="#cb5-9" tabindex="-1"></a><span class="co">#&gt; Warning: Removed 8 rows containing missing values (`geom_point()`).</span></span>
<span id="cb5-10"><a href="#cb5-10" tabindex="-1"></a><span class="co">#&gt; Removed 1 row containing missing values (`geom_line()`).</span></span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Those values are jumping all over the place, including some where the
growth rate was calculated as infinite! Let’s see what we can do to
address this.</p>
</div>
<div id="FittingDeriv" class="section level1">
<h1>Fitting during derivative calculation</h1>
<p>One thing we can do is calculate derivatives by fitting a line to a
moving window of multiple points. (You might recall we previously used
this in the Calculating Derivatives article
<code>vignette(&quot;gc05_process&quot;)</code>.)</p>
<p>To use the fitting functionality of <code>calc_deriv</code>, specify
either the <code>window_width</code> or the <code>window_width_n</code>
parameter. <code>window_width</code> specifies how wide the window used
to include points for the fitting is in units of <code>x</code>, while
<code>window_width_n</code> specifies it in number of data points. Wider
windows will be more smoothed. Note that when using
<code>calc_deriv</code> in this way, you should use <em>as few</em>
points as is necessary for your analyses to work, so you should
visualize different window widths and choose the smallest one that is
sufficient for your analyses to succeed.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a>ex_dat_mrg <span class="ot">&lt;-</span> </span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">group_by</span>(ex_dat_mrg, Well, Bacteria_strain, Phage, noise),</span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a>         <span class="at">deriv_5 =</span> <span class="fu">calc_deriv</span>(<span class="at">x =</span> Time, <span class="at">y =</span> Measurements,</span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a>                            <span class="at">window_width_n =</span> <span class="dv">5</span>),</span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a>         <span class="at">derivpercap_5 =</span> <span class="fu">calc_deriv</span>(<span class="at">x =</span> Time, <span class="at">y =</span> Measurements,</span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a>                                   <span class="at">percapita =</span> <span class="cn">TRUE</span>, <span class="at">blank =</span> <span class="dv">0</span>,</span>
<span id="cb6-7"><a href="#cb6-7" tabindex="-1"></a>                                   <span class="at">window_width_n =</span> <span class="dv">5</span>),</span>
<span id="cb6-8"><a href="#cb6-8" tabindex="-1"></a>         <span class="at">deriv_9 =</span> <span class="fu">calc_deriv</span>(<span class="at">x =</span> Time, <span class="at">y =</span> Measurements,</span>
<span id="cb6-9"><a href="#cb6-9" tabindex="-1"></a>                            <span class="at">window_width_n =</span> <span class="dv">9</span>),</span>
<span id="cb6-10"><a href="#cb6-10" tabindex="-1"></a>         <span class="at">derivpercap_9 =</span> <span class="fu">calc_deriv</span>(<span class="at">x =</span> Time, <span class="at">y =</span> Measurements,</span>
<span id="cb6-11"><a href="#cb6-11" tabindex="-1"></a>                                   <span class="at">percapita =</span> <span class="cn">TRUE</span>, <span class="at">blank =</span> <span class="dv">0</span>,</span>
<span id="cb6-12"><a href="#cb6-12" tabindex="-1"></a>                                   <span class="at">window_width_n =</span> <span class="dv">9</span>))</span>
<span id="cb6-13"><a href="#cb6-13" tabindex="-1"></a><span class="co">#Reshape our data for plotting purposes</span></span>
<span id="cb6-14"><a href="#cb6-14" tabindex="-1"></a>ex_dat_mrg_wide <span class="ot">&lt;-</span> </span>
<span id="cb6-15"><a href="#cb6-15" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(ex_dat_mrg, <span class="at">cols =</span> <span class="fu">starts_with</span>(<span class="st">&quot;deriv&quot;</span>),</span>
<span id="cb6-16"><a href="#cb6-16" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="fu">c</span>(<span class="st">&quot;deriv&quot;</span>, <span class="st">&quot;window_width_n&quot;</span>), <span class="at">names_sep =</span> <span class="st">&quot;_&quot;</span>)</span>
<span id="cb6-17"><a href="#cb6-17" tabindex="-1"></a>ex_dat_mrg_wide <span class="ot">&lt;-</span> </span>
<span id="cb6-18"><a href="#cb6-18" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(ex_dat_mrg_wide, <span class="at">names_from =</span> deriv, <span class="at">values_from =</span> value)</span>
<span id="cb6-19"><a href="#cb6-19" tabindex="-1"></a>                               </span>
<span id="cb6-20"><a href="#cb6-20" tabindex="-1"></a><span class="co">#Plot derivative</span></span>
<span id="cb6-21"><a href="#cb6-21" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(ex_dat_mrg_wide, noise <span class="sc">==</span> <span class="st">&quot;Yes&quot;</span>),</span>
<span id="cb6-22"><a href="#cb6-22" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> Time, <span class="at">y =</span> deriv)) <span class="sc">+</span></span>
<span id="cb6-23"><a href="#cb6-23" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">color =</span> window_width_n), <span class="at">lwd =</span> <span class="dv">1</span>, <span class="at">alpha =</span> <span class="fl">0.75</span>) <span class="sc">+</span></span>
<span id="cb6-24"><a href="#cb6-24" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Well, <span class="at">scales =</span> <span class="st">&quot;free_y&quot;</span>) <span class="sc">+</span></span>
<span id="cb6-25"><a href="#cb6-25" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(ex_dat_mrg_wide, </span>
<span id="cb6-26"><a href="#cb6-26" tabindex="-1"></a>                                 noise <span class="sc">==</span> <span class="st">&quot;No&quot;</span>, window_width_n <span class="sc">==</span> <span class="dv">2</span>),</span>
<span id="cb6-27"><a href="#cb6-27" tabindex="-1"></a>            <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb6-28"><a href="#cb6-28" tabindex="-1"></a>  <span class="fu">scale_color_grey</span>(<span class="at">start =</span> <span class="fl">0.7</span>, <span class="at">end =</span> <span class="fl">0.1</span>)</span>
<span id="cb6-29"><a href="#cb6-29" tabindex="-1"></a><span class="co">#&gt; Warning: Removed 13 rows containing missing values (`geom_line()`).</span></span>
<span id="cb6-30"><a href="#cb6-30" tabindex="-1"></a><span class="co">#&gt; Warning: Removed 1 row containing missing values (`geom_line()`).</span></span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a>       </span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a><span class="co">#Plot per-capita derivative</span></span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(ex_dat_mrg_wide, noise <span class="sc">==</span> <span class="st">&quot;Yes&quot;</span>),</span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> Time, <span class="at">y =</span> derivpercap)) <span class="sc">+</span></span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">color =</span> window_width_n), <span class="at">lwd =</span> <span class="dv">1</span>, <span class="at">alpha =</span> <span class="fl">0.75</span>) <span class="sc">+</span></span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Well, <span class="at">scales =</span> <span class="st">&quot;free_y&quot;</span>) <span class="sc">+</span></span>
<span id="cb7-7"><a href="#cb7-7" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(ex_dat_mrg_wide,</span>
<span id="cb7-8"><a href="#cb7-8" tabindex="-1"></a>                                 noise <span class="sc">==</span> <span class="st">&quot;No&quot;</span>, window_width_n <span class="sc">==</span> <span class="dv">5</span>),</span>
<span id="cb7-9"><a href="#cb7-9" tabindex="-1"></a>            <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb7-10"><a href="#cb7-10" tabindex="-1"></a>  <span class="fu">scale_color_grey</span>(<span class="at">start =</span> <span class="fl">0.7</span>, <span class="at">end =</span> <span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb7-11"><a href="#cb7-11" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="cn">NA</span>, <span class="dv">5</span>)</span>
<span id="cb7-12"><a href="#cb7-12" tabindex="-1"></a><span class="co">#&gt; Warning: Removed 14 rows containing missing values (`geom_line()`).</span></span>
<span id="cb7-13"><a href="#cb7-13" tabindex="-1"></a><span class="co">#&gt; Warning: Removed 4 rows containing missing values (`geom_line()`).</span></span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>As we can see, increasing the width of the window reduces the effects
of noise, getting us closer to the noiseless data (red line). However,
if we go too far (like <code>window_width_n = 9</code> for the plain
derivative), we’ll start over-smoothing our data, making peaks shorter
and valleys shallower.</p>
</div>
<div id="Smoothing" class="section level1">
<h1>Smoothing raw data</h1>
<p>Smoothing raw density data is a straightforward approach to reduce
the effects of noise. <code>gcplyr</code> has a <code>smooth_data</code>
function that can carry out such smoothing. <code>smooth_data</code> has
four different smoothing algorithms to choose from:
<code>moving-average</code>, <code>moving-median</code>,
<code>loess</code>, and <code>gam</code>.</p>
<ul>
<li><code>moving-average</code> is a simple smoothing algorithm that
primarily acts to reduce the effects of outliers on the data</li>
<li><code>moving-median</code> is another simple smoothing algorithm
that primarily acts to reduce the effects of outliers on the data</li>
<li><code>loess</code> is a spline-fitting approach that uses
polynomial-like curves, which produces curves with smoothly changing
derivatives, but can in some cases create curvature artifacts not
present in the original data</li>
<li><code>gam</code> is also spline-fitting approach that uses
polynomial-like curves, which produces curves with smoothly changing
derivatives, but can in some cases create curvature artifacts not
present in the original data</li>
</ul>
<p><strong>Additionally, all four smoothing algorithms have a tuning
parameter</strong> that controls how “smoothed” the data are.</p>
<p>Smoothing data is a step that alters the values you will analyze.
Because of that it can be rife with pitfalls. You should strive to do
<em>as little</em> smoothing as is necessary for your analyses to work.
To do so, run smoothing with different tuning parameter values and plot
the results. Then, choose the parameter value that smooths the data as
little as necessary. Additionally, when sharing your findings, it’s
important to be transparent by sharing the raw data and smoothing
methods, rather than treating the smoothed data as your source.</p>
<p>To use <code>smooth_data</code>, pass your x and y values, your
method of choice, and any additional arguments needed for the method. It
will return a vector of your smoothed y values.</p>
<div id="smoothing-with-moving-average" class="section level2">
<h2>Smoothing with moving-average</h2>
<p>For <code>moving-average</code>, there are two tuning parameters to
choose between: <code>window_width</code> specifies how wide the window
used to include points for the fitting is in units of <code>x</code>,
while <code>window_width_n</code> specifies it in number of data points.
Wider windows will be more smoothed. Here, we’ll show moving averages
with <code>window_width_n</code> values of 5 or 9 data points wide
(<code>movavg_1</code> is just our raw, unsmoothed data).</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a>ex_dat_mrg <span class="ot">&lt;-</span></span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">group_by</span>(ex_dat_mrg, Well, Bacteria_strain, Phage, noise),</span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a>         <span class="at">movavg_1 =</span> Measurements,</span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a>         <span class="at">movavg_5 =</span> <span class="fu">smooth_data</span>(<span class="at">x =</span> Time, <span class="at">y =</span> Measurements,</span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a>              <span class="at">sm_method =</span> <span class="st">&quot;moving-average&quot;</span>, <span class="at">window_width_n =</span> <span class="dv">5</span>),</span>
<span id="cb8-6"><a href="#cb8-6" tabindex="-1"></a>         <span class="at">movavg_9 =</span> <span class="fu">smooth_data</span>(<span class="at">x =</span> Time, <span class="at">y =</span> Measurements,</span>
<span id="cb8-7"><a href="#cb8-7" tabindex="-1"></a>              <span class="at">sm_method =</span> <span class="st">&quot;moving-average&quot;</span>, <span class="at">window_width_n =</span> <span class="dv">9</span>))</span>
<span id="cb8-8"><a href="#cb8-8" tabindex="-1"></a></span>
<span id="cb8-9"><a href="#cb8-9" tabindex="-1"></a><span class="co">#Reshape our data for plotting purposes</span></span>
<span id="cb8-10"><a href="#cb8-10" tabindex="-1"></a>ex_dat_mrg_wide <span class="ot">&lt;-</span> </span>
<span id="cb8-11"><a href="#cb8-11" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(ex_dat_mrg, <span class="at">cols =</span> <span class="fu">starts_with</span>(<span class="st">&quot;movavg&quot;</span>),</span>
<span id="cb8-12"><a href="#cb8-12" tabindex="-1"></a>               <span class="at">names_prefix =</span> <span class="st">&quot;movavg_&quot;</span>, <span class="at">names_to =</span> <span class="st">&quot;window_width_n&quot;</span>)</span>
<span id="cb8-13"><a href="#cb8-13" tabindex="-1"></a></span>
<span id="cb8-14"><a href="#cb8-14" tabindex="-1"></a><span class="co">#Plot data</span></span>
<span id="cb8-15"><a href="#cb8-15" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(ex_dat_mrg_wide, noise <span class="sc">==</span> <span class="st">&quot;Yes&quot;</span>),</span>
<span id="cb8-16"><a href="#cb8-16" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> Time, <span class="at">y =</span> value)) <span class="sc">+</span></span>
<span id="cb8-17"><a href="#cb8-17" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">color =</span> window_width_n), <span class="at">lwd =</span> <span class="dv">1</span>, <span class="at">alpha =</span> <span class="fl">0.75</span>) <span class="sc">+</span></span>
<span id="cb8-18"><a href="#cb8-18" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Well, <span class="at">scales =</span> <span class="st">&quot;free_y&quot;</span>) <span class="sc">+</span></span>
<span id="cb8-19"><a href="#cb8-19" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(ex_dat_mrg_wide,</span>
<span id="cb8-20"><a href="#cb8-20" tabindex="-1"></a>                                 noise <span class="sc">==</span> <span class="st">&quot;No&quot;</span>, window_width_n <span class="sc">==</span> <span class="dv">1</span>),</span>
<span id="cb8-21"><a href="#cb8-21" tabindex="-1"></a>            <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb8-22"><a href="#cb8-22" tabindex="-1"></a>  <span class="fu">scale_color_grey</span>(<span class="at">start =</span> <span class="fl">0.7</span>, <span class="at">end =</span> <span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb8-23"><a href="#cb8-23" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>() <span class="sc">+</span></span>
<span id="cb8-24"><a href="#cb8-24" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;moving-average&quot;</span>)</span>
<span id="cb8-25"><a href="#cb8-25" tabindex="-1"></a><span class="co">#&gt; Warning: Transformation introduced infinite values in continuous y-axis</span></span>
<span id="cb8-26"><a href="#cb8-26" tabindex="-1"></a><span class="co">#&gt; Warning: Removed 12 rows containing missing values (`geom_line()`).</span></span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Here we can see that <code>moving-average</code> has helped reduce
the effects of some of that early noise. However, as the window width
gets larger, it also starts underrepresenting the maximum density peaks
relative to the true value (red line).</p>
</div>
<div id="smoothing-with-moving-median" class="section level2">
<h2>Smoothing with moving-median</h2>
<p>For <code>moving-median</code>, there are the same two tuning
parameters: <code>window_width</code> specifies how wide the window used
to include points for the fitting is in units of <code>x</code>, while
<code>window_width_n</code> specifies it in number of data points. Wider
windows will be more smoothed. Here, we’ll show moving medians with
windows that are 5 and 9 data points wide (<code>movemed_1</code> is
just our raw, unsmoothed data).</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a>ex_dat_mrg <span class="ot">&lt;-</span></span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">group_by</span>(ex_dat_mrg, Well, Bacteria_strain, Phage, noise),</span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a>         <span class="at">movmed_1 =</span> Measurements,</span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a>         <span class="at">movmed_5 =</span> </span>
<span id="cb9-5"><a href="#cb9-5" tabindex="-1"></a>           <span class="fu">smooth_data</span>(<span class="at">x =</span> Time, <span class="at">y =</span> Measurements,</span>
<span id="cb9-6"><a href="#cb9-6" tabindex="-1"></a>                       <span class="at">sm_method =</span> <span class="st">&quot;moving-median&quot;</span>, <span class="at">window_width_n =</span> <span class="dv">5</span>),</span>
<span id="cb9-7"><a href="#cb9-7" tabindex="-1"></a>         <span class="at">movmed_9 =</span> </span>
<span id="cb9-8"><a href="#cb9-8" tabindex="-1"></a>           <span class="fu">smooth_data</span>(<span class="at">x =</span> Time, <span class="at">y =</span> Measurements,</span>
<span id="cb9-9"><a href="#cb9-9" tabindex="-1"></a>                       <span class="at">sm_method =</span> <span class="st">&quot;moving-median&quot;</span>, <span class="at">window_width_n =</span> <span class="dv">9</span>))</span>
<span id="cb9-10"><a href="#cb9-10" tabindex="-1"></a></span>
<span id="cb9-11"><a href="#cb9-11" tabindex="-1"></a><span class="co">#Reshape our data for plotting purposes</span></span>
<span id="cb9-12"><a href="#cb9-12" tabindex="-1"></a>ex_dat_mrg_wide <span class="ot">&lt;-</span> </span>
<span id="cb9-13"><a href="#cb9-13" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(ex_dat_mrg, <span class="at">cols =</span> <span class="fu">starts_with</span>(<span class="st">&quot;movmed&quot;</span>),</span>
<span id="cb9-14"><a href="#cb9-14" tabindex="-1"></a>               <span class="at">names_prefix =</span> <span class="st">&quot;movmed_&quot;</span>, <span class="at">names_to =</span> <span class="st">&quot;window_width_n&quot;</span>)</span>
<span id="cb9-15"><a href="#cb9-15" tabindex="-1"></a></span>
<span id="cb9-16"><a href="#cb9-16" tabindex="-1"></a><span class="co">#Plot data</span></span>
<span id="cb9-17"><a href="#cb9-17" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(ex_dat_mrg_wide, noise <span class="sc">==</span> <span class="st">&quot;Yes&quot;</span>),</span>
<span id="cb9-18"><a href="#cb9-18" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> Time, <span class="at">y =</span> value)) <span class="sc">+</span></span>
<span id="cb9-19"><a href="#cb9-19" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">color =</span> window_width_n), <span class="at">lwd =</span> <span class="dv">1</span>, <span class="at">alpha =</span> <span class="fl">0.75</span>) <span class="sc">+</span></span>
<span id="cb9-20"><a href="#cb9-20" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Well, <span class="at">scales =</span> <span class="st">&quot;free_y&quot;</span>) <span class="sc">+</span></span>
<span id="cb9-21"><a href="#cb9-21" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(ex_dat_mrg_wide,</span>
<span id="cb9-22"><a href="#cb9-22" tabindex="-1"></a>                                 noise <span class="sc">==</span> <span class="st">&quot;No&quot;</span>, window_width_n <span class="sc">==</span> <span class="dv">1</span>),</span>
<span id="cb9-23"><a href="#cb9-23" tabindex="-1"></a>            <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb9-24"><a href="#cb9-24" tabindex="-1"></a>  <span class="fu">scale_color_grey</span>(<span class="at">start =</span> <span class="fl">0.7</span>, <span class="at">end =</span> <span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb9-25"><a href="#cb9-25" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>() <span class="sc">+</span></span>
<span id="cb9-26"><a href="#cb9-26" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;moving-median&quot;</span>)</span>
<span id="cb9-27"><a href="#cb9-27" tabindex="-1"></a><span class="co">#&gt; Warning: Transformation introduced infinite values in continuous y-axis</span></span>
<span id="cb9-28"><a href="#cb9-28" tabindex="-1"></a><span class="co">#&gt; Warning: Removed 12 rows containing missing values (`geom_line()`).</span></span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Here we can see that <code>moving-median</code> has done a great job
excluding noise without biasing our data very far from the true values
(red line). However, it has produced a smoothed density that is fairly
“jumpy”, something that is common with moving-median. To address this,
you often will need to combine <code>moving-median</code> with other
smoothing methods.</p>
</div>
<div id="smoothing-with-loess" class="section level2">
<h2>Smoothing with LOESS</h2>
<p>For <code>loess</code>, the tuning parameter is the <code>span</code>
argument. <code>loess</code> works by doing fits on subset windows of
the data centered at each data point. These fits can be linear
(<code>degree = 1</code>) or polynomial (typically
<code>degree = 2</code>). <code>span</code> is the width of the window,
as a fraction of all data points. For instance, with the default
<code>span</code> of 0.75, 75% of the data points are included in each
window. Thus, span values typically are between 0 and 1 (although see
<code>?loess</code> for use of <code>span</code> values greater than 1),
and larger values are more “smoothed”. Here, we’ll show
<code>loess</code> smoothing with spans of 0.15 and 0.35 and
<code>degree = 1</code> (<code>loess_0</code> is just our raw,
unsmoothed data).</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a>ex_dat_mrg <span class="ot">&lt;-</span></span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">group_by</span>(ex_dat_mrg, Well, Bacteria_strain, Phage, noise),</span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a>         <span class="at">loess_0 =</span> Measurements,</span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a>         <span class="at">loess_15 =</span> <span class="fu">smooth_data</span>(<span class="at">x =</span> Time, <span class="at">y =</span> Measurements,</span>
<span id="cb10-5"><a href="#cb10-5" tabindex="-1"></a>                                 <span class="at">sm_method =</span> <span class="st">&quot;loess&quot;</span>, <span class="at">span =</span> .<span class="dv">15</span>, <span class="at">degree =</span> <span class="dv">1</span>),</span>
<span id="cb10-6"><a href="#cb10-6" tabindex="-1"></a>         <span class="at">loess_35 =</span> <span class="fu">smooth_data</span>(<span class="at">x =</span> Time, <span class="at">y =</span> Measurements,</span>
<span id="cb10-7"><a href="#cb10-7" tabindex="-1"></a>                                 <span class="at">sm_method =</span> <span class="st">&quot;loess&quot;</span>, <span class="at">span =</span> .<span class="dv">35</span>, <span class="at">degree =</span> <span class="dv">1</span>))</span>
<span id="cb10-8"><a href="#cb10-8" tabindex="-1"></a></span>
<span id="cb10-9"><a href="#cb10-9" tabindex="-1"></a><span class="co">#Reshape our data for plotting purposes</span></span>
<span id="cb10-10"><a href="#cb10-10" tabindex="-1"></a>ex_dat_mrg_wide <span class="ot">&lt;-</span> </span>
<span id="cb10-11"><a href="#cb10-11" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(ex_dat_mrg, <span class="at">cols =</span> <span class="fu">starts_with</span>(<span class="st">&quot;loess&quot;</span>),</span>
<span id="cb10-12"><a href="#cb10-12" tabindex="-1"></a>               <span class="at">names_prefix =</span> <span class="st">&quot;loess_&quot;</span>, <span class="at">names_to =</span> <span class="st">&quot;span&quot;</span>)</span>
<span id="cb10-13"><a href="#cb10-13" tabindex="-1"></a></span>
<span id="cb10-14"><a href="#cb10-14" tabindex="-1"></a><span class="co">#Plot data</span></span>
<span id="cb10-15"><a href="#cb10-15" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(ex_dat_mrg_wide, noise <span class="sc">==</span> <span class="st">&quot;Yes&quot;</span>),</span>
<span id="cb10-16"><a href="#cb10-16" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> Time, <span class="at">y =</span> value)) <span class="sc">+</span></span>
<span id="cb10-17"><a href="#cb10-17" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">color =</span> <span class="fu">as.factor</span>(<span class="fu">as.numeric</span>(span)<span class="sc">/</span><span class="dv">100</span>)), <span class="at">lwd =</span> <span class="dv">1</span>, <span class="at">alpha =</span> <span class="fl">0.75</span>) <span class="sc">+</span></span>
<span id="cb10-18"><a href="#cb10-18" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Well, <span class="at">scales =</span> <span class="st">&quot;free_y&quot;</span>) <span class="sc">+</span></span>
<span id="cb10-19"><a href="#cb10-19" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(ex_dat_mrg_wide,</span>
<span id="cb10-20"><a href="#cb10-20" tabindex="-1"></a>                                 noise <span class="sc">==</span> <span class="st">&quot;No&quot;</span>, span <span class="sc">==</span> <span class="dv">0</span>),</span>
<span id="cb10-21"><a href="#cb10-21" tabindex="-1"></a>            <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb10-22"><a href="#cb10-22" tabindex="-1"></a>  <span class="fu">scale_color_grey</span>(<span class="at">name =</span> <span class="st">&quot;span&quot;</span>, <span class="at">start =</span> <span class="fl">0.7</span>, <span class="at">end =</span> <span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb10-23"><a href="#cb10-23" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>() <span class="sc">+</span></span>
<span id="cb10-24"><a href="#cb10-24" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;loess&quot;</span>)</span>
<span id="cb10-25"><a href="#cb10-25" tabindex="-1"></a><span class="co">#&gt; Warning in self$trans$transform(x): NaNs produced</span></span>
<span id="cb10-26"><a href="#cb10-26" tabindex="-1"></a><span class="co">#&gt; Warning: Transformation introduced infinite values in continuous y-axis</span></span>
<span id="cb10-27"><a href="#cb10-27" tabindex="-1"></a><span class="co">#&gt; Warning: Removed 2 rows containing missing values (`geom_line()`).</span></span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Here we can see that <code>loess</code> with smaller spans have
smoothed the data somewhat but are still sensitive to outliers. However,
<code>loess</code> with a larger span has introduced significant bias
relative to the true values (red line). It doesn’t seem like
<code>loess</code> is working well for this data.</p>
</div>
<div id="smoothing-with-gam" class="section level2">
<h2>Smoothing with GAM</h2>
<p>For <code>gam</code>, the primary tuning parameter is the
<code>k</code> argument. <code>gam</code> works by doing fits on subsets
of the data and linking these fits together. <code>k</code> determines
how many link points (“knots”) it can use. If not specified, the default
<code>k</code> value for smoothing a time series is 10, with
<strong>smaller values being more “smoothed”</strong> (note this is
opposite the trend with other smoothing methods). However,
<strong>unlike earlier methods, <code>k</code> values that are too large
are also problematic</strong>, as they will tend to ‘overfit’ the data.
<code>k</code> cannot be larger than the number of data points, and
should usually be substantially smaller than that. Also note that
<strong><code>gam</code> can sometimes create artifacts</strong>,
especially oscillations in your density and derivatives. You should
check that <code>gam</code> is not doing so before carrying on with your
analyses. Here, we’ll show <code>gam</code> smoothing with
<code>k</code> values of 8 and 15 (<code>gam_97</code> is just our raw,
unsmoothed data).</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a>ex_dat_mrg <span class="ot">&lt;-</span></span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">group_by</span>(ex_dat_mrg, Well, Bacteria_strain, Phage, noise),</span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a>         <span class="at">gam_97 =</span> Measurements,</span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a>         <span class="at">gam_15 =</span> <span class="fu">smooth_data</span>(<span class="at">x =</span> Time, <span class="at">y =</span> Measurements,</span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a>                                  <span class="at">sm_method =</span> <span class="st">&quot;gam&quot;</span>, <span class="at">k =</span> <span class="dv">15</span>),</span>
<span id="cb11-6"><a href="#cb11-6" tabindex="-1"></a>         <span class="at">gam_8 =</span> <span class="fu">smooth_data</span>(<span class="at">x =</span> Time, <span class="at">y =</span> Measurements,</span>
<span id="cb11-7"><a href="#cb11-7" tabindex="-1"></a>                                 <span class="at">sm_method =</span> <span class="st">&quot;gam&quot;</span>, <span class="at">k =</span> <span class="dv">8</span>))</span>
<span id="cb11-8"><a href="#cb11-8" tabindex="-1"></a></span>
<span id="cb11-9"><a href="#cb11-9" tabindex="-1"></a><span class="co">#Reshape our data for plotting purposes</span></span>
<span id="cb11-10"><a href="#cb11-10" tabindex="-1"></a>ex_dat_mrg_wide <span class="ot">&lt;-</span> </span>
<span id="cb11-11"><a href="#cb11-11" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(ex_dat_mrg, <span class="at">cols =</span> <span class="fu">starts_with</span>(<span class="st">&quot;gam&quot;</span>),</span>
<span id="cb11-12"><a href="#cb11-12" tabindex="-1"></a>               <span class="at">names_prefix =</span> <span class="st">&quot;gam_&quot;</span>, <span class="at">names_to =</span> <span class="st">&quot;k&quot;</span>)</span>
<span id="cb11-13"><a href="#cb11-13" tabindex="-1"></a></span>
<span id="cb11-14"><a href="#cb11-14" tabindex="-1"></a><span class="co">#Plot data</span></span>
<span id="cb11-15"><a href="#cb11-15" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(ex_dat_mrg_wide, noise <span class="sc">==</span> <span class="st">&quot;Yes&quot;</span>),</span>
<span id="cb11-16"><a href="#cb11-16" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> Time, <span class="at">y =</span> value)) <span class="sc">+</span></span>
<span id="cb11-17"><a href="#cb11-17" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">color =</span> <span class="fu">as.factor</span>(<span class="fu">as.numeric</span>(k))), <span class="at">lwd =</span> <span class="dv">1</span>, <span class="at">alpha =</span> <span class="fl">0.75</span>) <span class="sc">+</span></span>
<span id="cb11-18"><a href="#cb11-18" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Well, <span class="at">scales =</span> <span class="st">&quot;free_y&quot;</span>) <span class="sc">+</span></span>
<span id="cb11-19"><a href="#cb11-19" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(ex_dat_mrg_wide,</span>
<span id="cb11-20"><a href="#cb11-20" tabindex="-1"></a>                                 noise <span class="sc">==</span> <span class="st">&quot;No&quot;</span>, k <span class="sc">==</span> <span class="dv">97</span>),</span>
<span id="cb11-21"><a href="#cb11-21" tabindex="-1"></a>            <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb11-22"><a href="#cb11-22" tabindex="-1"></a>  <span class="fu">scale_color_grey</span>(<span class="at">name =</span> <span class="st">&quot;span&quot;</span>, <span class="at">start =</span> <span class="fl">0.1</span>, <span class="at">end =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb11-23"><a href="#cb11-23" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>() <span class="sc">+</span></span>
<span id="cb11-24"><a href="#cb11-24" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;gam&quot;</span>)</span>
<span id="cb11-25"><a href="#cb11-25" tabindex="-1"></a><span class="co">#&gt; Warning in self$trans$transform(x): NaNs produced</span></span>
<span id="cb11-26"><a href="#cb11-26" tabindex="-1"></a><span class="co">#&gt; Warning: Transformation introduced infinite values in continuous y-axis</span></span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Here we can see that <code>gam</code> with lower values of
<code>k</code> increasingly smooths the data. However, at basically all
values of <code>k</code> it introduces significant bias and artifacts,
so it doesn’t seem like <code>gam</code> is working well for this
data.</p>
</div>
<div id="combining-multiple-smoothing-methods" class="section level2">
<h2>Combining multiple smoothing methods</h2>
<p>Often, combining multiple smoothing methods can provide improved
results. For instance, <code>moving-median</code> is particularly good
at removing outliers, but not very good at producing continuously smooth
data. In contrast, <code>moving-average</code>, <code>loess</code>, and
<code>gam</code> work better at producing continuously smooth data, but
aren’t as good at removing outliers. Here’s an example using the
strengths of both <code>moving-median</code> and
<code>moving-average</code>.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a>ex_dat_mrg <span class="ot">&lt;-</span></span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">group_by</span>(ex_dat_mrg, Well, Bacteria_strain, Phage, noise),</span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a>         <span class="at">smoothed_no =</span> Measurements,</span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a>         <span class="at">sm_med3 =</span> </span>
<span id="cb12-5"><a href="#cb12-5" tabindex="-1"></a>           <span class="fu">smooth_data</span>(<span class="at">x =</span> Time, <span class="at">y =</span> Measurements,</span>
<span id="cb12-6"><a href="#cb12-6" tabindex="-1"></a>                       <span class="at">sm_method =</span> <span class="st">&quot;moving-median&quot;</span>, <span class="at">window_width_n =</span> <span class="dv">3</span>),</span>
<span id="cb12-7"><a href="#cb12-7" tabindex="-1"></a>         <span class="co">#Note that for the second round, we&#39;re using the </span></span>
<span id="cb12-8"><a href="#cb12-8" tabindex="-1"></a>         <span class="co">#first smoothing as the input y</span></span>
<span id="cb12-9"><a href="#cb12-9" tabindex="-1"></a>         <span class="at">smoothed_yes =</span> </span>
<span id="cb12-10"><a href="#cb12-10" tabindex="-1"></a>           <span class="fu">smooth_data</span>(<span class="at">x =</span> Time, <span class="at">y =</span> sm_med3,</span>
<span id="cb12-11"><a href="#cb12-11" tabindex="-1"></a>                       <span class="at">sm_method =</span> <span class="st">&quot;moving-average&quot;</span>, <span class="at">window_width_n =</span> <span class="dv">3</span>))</span>
<span id="cb12-12"><a href="#cb12-12" tabindex="-1"></a></span>
<span id="cb12-13"><a href="#cb12-13" tabindex="-1"></a><span class="co">#Reshape our data for plotting purposes</span></span>
<span id="cb12-14"><a href="#cb12-14" tabindex="-1"></a>ex_dat_mrg_wide <span class="ot">&lt;-</span> </span>
<span id="cb12-15"><a href="#cb12-15" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(ex_dat_mrg, <span class="at">cols =</span> <span class="fu">starts_with</span>(<span class="st">&quot;smoothed&quot;</span>),</span>
<span id="cb12-16"><a href="#cb12-16" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">&quot;smoothed&quot;</span>, <span class="at">names_prefix =</span> <span class="st">&quot;smoothed_&quot;</span>)</span>
<span id="cb12-17"><a href="#cb12-17" tabindex="-1"></a></span>
<span id="cb12-18"><a href="#cb12-18" tabindex="-1"></a><span class="co">#Plot data</span></span>
<span id="cb12-19"><a href="#cb12-19" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(ex_dat_mrg_wide, noise <span class="sc">==</span> <span class="st">&quot;Yes&quot;</span>),</span>
<span id="cb12-20"><a href="#cb12-20" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> Time, <span class="at">y =</span> value, <span class="at">color =</span> smoothed)) <span class="sc">+</span></span>
<span id="cb12-21"><a href="#cb12-21" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">lwd =</span> <span class="dv">1</span>, <span class="at">alpha =</span> <span class="fl">0.75</span>) <span class="sc">+</span></span>
<span id="cb12-22"><a href="#cb12-22" tabindex="-1"></a>  <span class="fu">scale_color_grey</span>(<span class="at">start =</span> <span class="fl">0.7</span>, <span class="at">end =</span> <span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb12-23"><a href="#cb12-23" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Well, <span class="at">scales =</span> <span class="st">&quot;free_y&quot;</span>) <span class="sc">+</span></span>
<span id="cb12-24"><a href="#cb12-24" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(ex_dat_mrg_wide,</span>
<span id="cb12-25"><a href="#cb12-25" tabindex="-1"></a>                                 noise <span class="sc">==</span> <span class="st">&quot;No&quot;</span>, smoothed <span class="sc">==</span> <span class="st">&quot;no&quot;</span>),</span>
<span id="cb12-26"><a href="#cb12-26" tabindex="-1"></a>            <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb12-27"><a href="#cb12-27" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>() <span class="sc">+</span></span>
<span id="cb12-28"><a href="#cb12-28" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;median then average smoothing&quot;</span>)</span>
<span id="cb12-29"><a href="#cb12-29" tabindex="-1"></a><span class="co">#&gt; Warning: Transformation introduced infinite values in continuous y-axis</span></span>
<span id="cb12-30"><a href="#cb12-30" tabindex="-1"></a><span class="co">#&gt; Warning: Removed 4 rows containing missing values (`geom_line()`).</span></span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Here we can see that the combination of minimal
<code>moving-median</code> and <code>moving-average</code> smoothing has
produced a curve that has most of the noise removed with minimal
introduction of bias relative to the true values (red line).</p>
</div>
</div>
<div id="DerivsOfSmoothed" class="section level1">
<h1>Calculating derivatives of smoothed data</h1>
<p>Once you’ve smoothed your data, you can calculate derivatives using
the smoothed data. Combining smoothing of raw data and fitting using
multiple points for calculating derivatives can be a powerful
combination for reducing the effects of noise while minimizing the
introduction of bias.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="co"># Note here that we&#39;re calculating derivatives of the smoothed column generated</span></span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a><span class="co">#  in the previous section by combining moving median and moving average smoothing</span></span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a>ex_dat_mrg <span class="ot">&lt;-</span> </span>
<span id="cb13-4"><a href="#cb13-4" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">group_by</span>(ex_dat_mrg, Well, Bacteria_strain, Phage, noise),</span>
<span id="cb13-5"><a href="#cb13-5" tabindex="-1"></a>         <span class="at">smderiv_0 =</span> <span class="fu">calc_deriv</span>(<span class="at">x =</span> Time, <span class="at">y =</span> Measurements),</span>
<span id="cb13-6"><a href="#cb13-6" tabindex="-1"></a>         <span class="at">smderivpercap_0 =</span> <span class="fu">calc_deriv</span>(<span class="at">x =</span> Time, <span class="at">y =</span> Measurements,</span>
<span id="cb13-7"><a href="#cb13-7" tabindex="-1"></a>                                       <span class="at">percapita =</span> <span class="cn">TRUE</span>, <span class="at">blank =</span> <span class="dv">0</span>),</span>
<span id="cb13-8"><a href="#cb13-8" tabindex="-1"></a>         <span class="at">smderiv_3 =</span> <span class="fu">calc_deriv</span>(<span class="at">x =</span> Time, <span class="at">y =</span> smoothed_yes, <span class="at">window_width_n =</span> <span class="dv">3</span>),</span>
<span id="cb13-9"><a href="#cb13-9" tabindex="-1"></a>         <span class="at">smderivpercap_3 =</span> <span class="fu">calc_deriv</span>(<span class="at">x =</span> Time, <span class="at">y =</span> smoothed_yes, <span class="at">percapita =</span> <span class="cn">TRUE</span>, </span>
<span id="cb13-10"><a href="#cb13-10" tabindex="-1"></a>                                    <span class="at">blank =</span> <span class="dv">0</span>, <span class="at">window_width_n =</span> <span class="dv">3</span>))</span>
<span id="cb13-11"><a href="#cb13-11" tabindex="-1"></a></span>
<span id="cb13-12"><a href="#cb13-12" tabindex="-1"></a><span class="co">#Reshape our data for plotting purposes</span></span>
<span id="cb13-13"><a href="#cb13-13" tabindex="-1"></a>ex_dat_mrg_wide <span class="ot">&lt;-</span> </span>
<span id="cb13-14"><a href="#cb13-14" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(ex_dat_mrg, <span class="at">cols =</span> <span class="fu">starts_with</span>(<span class="st">&quot;smderiv&quot;</span>),</span>
<span id="cb13-15"><a href="#cb13-15" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="fu">c</span>(<span class="st">&quot;deriv&quot;</span>, <span class="st">&quot;window_width_n&quot;</span>), <span class="at">names_sep =</span> <span class="st">&quot;_&quot;</span>)</span>
<span id="cb13-16"><a href="#cb13-16" tabindex="-1"></a>ex_dat_mrg_wide <span class="ot">&lt;-</span> </span>
<span id="cb13-17"><a href="#cb13-17" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(ex_dat_mrg_wide, <span class="at">names_from =</span> deriv, <span class="at">values_from =</span> value)</span>
<span id="cb13-18"><a href="#cb13-18" tabindex="-1"></a></span>
<span id="cb13-19"><a href="#cb13-19" tabindex="-1"></a><span class="co">#Plot derivative</span></span>
<span id="cb13-20"><a href="#cb13-20" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(ex_dat_mrg_wide, noise <span class="sc">==</span> <span class="st">&quot;Yes&quot;</span>),</span>
<span id="cb13-21"><a href="#cb13-21" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> Time, <span class="at">y =</span> smderiv, <span class="at">color =</span> window_width_n)) <span class="sc">+</span></span>
<span id="cb13-22"><a href="#cb13-22" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">lwd =</span> <span class="dv">1</span>, <span class="at">alpha =</span> <span class="fl">0.75</span>) <span class="sc">+</span></span>
<span id="cb13-23"><a href="#cb13-23" tabindex="-1"></a>  <span class="fu">scale_color_grey</span>(<span class="at">start =</span> <span class="fl">0.7</span>, <span class="at">end =</span> <span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb13-24"><a href="#cb13-24" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Well, <span class="at">scales =</span> <span class="st">&quot;free_y&quot;</span>) <span class="sc">+</span></span>
<span id="cb13-25"><a href="#cb13-25" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(ex_dat_mrg_wide,</span>
<span id="cb13-26"><a href="#cb13-26" tabindex="-1"></a>                                 noise <span class="sc">==</span> <span class="st">&quot;No&quot;</span>, window_width_n <span class="sc">==</span> <span class="dv">0</span>),</span>
<span id="cb13-27"><a href="#cb13-27" tabindex="-1"></a>            <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>)</span>
<span id="cb13-28"><a href="#cb13-28" tabindex="-1"></a><span class="co">#&gt; Warning: Removed 7 rows containing missing values (`geom_line()`).</span></span>
<span id="cb13-29"><a href="#cb13-29" tabindex="-1"></a><span class="co">#&gt; Warning: Removed 1 row containing missing values (`geom_line()`).</span></span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a></span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a><span class="co">#Plot per-capita derivative</span></span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(ex_dat_mrg_wide, noise <span class="sc">==</span> <span class="st">&quot;Yes&quot;</span>),</span>
<span id="cb14-4"><a href="#cb14-4" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> Time, <span class="at">y =</span> smderivpercap, <span class="at">color =</span> window_width_n)) <span class="sc">+</span></span>
<span id="cb14-5"><a href="#cb14-5" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">lwd =</span> <span class="dv">1</span>, <span class="at">alpha =</span> <span class="fl">0.75</span>) <span class="sc">+</span></span>
<span id="cb14-6"><a href="#cb14-6" tabindex="-1"></a>  <span class="fu">scale_color_grey</span>(<span class="at">start =</span> <span class="fl">0.7</span>, <span class="at">end =</span> <span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb14-7"><a href="#cb14-7" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Well, <span class="at">scales =</span> <span class="st">&quot;free_y&quot;</span>) <span class="sc">+</span></span>
<span id="cb14-8"><a href="#cb14-8" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(ex_dat_mrg_wide,</span>
<span id="cb14-9"><a href="#cb14-9" tabindex="-1"></a>                                 noise <span class="sc">==</span> <span class="st">&quot;No&quot;</span>, window_width_n <span class="sc">==</span> <span class="dv">3</span>),</span>
<span id="cb14-10"><a href="#cb14-10" tabindex="-1"></a>            <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb14-11"><a href="#cb14-11" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="cn">NA</span>, <span class="dv">5</span>)</span>
<span id="cb14-12"><a href="#cb14-12" tabindex="-1"></a><span class="co">#&gt; Warning: Removed 8 rows containing missing values (`geom_line()`).</span></span>
<span id="cb14-13"><a href="#cb14-13" tabindex="-1"></a><span class="co">#&gt; Warning: Removed 6 rows containing missing values (`geom_line()`).</span></span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Here we can see that calculating derivatives from smoothed raw data
can be a powerfully useful combination.</p>
</div>
<div id="SubsetAnalysis" class="section level1">
<h1>Summarizing on subsets of derivatives</h1>
<p>There is one final strategy we can employ when dealing with noisy
data: excluding data points where the density is near 0. If we compare
our per-capita growth rates and our density plots, we’ll see that most
of the noise occurs when the density is very close to 0:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a><span class="co">#Plot density</span></span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(ex_dat_mrg, noise <span class="sc">==</span> <span class="st">&quot;Yes&quot;</span>),</span>
<span id="cb15-3"><a href="#cb15-3" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> Time, <span class="at">y =</span> smoothed_yes)) <span class="sc">+</span></span>
<span id="cb15-4"><a href="#cb15-4" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb15-5"><a href="#cb15-5" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Well, <span class="at">scales =</span> <span class="st">&quot;free_y&quot;</span>) <span class="sc">+</span></span>
<span id="cb15-6"><a href="#cb15-6" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>()</span>
<span id="cb15-7"><a href="#cb15-7" tabindex="-1"></a><span class="co">#&gt; Warning: Transformation introduced infinite values in continuous y-axis</span></span>
<span id="cb15-8"><a href="#cb15-8" tabindex="-1"></a><span class="co">#&gt; Warning: Removed 16 rows containing missing values (`geom_point()`).</span></span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a></span>
<span id="cb16-2"><a href="#cb16-2" tabindex="-1"></a><span class="co"># Plot per-capita derivative</span></span>
<span id="cb16-3"><a href="#cb16-3" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(ex_dat_mrg, noise <span class="sc">==</span> <span class="st">&quot;Yes&quot;</span>),</span>
<span id="cb16-4"><a href="#cb16-4" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> Time, <span class="at">y =</span> derivpercap_5)) <span class="sc">+</span></span>
<span id="cb16-5"><a href="#cb16-5" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb16-6"><a href="#cb16-6" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Well, <span class="at">scales =</span> <span class="st">&quot;free_y&quot;</span>)</span>
<span id="cb16-7"><a href="#cb16-7" tabindex="-1"></a><span class="co">#&gt; Warning: Removed 16 rows containing missing values (`geom_point()`).</span></span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Per-capita growth rates are often very noisy when the density is
close to 0, so it can make sense to simply exclude those data
points.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a><span class="co">#Plot density</span></span>
<span id="cb17-2"><a href="#cb17-2" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(ex_dat_mrg, noise <span class="sc">==</span> <span class="st">&quot;Yes&quot;</span>, smoothed_yes <span class="sc">&gt;</span> <span class="fl">0.01</span>),</span>
<span id="cb17-3"><a href="#cb17-3" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> Time, <span class="at">y =</span> smoothed_yes)) <span class="sc">+</span></span>
<span id="cb17-4"><a href="#cb17-4" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb17-5"><a href="#cb17-5" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Well, <span class="at">scales =</span> <span class="st">&quot;free_y&quot;</span>) <span class="sc">+</span></span>
<span id="cb17-6"><a href="#cb17-6" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.01</span>, <span class="at">lty =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb17-7"><a href="#cb17-7" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>()</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a></span>
<span id="cb18-2"><a href="#cb18-2" tabindex="-1"></a><span class="co"># Plot per-capita derivative</span></span>
<span id="cb18-3"><a href="#cb18-3" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(ex_dat_mrg, noise <span class="sc">==</span> <span class="st">&quot;Yes&quot;</span>, smoothed_yes <span class="sc">&gt;</span> <span class="fl">0.01</span>),</span>
<span id="cb18-4"><a href="#cb18-4" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> Time, <span class="at">y =</span> derivpercap_5)) <span class="sc">+</span></span>
<span id="cb18-5"><a href="#cb18-5" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb18-6"><a href="#cb18-6" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Well, <span class="at">scales =</span> <span class="st">&quot;free_y&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>When we limit our analysis to data points where the density is not
too close to 0, much of the noise in our per-capita derivative
disappears.</p>
<p>To take this to the final step, we can use these cutoffs in our
<code>summarize</code> commands to calculate the maximum growth rate of
the bacteria when their density is at least 0.01.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a>ex_dat_mrg_sum <span class="ot">&lt;-</span></span>
<span id="cb19-2"><a href="#cb19-2" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="fu">group_by</span>(ex_dat_mrg, Well, Bacteria_strain, Phage, noise),</span>
<span id="cb19-3"><a href="#cb19-3" tabindex="-1"></a>            <span class="at">max_growth_rate =</span> <span class="fu">max</span>(derivpercap_5[smoothed_yes <span class="sc">&gt;</span> <span class="fl">0.01</span>], </span>
<span id="cb19-4"><a href="#cb19-4" tabindex="-1"></a>                                  <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb19-5"><a href="#cb19-5" tabindex="-1"></a><span class="co">#&gt; `summarise()` has grouped output by &#39;Well&#39;, &#39;Bacteria_strain&#39;, &#39;Phage&#39;. You can</span></span>
<span id="cb19-6"><a href="#cb19-6" tabindex="-1"></a><span class="co">#&gt; override using the `.groups` argument.</span></span>
<span id="cb19-7"><a href="#cb19-7" tabindex="-1"></a><span class="fu">head</span>(ex_dat_mrg_sum)</span>
<span id="cb19-8"><a href="#cb19-8" tabindex="-1"></a><span class="co">#&gt; # A tibble: 6 × 5</span></span>
<span id="cb19-9"><a href="#cb19-9" tabindex="-1"></a><span class="co">#&gt; # Groups:   Well, Bacteria_strain, Phage [3]</span></span>
<span id="cb19-10"><a href="#cb19-10" tabindex="-1"></a><span class="co">#&gt;   Well  Bacteria_strain Phage       noise max_growth_rate</span></span>
<span id="cb19-11"><a href="#cb19-11" tabindex="-1"></a><span class="co">#&gt;   &lt;fct&gt; &lt;chr&gt;           &lt;chr&gt;       &lt;chr&gt;           &lt;dbl&gt;</span></span>
<span id="cb19-12"><a href="#cb19-12" tabindex="-1"></a><span class="co">#&gt; 1 A1    Strain 1        No Phage    No              1.00 </span></span>
<span id="cb19-13"><a href="#cb19-13" tabindex="-1"></a><span class="co">#&gt; 2 A1    Strain 1        No Phage    Yes             0.991</span></span>
<span id="cb19-14"><a href="#cb19-14" tabindex="-1"></a><span class="co">#&gt; 3 E11   Strain 29       Phage Added No              1.53 </span></span>
<span id="cb19-15"><a href="#cb19-15" tabindex="-1"></a><span class="co">#&gt; 4 E11   Strain 29       Phage Added Yes             1.57 </span></span>
<span id="cb19-16"><a href="#cb19-16" tabindex="-1"></a><span class="co">#&gt; 5 F1    Strain 31       No Phage    No              0.597</span></span>
<span id="cb19-17"><a href="#cb19-17" tabindex="-1"></a><span class="co">#&gt; 6 F1    Strain 31       No Phage    Yes             1.06</span></span></code></pre></div>
</div>
<div id="whats-next" class="section level1">
<h1>What’s next?</h1>
<p>Now that you’ve analyzed your data and dealt with any noise, there’s
just some concluding notes on best practices for running statistics,
merging growth curve analyses with other data, and additional resources
for analyzing growth curves.</p>
<ol style="list-style-type: decimal">
<li>Introduction: <code>vignette(&quot;gc01_gcplyr&quot;)</code></li>
<li>Importing and transforming data:
<code>vignette(&quot;gc02_import_transform&quot;)</code></li>
<li>Incorporating design information:
<code>vignette(&quot;gc03_incorporate_designs&quot;)</code></li>
<li>Pre-processing and plotting your data:
<code>vignette(&quot;gc04_preprocess_plot&quot;)</code></li>
<li>Processing your data: <code>vignette(&quot;gc05_process&quot;)</code></li>
<li>Analyzing your data: <code>vignette(&quot;gc06_analyze&quot;)</code></li>
<li>Dealing with noise: <code>vignette(&quot;gc07_noise&quot;)</code></li>
<li><strong>Statistics, merging other data, and other
resources:</strong> <code>vignette(&quot;gc08_conclusion&quot;)</code></li>
<li>Working with multiple plates:
<code>vignette(&quot;gc09_multiple_plates&quot;)</code></li>
</ol>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
