<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Mike Blazanin" />


<title>Dealing with noise</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Dealing with noise</h1>
<h4 class="author">Mike Blazanin</h4>


<div id="TOC">
<ul>
<li><a href="#where-are-we-so-far" id="toc-where-are-we-so-far">Where
are we so far?</a></li>
<li><a href="#introduction" id="toc-introduction">Introduction</a></li>
<li><a href="#SubsetAnalysis" id="toc-SubsetAnalysis">Summarizing on
subsets of derivatives</a></li>
<li><a href="#FittingDeriv" id="toc-FittingDeriv">Fitting during
derivative calculation</a></li>
<li><a href="#Smoothing" id="toc-Smoothing">Smoothing raw data</a>
<ul>
<li><a href="#smoothing-with-moving-median" id="toc-smoothing-with-moving-median">Smoothing with
moving-median</a></li>
<li><a href="#smoothing-with-moving-average" id="toc-smoothing-with-moving-average">Smoothing with
moving-average</a></li>
<li><a href="#combining-multiple-smoothing-methods" id="toc-combining-multiple-smoothing-methods">Combining multiple
smoothing methods</a></li>
<li><a href="#smoothing-with-other-methods" id="toc-smoothing-with-other-methods">Smoothing with other
methods</a></li>
</ul></li>
<li><a href="#DerivsOfSmoothed" id="toc-DerivsOfSmoothed">Calculating
derivatives of smoothed data</a></li>
<li><a href="#whats-next" id="toc-whats-next">What’s next?</a></li>
</ul>
</div>

<div id="where-are-we-so-far" class="section level1">
<h1>Where are we so far?</h1>
<ol style="list-style-type: decimal">
<li>Introduction: <code>vignette(&quot;gc01_gcplyr&quot;)</code></li>
<li>Importing and reshaping data:
<code>vignette(&quot;gc02_import_reshape&quot;)</code></li>
<li>Incorporating experimental designs:
<code>vignette(&quot;gc03_incorporate_designs&quot;)</code></li>
<li>Pre-processing and plotting your data:
<code>vignette(&quot;gc04_preprocess_plot&quot;)</code></li>
<li>Processing your data: <code>vignette(&quot;gc05_process&quot;)</code></li>
<li>Analyzing your data: <code>vignette(&quot;gc06_analyze&quot;)</code></li>
<li><strong>Dealing with noise:</strong>
<code>vignette(&quot;gc07_noise&quot;)</code></li>
<li>Statistics, merging other data, and other resources:
<code>vignette(&quot;gc08_conclusion&quot;)</code></li>
<li>Working with multiple plates:
<code>vignette(&quot;gc09_multiple_plates&quot;)</code></li>
</ol>
<p>So far, we’ve imported and transformed our measures, combined them
with our design information, pre-processed, processed, plotted, and
analyzed our data. Here, we’re going to learn potential strategies for
dealing with noise in our growth curve data.</p>
<p>If you haven’t already, load the necessary packages.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">library</span>(gcplyr)</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span></code></pre></div>
</div>
<div id="introduction" class="section level1">
<h1>Introduction</h1>
<p>Oftentimes, growth curve data produced by a plate reader will have
some noise it it. Since <code>gcplyr</code> does model-free analyses,
our approach can sometimes be sensitive to noise, necessitating steps to
reduce the effects of noise.</p>
<p>When assessing the effects of noise in our data, one of the first
steps is simply to visualize our data, including both the raw data and
any derivatives we’ll be analyzing. This is especially important because
per-capita derivatives can be very sensitive to noise, especially when
density is low. By visualizing our data, we can assess whether the noise
we see is likely to throw off our analyses.</p>
<p>Broadly speaking, there are three strategies we can use to deal with
noise.</p>
<ol style="list-style-type: decimal">
<li><a href="#SubsetAnalysis">Excluding low-density data points</a></li>
<li><a href="#FittingDeriv">Using fitting during derivative
calculations</a></li>
<li><a href="#Smoothing">Smoothing the raw data</a></li>
</ol>
<p>Each approach is progressively more involved, so I recommend trying
them out in that order. Typically, noise is most problematic in the
derivatives, and all three approaches will help with that. However, if
you’re dealing with substantial noise in your raw density data, only
approach #3 will help.</p>
<p>Let’s start by pulling out some example data. The example data here
is the same example data we’ve been working with, along with a version
of that data with simulated noise added to it.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a>ex_dat_mrg <span class="ot">&lt;-</span> <span class="fu">make_example</span>(<span class="at">vignette =</span> <span class="dv">7</span>, <span class="at">example =</span> <span class="dv">1</span>)</span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a><span class="co">#&gt; Joining, by = c(&quot;Time&quot;, &quot;Well&quot;, &quot;Measurements&quot;, &quot;noise&quot;)</span></span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a><span class="co">#&gt; Warning in merge_dfs(noisy_data, noiseless_data): </span></span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a><span class="co">#&gt; merged_df has more rows than x and than y, this may indicate</span></span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a><span class="co">#&gt;                mis-matched values in the shared column(s) used to merge </span></span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a><span class="co">#&gt;               (e.g. &#39;Well&#39;)</span></span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a><span class="co">#&gt; Joining, by = &quot;Well&quot;</span></span>
<span id="cb2-8"><a href="#cb2-8" tabindex="-1"></a></span>
<span id="cb2-9"><a href="#cb2-9" tabindex="-1"></a><span class="co"># Plot with a log y-axis</span></span>
<span id="cb2-10"><a href="#cb2-10" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(ex_dat_mrg, noise <span class="sc">==</span> <span class="st">&quot;Yes&quot;</span>),</span>
<span id="cb2-11"><a href="#cb2-11" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> Time, <span class="at">y =</span> Measurements)) <span class="sc">+</span></span>
<span id="cb2-12"><a href="#cb2-12" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb2-13"><a href="#cb2-13" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(ex_dat_mrg, noise <span class="sc">==</span> <span class="st">&quot;No&quot;</span>),</span>
<span id="cb2-14"><a href="#cb2-14" tabindex="-1"></a>            <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb2-15"><a href="#cb2-15" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Well) <span class="sc">+</span></span>
<span id="cb2-16"><a href="#cb2-16" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">trans =</span> <span class="st">&quot;log10&quot;</span>)</span>
<span id="cb2-17"><a href="#cb2-17" tabindex="-1"></a><span class="co">#&gt; Warning: Transformation introduced infinite values in continuous y-axis</span></span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Great! Here we can see how the noisy (points) and noiseless (red
line) data compare. We’ve plotted our data with log-transformed y-axes,
which are useful because exponential growth is a straight line when
plotted on a log scale. log axes also reveal another common pattern:
<strong>random noise tends to have a much larger effect at low
densities</strong>.</p>
<p>This level of noise doesn’t seem like it would mess up calculations
of maximum density or area under the curve much, so that’s not enough of
a reason to smooth. But let’s look at what our derivatives look
like.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a>ex_dat_mrg <span class="ot">&lt;-</span> </span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">group_by</span>(ex_dat_mrg, Well, Bacteria_strain, Phage, noise),</span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a>         <span class="at">deriv_2 =</span> <span class="fu">calc_deriv</span>(<span class="at">x =</span> Time, <span class="at">y =</span> Measurements),</span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a>         <span class="at">derivpercap_2 =</span> <span class="fu">calc_deriv</span>(<span class="at">x =</span> Time, <span class="at">y =</span> Measurements,</span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a>                                   <span class="at">percapita =</span> <span class="cn">TRUE</span>, <span class="at">blank =</span> <span class="dv">0</span>))</span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a></span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a><span class="co"># Plot derivative</span></span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(ex_dat_mrg, noise <span class="sc">==</span> <span class="st">&quot;Yes&quot;</span>),</span>
<span id="cb3-9"><a href="#cb3-9" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> Time, <span class="at">y =</span> deriv_2)) <span class="sc">+</span></span>
<span id="cb3-10"><a href="#cb3-10" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb3-11"><a href="#cb3-11" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(ex_dat_mrg, noise <span class="sc">==</span> <span class="st">&quot;No&quot;</span>),</span>
<span id="cb3-12"><a href="#cb3-12" tabindex="-1"></a>            <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb3-13"><a href="#cb3-13" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Well, <span class="at">scales =</span> <span class="st">&quot;free_y&quot;</span>)</span>
<span id="cb3-14"><a href="#cb3-14" tabindex="-1"></a><span class="co">#&gt; Warning: Removed 4 rows containing missing values (`geom_point()`).</span></span>
<span id="cb3-15"><a href="#cb3-15" tabindex="-1"></a><span class="co">#&gt; Warning: Removed 1 row containing missing values (`geom_line()`).</span></span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a></span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a><span class="co"># Plot per-capita derivative</span></span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(ex_dat_mrg, noise <span class="sc">==</span> <span class="st">&quot;Yes&quot;</span>),</span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> Time, <span class="at">y =</span> derivpercap_2)) <span class="sc">+</span></span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(ex_dat_mrg, noise <span class="sc">==</span> <span class="st">&quot;No&quot;</span>),</span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a>            <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Well, <span class="at">scales =</span> <span class="st">&quot;free_y&quot;</span>)</span>
<span id="cb4-9"><a href="#cb4-9" tabindex="-1"></a><span class="co">#&gt; Warning: Removed 8 rows containing missing values (`geom_point()`).</span></span>
<span id="cb4-10"><a href="#cb4-10" tabindex="-1"></a><span class="co">#&gt; Removed 1 row containing missing values (`geom_line()`).</span></span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Those values are jumping all over the place! Let’s see what we can do
to address this.</p>
</div>
<div id="SubsetAnalysis" class="section level1">
<h1>Summarizing on subsets of derivatives</h1>
<p>One strategy we can employ when dealing with noisy data is excluding
data points where the density is near 0. If we compare our per-capita
growth rates and our density plots, we’ll see that most of the noise
occurs when the density is very close to 0:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="co">#Plot density</span></span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(ex_dat_mrg, noise <span class="sc">==</span> <span class="st">&quot;Yes&quot;</span>),</span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> Time, <span class="at">y =</span> Measurements)) <span class="sc">+</span></span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Well, <span class="at">scales =</span> <span class="st">&quot;free_y&quot;</span>) <span class="sc">+</span></span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>()</span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a><span class="co">#&gt; Warning: Transformation introduced infinite values in continuous y-axis</span></span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a></span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a><span class="co"># Plot per-capita derivative</span></span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(ex_dat_mrg, noise <span class="sc">==</span> <span class="st">&quot;Yes&quot;</span>),</span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> Time, <span class="at">y =</span> derivpercap_2)) <span class="sc">+</span></span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Well, <span class="at">scales =</span> <span class="st">&quot;free_y&quot;</span>)</span>
<span id="cb6-7"><a href="#cb6-7" tabindex="-1"></a><span class="co">#&gt; Warning: Removed 8 rows containing missing values (`geom_point()`).</span></span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Per-capita growth rates are often very noisy when the density is
close to 0, so it can make sense to simply exclude those data
points.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="co">#Plot density</span></span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(ex_dat_mrg, noise <span class="sc">==</span> <span class="st">&quot;Yes&quot;</span>, Measurements <span class="sc">&gt;</span> <span class="fl">0.01</span>),</span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> Time, <span class="at">y =</span> Measurements)) <span class="sc">+</span></span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Well, <span class="at">scales =</span> <span class="st">&quot;free_y&quot;</span>) <span class="sc">+</span></span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.01</span>, <span class="at">lty =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb7-7"><a href="#cb7-7" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>()</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a></span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a><span class="co"># Plot per-capita derivative</span></span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(ex_dat_mrg, noise <span class="sc">==</span> <span class="st">&quot;Yes&quot;</span>, Measurements <span class="sc">&gt;</span> <span class="fl">0.01</span>),</span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> Time, <span class="at">y =</span> derivpercap_2)) <span class="sc">+</span></span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb8-6"><a href="#cb8-6" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Well, <span class="at">scales =</span> <span class="st">&quot;free_y&quot;</span>)</span>
<span id="cb8-7"><a href="#cb8-7" tabindex="-1"></a><span class="co">#&gt; Warning: Removed 3 rows containing missing values (`geom_point()`).</span></span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>When we limit our analysis to data points where the density is not
too close to 0, much of the noise in our per-capita derivative
disappears.</p>
<p>To take this to the final step, we can use these cutoffs in our
<code>summarize</code> commands to calculate the maximum growth rate of
the bacteria when their density is at least 0.01.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a>ex_dat_mrg_sum <span class="ot">&lt;-</span></span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="fu">group_by</span>(ex_dat_mrg, Well, Bacteria_strain, Phage, noise),</span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a>            <span class="at">max_growth_rate =</span> <span class="fu">max</span>(derivpercap_2[Measurements <span class="sc">&gt;</span> <span class="fl">0.01</span>], </span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a>                                  <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb9-5"><a href="#cb9-5" tabindex="-1"></a><span class="co">#&gt; `summarise()` has grouped output by &#39;Well&#39;, &#39;Bacteria_strain&#39;, &#39;Phage&#39;. You can</span></span>
<span id="cb9-6"><a href="#cb9-6" tabindex="-1"></a><span class="co">#&gt; override using the `.groups` argument.</span></span>
<span id="cb9-7"><a href="#cb9-7" tabindex="-1"></a><span class="fu">head</span>(ex_dat_mrg_sum)</span>
<span id="cb9-8"><a href="#cb9-8" tabindex="-1"></a><span class="co">#&gt; # A tibble: 6 × 5</span></span>
<span id="cb9-9"><a href="#cb9-9" tabindex="-1"></a><span class="co">#&gt; # Groups:   Well, Bacteria_strain, Phage [3]</span></span>
<span id="cb9-10"><a href="#cb9-10" tabindex="-1"></a><span class="co">#&gt;   Well  Bacteria_strain Phage       noise max_growth_rate</span></span>
<span id="cb9-11"><a href="#cb9-11" tabindex="-1"></a><span class="co">#&gt;   &lt;fct&gt; &lt;chr&gt;           &lt;chr&gt;       &lt;chr&gt;           &lt;dbl&gt;</span></span>
<span id="cb9-12"><a href="#cb9-12" tabindex="-1"></a><span class="co">#&gt; 1 A1    Strain 1        No Phage    No               1.23</span></span>
<span id="cb9-13"><a href="#cb9-13" tabindex="-1"></a><span class="co">#&gt; 2 A1    Strain 1        No Phage    Yes              2   </span></span>
<span id="cb9-14"><a href="#cb9-14" tabindex="-1"></a><span class="co">#&gt; 3 E11   Strain 29       Phage Added No               2.11</span></span>
<span id="cb9-15"><a href="#cb9-15" tabindex="-1"></a><span class="co">#&gt; 4 E11   Strain 29       Phage Added Yes             12.3 </span></span>
<span id="cb9-16"><a href="#cb9-16" tabindex="-1"></a><span class="co">#&gt; 5 F1    Strain 31       No Phage    No               0.8 </span></span>
<span id="cb9-17"><a href="#cb9-17" tabindex="-1"></a><span class="co">#&gt; 6 F1    Strain 31       No Phage    Yes              1.75</span></span></code></pre></div>
</div>
<div id="FittingDeriv" class="section level1">
<h1>Fitting during derivative calculation</h1>
<p>The next approach to try is to calculate derivatives by fitting a
line to multiple points. (You might recall we previously used this in
the Calculating Derivatives article
<code>vignette(&quot;gc05_process&quot;)</code>.)</p>
<p>To use the fitting functionality of <code>calc_deriv</code>, specify
either the <code>window_width</code> or the <code>window_width_n</code>
parameter. <code>window_width</code> specifies how wide the window used
to include points for the fitting is in units of <code>x</code>, while
<code>window_width_n</code> specifies it in number of data points. Wider
windows will be more smoothed. I recommend using as small a window as
possible, like <code>window_width_n = 3</code> or
<code>window_width_n = 5</code>. Visualize different window widths and
choose the smallest one that is sufficient for your analyses to
succeed.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a>ex_dat_mrg <span class="ot">&lt;-</span> </span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">group_by</span>(ex_dat_mrg, Well, Bacteria_strain, Phage, noise),</span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a>         <span class="at">deriv_5 =</span> <span class="fu">calc_deriv</span>(<span class="at">x =</span> Time, <span class="at">y =</span> Measurements,</span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a>                            <span class="at">window_width_n =</span> <span class="dv">5</span>),</span>
<span id="cb10-5"><a href="#cb10-5" tabindex="-1"></a>         <span class="at">derivpercap_5 =</span> <span class="fu">calc_deriv</span>(<span class="at">x =</span> Time, <span class="at">y =</span> Measurements,</span>
<span id="cb10-6"><a href="#cb10-6" tabindex="-1"></a>                                   <span class="at">percapita =</span> <span class="cn">TRUE</span>, <span class="at">blank =</span> <span class="dv">0</span>,</span>
<span id="cb10-7"><a href="#cb10-7" tabindex="-1"></a>                                   <span class="at">window_width_n =</span> <span class="dv">5</span>),</span>
<span id="cb10-8"><a href="#cb10-8" tabindex="-1"></a>         <span class="at">deriv_9 =</span> <span class="fu">calc_deriv</span>(<span class="at">x =</span> Time, <span class="at">y =</span> Measurements,</span>
<span id="cb10-9"><a href="#cb10-9" tabindex="-1"></a>                            <span class="at">window_width_n =</span> <span class="dv">9</span>),</span>
<span id="cb10-10"><a href="#cb10-10" tabindex="-1"></a>         <span class="at">derivpercap_9 =</span> <span class="fu">calc_deriv</span>(<span class="at">x =</span> Time, <span class="at">y =</span> Measurements,</span>
<span id="cb10-11"><a href="#cb10-11" tabindex="-1"></a>                                   <span class="at">percapita =</span> <span class="cn">TRUE</span>, <span class="at">blank =</span> <span class="dv">0</span>,</span>
<span id="cb10-12"><a href="#cb10-12" tabindex="-1"></a>                                   <span class="at">window_width_n =</span> <span class="dv">9</span>))</span>
<span id="cb10-13"><a href="#cb10-13" tabindex="-1"></a><span class="co">#Reshape our data for plotting purposes</span></span>
<span id="cb10-14"><a href="#cb10-14" tabindex="-1"></a>ex_dat_mrg_wide <span class="ot">&lt;-</span> </span>
<span id="cb10-15"><a href="#cb10-15" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(ex_dat_mrg, <span class="at">cols =</span> <span class="fu">starts_with</span>(<span class="st">&quot;deriv&quot;</span>),</span>
<span id="cb10-16"><a href="#cb10-16" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="fu">c</span>(<span class="st">&quot;deriv&quot;</span>, <span class="st">&quot;window_width_n&quot;</span>), <span class="at">names_sep =</span> <span class="st">&quot;_&quot;</span>)</span>
<span id="cb10-17"><a href="#cb10-17" tabindex="-1"></a>ex_dat_mrg_wide <span class="ot">&lt;-</span> </span>
<span id="cb10-18"><a href="#cb10-18" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(ex_dat_mrg_wide, <span class="at">names_from =</span> deriv, <span class="at">values_from =</span> value)</span>
<span id="cb10-19"><a href="#cb10-19" tabindex="-1"></a>                               </span>
<span id="cb10-20"><a href="#cb10-20" tabindex="-1"></a><span class="co">#Plot derivative</span></span>
<span id="cb10-21"><a href="#cb10-21" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(ex_dat_mrg_wide, noise <span class="sc">==</span> <span class="st">&quot;Yes&quot;</span>),</span>
<span id="cb10-22"><a href="#cb10-22" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> Time, <span class="at">y =</span> deriv)) <span class="sc">+</span></span>
<span id="cb10-23"><a href="#cb10-23" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">color =</span> window_width_n), <span class="at">linewidth =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb10-24"><a href="#cb10-24" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Well, <span class="at">scales =</span> <span class="st">&quot;free_y&quot;</span>) <span class="sc">+</span></span>
<span id="cb10-25"><a href="#cb10-25" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(ex_dat_mrg_wide, </span>
<span id="cb10-26"><a href="#cb10-26" tabindex="-1"></a>                                 noise <span class="sc">==</span> <span class="st">&quot;No&quot;</span>, window_width_n <span class="sc">==</span> <span class="dv">2</span>),</span>
<span id="cb10-27"><a href="#cb10-27" tabindex="-1"></a>            <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb10-28"><a href="#cb10-28" tabindex="-1"></a>  <span class="fu">scale_color_grey</span>(<span class="at">start =</span> <span class="fl">0.8</span>, <span class="at">end =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb10-29"><a href="#cb10-29" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb10-30"><a href="#cb10-30" tabindex="-1"></a><span class="co">#&gt; Warning: Removed 13 rows containing missing values (`geom_line()`).</span></span>
<span id="cb10-31"><a href="#cb10-31" tabindex="-1"></a><span class="co">#&gt; Warning: Removed 1 row containing missing values (`geom_line()`).</span></span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a>       </span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a><span class="co">#Plot per-capita derivative</span></span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(ex_dat_mrg_wide, noise <span class="sc">==</span> <span class="st">&quot;Yes&quot;</span>),</span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> Time, <span class="at">y =</span> derivpercap)) <span class="sc">+</span></span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">color =</span> window_width_n), <span class="at">linewidth =</span> <span class="fl">0.6</span>, <span class="at">alpha =</span> <span class="fl">0.75</span>) <span class="sc">+</span></span>
<span id="cb11-6"><a href="#cb11-6" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Well, <span class="at">scales =</span> <span class="st">&quot;free_y&quot;</span>) <span class="sc">+</span></span>
<span id="cb11-7"><a href="#cb11-7" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(ex_dat_mrg_wide,</span>
<span id="cb11-8"><a href="#cb11-8" tabindex="-1"></a>                                 noise <span class="sc">==</span> <span class="st">&quot;No&quot;</span>, window_width_n <span class="sc">==</span> <span class="dv">5</span>),</span>
<span id="cb11-9"><a href="#cb11-9" tabindex="-1"></a>            <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb11-10"><a href="#cb11-10" tabindex="-1"></a>  <span class="fu">scale_color_grey</span>(<span class="at">start =</span> <span class="fl">0.8</span>, <span class="at">end =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb11-11"><a href="#cb11-11" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="cn">NA</span>, <span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb11-12"><a href="#cb11-12" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb11-13"><a href="#cb11-13" tabindex="-1"></a><span class="co">#&gt; Warning: Removed 14 rows containing missing values (`geom_line()`).</span></span>
<span id="cb11-14"><a href="#cb11-14" tabindex="-1"></a><span class="co">#&gt; Warning: Removed 4 rows containing missing values (`geom_line()`).</span></span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>As we can see, increasing the width of the window reduces the effects
of noise, getting us closer to the noiseless data (red line). However,
it also starts making peaks shorter and valleys shallower. Finding the
right width that balances those two effects is the key to choosing the
right <code>window_width</code>.</p>
</div>
<div id="Smoothing" class="section level1">
<h1>Smoothing raw data</h1>
<p>Finally, smoothing the raw density data can reduce the effects of
noise. <code>gcplyr</code> has a <code>smooth_data</code> function that
can carry out such smoothing. <code>smooth_data</code> has five
different smoothing algorithms to choose from:
<code>moving-average</code>, <code>moving-median</code>,
<code>loess</code>, <code>gam</code>, and
<code>smooth.spline</code>.</p>
<ul>
<li><code>moving-average</code> and <code>moving-median</code> are
simple smoothing algorithms that primarily act to reduce the effects of
outliers on the data</li>
<li><code>loess</code>, <code>gam</code>, and <code>smooth.spline</code>
are spline-fitting approaches that use polynomial-like curves, which
produces curves with smoothly changing derivatives, but can in some
cases create curvature artifacts not present in the original data</li>
</ul>
<p>Generally, I recommend sticking to the first two algorithms, alone or
in combination, since the others tend to add artifacts when used on
growth curve data.</p>
<p><strong>Regardless of which smoothing algorithm you use, you will
need to set a tuning parameter</strong> that controls how “smoothed” the
data are. Smoothing data is a step that alters the values you will
analyze. Because of that it can be rife with pitfalls. I recommend
choosing the value that smooths the data as little as necessary for your
analyses to work. To do so, try smoothing with different tuning
parameter values, plot the results, then choose the least smoothed one
you can.</p>
<p>Additionally, when sharing your findings, it’s important to be
transparent by sharing the raw data and smoothing methods, rather than
presenting the smoothed data as your source.</p>
<p>To use <code>smooth_data</code>, pass your x and y values, your
method of choice, and any additional arguments needed for the method. It
will return a vector of your smoothed y values.</p>
<div id="smoothing-with-moving-median" class="section level2">
<h2>Smoothing with moving-median</h2>
<p>For <code>moving-median</code>, there are two tuning parameters to
choose between: <code>window_width</code> specifies how wide the window
used to include points for the fitting is in units of <code>x</code>,
while <code>window_width_n</code> specifies it in number of data points.
Wider windows will be more smoothed. Here, we’ll show moving medians
with windows that are 5 and 9 data points wide (<code>movemed_1</code>
is just our raw, unsmoothed data).</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a>ex_dat_mrg <span class="ot">&lt;-</span></span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">group_by</span>(ex_dat_mrg, Well, Bacteria_strain, Phage, noise),</span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a>         <span class="at">movmed_1 =</span> Measurements,</span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a>         <span class="at">movmed_5 =</span> </span>
<span id="cb12-5"><a href="#cb12-5" tabindex="-1"></a>           <span class="fu">smooth_data</span>(<span class="at">x =</span> Time, <span class="at">y =</span> Measurements,</span>
<span id="cb12-6"><a href="#cb12-6" tabindex="-1"></a>                       <span class="at">sm_method =</span> <span class="st">&quot;moving-median&quot;</span>, <span class="at">window_width_n =</span> <span class="dv">5</span>),</span>
<span id="cb12-7"><a href="#cb12-7" tabindex="-1"></a>         <span class="at">movmed_9 =</span> </span>
<span id="cb12-8"><a href="#cb12-8" tabindex="-1"></a>           <span class="fu">smooth_data</span>(<span class="at">x =</span> Time, <span class="at">y =</span> Measurements,</span>
<span id="cb12-9"><a href="#cb12-9" tabindex="-1"></a>                       <span class="at">sm_method =</span> <span class="st">&quot;moving-median&quot;</span>, <span class="at">window_width_n =</span> <span class="dv">9</span>))</span>
<span id="cb12-10"><a href="#cb12-10" tabindex="-1"></a></span>
<span id="cb12-11"><a href="#cb12-11" tabindex="-1"></a><span class="co">#Reshape our data for plotting purposes</span></span>
<span id="cb12-12"><a href="#cb12-12" tabindex="-1"></a>ex_dat_mrg_wide <span class="ot">&lt;-</span> </span>
<span id="cb12-13"><a href="#cb12-13" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(ex_dat_mrg, <span class="at">cols =</span> <span class="fu">starts_with</span>(<span class="st">&quot;movmed&quot;</span>),</span>
<span id="cb12-14"><a href="#cb12-14" tabindex="-1"></a>               <span class="at">names_prefix =</span> <span class="st">&quot;movmed_&quot;</span>, <span class="at">names_to =</span> <span class="st">&quot;window_width_n&quot;</span>)</span>
<span id="cb12-15"><a href="#cb12-15" tabindex="-1"></a></span>
<span id="cb12-16"><a href="#cb12-16" tabindex="-1"></a><span class="co">#Plot data</span></span>
<span id="cb12-17"><a href="#cb12-17" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(ex_dat_mrg_wide, noise <span class="sc">==</span> <span class="st">&quot;Yes&quot;</span>),</span>
<span id="cb12-18"><a href="#cb12-18" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> Time, <span class="at">y =</span> value)) <span class="sc">+</span></span>
<span id="cb12-19"><a href="#cb12-19" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">color =</span> window_width_n), <span class="at">linewidth =</span> <span class="fl">0.6</span>, <span class="at">alpha =</span> <span class="fl">0.75</span>) <span class="sc">+</span></span>
<span id="cb12-20"><a href="#cb12-20" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Well, <span class="at">scales =</span> <span class="st">&quot;free_y&quot;</span>) <span class="sc">+</span></span>
<span id="cb12-21"><a href="#cb12-21" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(ex_dat_mrg_wide,</span>
<span id="cb12-22"><a href="#cb12-22" tabindex="-1"></a>                                 noise <span class="sc">==</span> <span class="st">&quot;No&quot;</span>, window_width_n <span class="sc">==</span> <span class="dv">1</span>),</span>
<span id="cb12-23"><a href="#cb12-23" tabindex="-1"></a>            <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb12-24"><a href="#cb12-24" tabindex="-1"></a>  <span class="fu">scale_color_grey</span>(<span class="at">start =</span> <span class="fl">0.8</span>, <span class="at">end =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb12-25"><a href="#cb12-25" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>() <span class="sc">+</span></span>
<span id="cb12-26"><a href="#cb12-26" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;moving-median&quot;</span>) <span class="sc">+</span></span>
<span id="cb12-27"><a href="#cb12-27" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb12-28"><a href="#cb12-28" tabindex="-1"></a><span class="co">#&gt; Warning: Transformation introduced infinite values in continuous y-axis</span></span>
<span id="cb12-29"><a href="#cb12-29" tabindex="-1"></a><span class="co">#&gt; Warning: Removed 12 rows containing missing values (`geom_line()`).</span></span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAWlBMVEUAAAAaGhopKSkqKiorKyszMzM1NTU2NjZAQEBNTU1oaGh8fHyMjIyampqlpaWmpqanp6ewsLCysrK9vb3Hx8fQ0NDU1NTZ2dnh4eHp6enr6+vw8PD/AAD///94hXKrAAAACXBIWXMAAA7DAAAOwwHHb6hkAAALTElEQVR4nO2diYKjKBCGCW7Prkm6J9OHThJ4/9dcAVFQEQQ0gvVvj3Zsy8i3RXF4FKKgWaFXn8DeBYAsAkAWASCLAJBFAMgiAGQRALJofUAo4CuYbYh9BAEg2ym89NttejEcfgrBB0D0iq70fkbXZ/Px/o7Q+50+0Zn/9Yz+Ci+4X1F5Y1vuF3T+6Qs+MH8y82e737X3oPqKhL1ypG0UAVBz7uj73CzemwKWzRqVz6bU9+aP94aTKCTffpM7qIBUc8r/ytjy/a4S0I8wuqlH2kgRAL3Tb3bG36wkN3Sh9NJ8+uFluKGfFtDlSb9QSelns8PzogJSzT+Z1Q19iQOJ/di/M/qm9K9+pI0UAdCdLZ6yJHfhN/TMylCWMtDeqbYDMpnzbVd1P7Hv/efzoh9pI8WIQcpCnDlbfqGa1uhzuLn7ra1oQ3Okbu8tLuPtG2k1QM+m7tykZ4QCekfnr597DoD6KtYU6s7qygDQuIrp5nK7XsX4Ds8cAHVBummZG0+o6RBQu4MB0I1ZfrNdPlkwvvSAaiVkpwyoa+Ypc4Kz3EGpeaNmfmyO/g6b+dtE1dtIkQHJjiLTF2ubh4B4R/HbBIibX5jf0ftV7SjyzWkC8vvW7foxodoaEI9LN95rTkNbA2qjyX3jr/XX5lXs69wFqST0mhiUkACQRQDIIgBkEQCyCABZFArobawNzTdQMKB6qGWAwsw3EACyCABZBIAsAkAWASCLAJBFAMiiKIBOomyn5SU8MWmHyBHQSRTv5AFIelBre8oZ0MnHg96k45zkKl9AXlWsi0E5V7GTLB/EoAkxQHohwYM0BXrQEQD18QcATSgQ0CFi0EDQk9YEgCwCQBYBIIsAkEUAyKK5C1vdbWRlWY5XVvN9KBjQgz6an3bBVl0JOw6l+KevpHln1y5SBGTwBC4zoJIeBZDBE4RGgMi4ihkA8Qr1GKhKD5DJE4R0QAUh7oCEueZBhKToQUZAugsQgjFu1ssB1ZUEVCRZxdw8iJBhkHYG9Ju0x8AZA8J41Io5AyISEEkzSLsBGjfzYifxXJ2xH3RoQA7KCNDYE7haQGSio+giAQgnDmhOMQAVEhDOF1ARAAhTrFRTADQwB0AWcwaoDdIkX0CyGfIB1MQv0vbFH1pHfB96PaDGGDxoxjx/QF3laOUBKP8gjUM86AitGAAyKiKg+h8ANGHe94OKTIN0tFaMpDppPysOiDymACmD/lLdMJwPOiogZdqoLJUNoxlFCag4LKCSzgEiMkhnDKiweNA0oPaiCOY/D7lMEJAplnAFABLmzDhtDzLFEqGIgFIN0qZYIhQFUNqtmKmgypVVdaz6WAqI5AuIydoP6kxM/aDjAnKRCiiDIL0WIB6kq0wBVaYg7aS3R1WkDsgYS7gAkEURAaUapOfFAOHJexTdzDkgHqRxvoBIAKCKOQ7vR2GS6lhsVjEACQ9qJ90A0MC8A4QB0KQ5A4TrvAGFBOmKt2JZA5IzXX5XVg8AKJYHZRykgwGRzAGFt2LHBNQP2eRvU0M5fFhA6lStvItY3041QBkHaUdAk1PaHNAxW7GxB01NaVesj4CbvkKFXXsJw1N2LgLS1252LwQkzJkx86Da24MWFwEJm2iATMGW662qIwHyDtKvBmQKtkJRABErIKQsePmQzECCRGFF2hZ91wnD1gB1K+070ERCEw9A5cCD5JN0foCIMyDUL1HrAaLIOgHdO4aGigHSdhx/9gbUlU9E2Uq7bKhE2X4ue64fJAEV81UM9SVUXGVi3XGwGuquNv4cDkiU0ORBTuoByUtHAEiTAMSCdGEDpFYTM6C+SlkNNwOEgwBhADQnZ0DtiSrBeRhz+0LrhRoZosiAjMG2LWEkQJYYNA1o0MzbAUkDaRcF0KyiAHII0i9TBEBBQZpfDSNVf49RfoCKCM38v9E9qE9IGrjnqwGRqgVkC9Kv0i4AfeQN6BEC6CEA/foAQNPm3C5vQPplQ49HMgWgfJv5CB5EsgZETIBGM5FTHXEBqMAk3ypmAjQx0TYxIQmA6BBQOelBOFtAZLEHaROS4t2AWLwfLsuhhmSzHJAwZ1ZVXXXHAEBJA+ovnrjqWIDUqTZHmV/n6wYo1tuAQ2uC24E9AM1oNBM50Q+KJZd5Dc8jDz5EBLShUJIeFFejV5fXtfrnbQBR11m4/WkjQOkKAFm0UQxynunutJdk2Ft60LKO4k7SRmxaxRZ50E4ArSYAZBEAsmgqSC+xPxYgDwEgiw4ECPVaYH8gQH4KzLOqm57yzPXcJrgMSYbdUzrtG5BXFesygHoDOtWJAFLuBHWV4kEhiWiTArS0oyjjiGcMOgCgQ3nQ0jp2LEDdfdbuOhig5YoJKKAftN5UeiZDjfVmjgej+cX2+wC04sz64NCLEW0G6M9Y6mmvdrFq/PDGsm/ajwdtF4MSHc1vBShJD2LaBtDyGLSL62JbVbEhnu4+lbk0l6YbqJw0SmXseY/ihkFakVu671BAtDff/R1muhzTfeuAKi9AJElA1AZoKt038XlWI1dATLoHkaXpvg8GCBeeMag4BiCRUNYDUHUMQO3jFh6AcNJVbHwfr6EfRPyfF0vVgxwUB1CqHuSgHlCBAdCEFEDDnrRrAraEY5CDzICUWD6fgA0AzSdgk/2n3AGRGQ+aBtSPVDAOHc2vp3BA3SDMMztUlGb+NdMdLuo9yPxA3fqAtp2TXqQOEA4BFBqkARCl/42ll2LngMR7uib6QcpDmLP9oDrQg3Z76bktFxkDcjPnkx2hgCha7ZnDfQAqQgHR3VexEEAkGNCLYpDbYGoPgF7TD3IcTBmDtItiAVpPToBmB1OhgOoGUHCQXk9uHmQbTD18B1McUIRWbD2FAGJqPYj4X1kFQHMCQBY1gKqmfmK2Sm66YzMPSrUVcxxMtZfEjgjIRS2ggNtfANC8ecL9ICcJQCQIUKqtmJMaQFUgIEwB0Ix5C6gCQAZzDqjIGdBjkGl1MSCSOSDmQUGtGACaNeeAKM4YUF11KR90QE5pRBvXaQCRIwJS59vkfWr6dioAYQBE20HuBKAKACm/6YDaBHc8awCpEpzucBIHVHgB4ubCg1iQrjL2oDBAJFlAbs1QzTOi+wMiyXqQYzMUDOiRDaDJZsgIyDGNqABEsgA02Qw9WCXxT10j6GYKiIl50HQ6dScBIIuOAWg6GbaTJKA8gvQ6gNJtxdyaoSMDclED6NcHADKrAYSDgjRJN0g7qQEUlmcV1wBozhxjPs9BKjnfkSGgoFzPHzyAcQ+qc/WgGIBwxoDwII/oQkAke0CkCvKgAwB6AKAZhQIipA/S1eM3zu+F28YsmW7mon52gH7lB6itGQDIIABkUSRAWAAqqqQAOWWzNgNyM1cBVWkBmriqoV79ETIDcjTPEFDp5kGO5hkC6upIe9nH8KZIN/PWmjRiGbEXvkRvA4UAYoqSyrj5r/rzUVcfRVI9aQDEtBtA9ENcw84O0E6SYa+mRZd9prJZv/GfwcrTvP1tVwp+3NwMaLk5ALKYZwkodwEgiwCQRQDIIgBkUSCgUoj3AzUtNVcs3c23UBgg2QuUiNT+8yLzUpi3qz0pGJDE0wNyL+HIXCLekSIAKuUsWCk9wbmGhZlvosgeVCo1baF5qXjQjghFiEFDQHQJoN5cQMoZkIzVfoCU6pYXoLIvoRKkPaoYzbGKUdnpUTsyC6JsqQRmtR8UdlJRBT1piwCQRQDIIgBkEQCyCABZtNpLdKVS/1+w5uknjkYIAFm0PiD2Qn7xQuz2rdgrZq5eQdsA4q9Ub9+rjtb+2rjayINovwBAg2OPAKGk6tiLPCgdASCLIAZZtD0gaObzEgCyCABZBIAsAkAWASCLAJBFAMgiAGQRALLof5ys+oK8pyVPAAAAAElFTkSuQmCC" /><!-- --></p>
<p>Here we can see that <code>moving-median</code> has done a great job
excluding noise without biasing our data very far from the true values
(red line). However, it has produced a smoothed density that is fairly
“jumpy”, something that is common with moving-median. To address this,
you often will need to combine <code>moving-median</code> with other
smoothing methods.</p>
</div>
<div id="smoothing-with-moving-average" class="section level2">
<h2>Smoothing with moving-average</h2>
<p>For <code>moving-average</code>, there are the same two tuning
parameters: <code>window_width</code> specifies how wide the window used
to include points for the fitting is in units of <code>x</code>, while
<code>window_width_n</code> specifies it in number of data points. Here,
we’ll show moving averages with <code>window_width_n</code> values of 5
or 9 data points wide (<code>movavg_1</code> is just our raw, unsmoothed
data).</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a>ex_dat_mrg <span class="ot">&lt;-</span></span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">group_by</span>(ex_dat_mrg, Well, Bacteria_strain, Phage, noise),</span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a>         <span class="at">movavg_1 =</span> Measurements,</span>
<span id="cb13-4"><a href="#cb13-4" tabindex="-1"></a>         <span class="at">movavg_5 =</span> <span class="fu">smooth_data</span>(<span class="at">x =</span> Time, <span class="at">y =</span> Measurements,</span>
<span id="cb13-5"><a href="#cb13-5" tabindex="-1"></a>              <span class="at">sm_method =</span> <span class="st">&quot;moving-average&quot;</span>, <span class="at">window_width_n =</span> <span class="dv">5</span>),</span>
<span id="cb13-6"><a href="#cb13-6" tabindex="-1"></a>         <span class="at">movavg_9 =</span> <span class="fu">smooth_data</span>(<span class="at">x =</span> Time, <span class="at">y =</span> Measurements,</span>
<span id="cb13-7"><a href="#cb13-7" tabindex="-1"></a>              <span class="at">sm_method =</span> <span class="st">&quot;moving-average&quot;</span>, <span class="at">window_width_n =</span> <span class="dv">9</span>))</span>
<span id="cb13-8"><a href="#cb13-8" tabindex="-1"></a></span>
<span id="cb13-9"><a href="#cb13-9" tabindex="-1"></a><span class="co">#Reshape our data for plotting purposes</span></span>
<span id="cb13-10"><a href="#cb13-10" tabindex="-1"></a>ex_dat_mrg_wide <span class="ot">&lt;-</span> </span>
<span id="cb13-11"><a href="#cb13-11" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(ex_dat_mrg, <span class="at">cols =</span> <span class="fu">starts_with</span>(<span class="st">&quot;movavg&quot;</span>),</span>
<span id="cb13-12"><a href="#cb13-12" tabindex="-1"></a>               <span class="at">names_prefix =</span> <span class="st">&quot;movavg_&quot;</span>, <span class="at">names_to =</span> <span class="st">&quot;window_width_n&quot;</span>)</span>
<span id="cb13-13"><a href="#cb13-13" tabindex="-1"></a></span>
<span id="cb13-14"><a href="#cb13-14" tabindex="-1"></a><span class="co">#Plot data</span></span>
<span id="cb13-15"><a href="#cb13-15" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(ex_dat_mrg_wide, noise <span class="sc">==</span> <span class="st">&quot;Yes&quot;</span>),</span>
<span id="cb13-16"><a href="#cb13-16" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> Time, <span class="at">y =</span> value)) <span class="sc">+</span></span>
<span id="cb13-17"><a href="#cb13-17" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">color =</span> window_width_n), <span class="at">linewidth =</span> <span class="fl">0.6</span>, <span class="at">alpha =</span> <span class="fl">0.75</span>) <span class="sc">+</span></span>
<span id="cb13-18"><a href="#cb13-18" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Well, <span class="at">scales =</span> <span class="st">&quot;free_y&quot;</span>) <span class="sc">+</span></span>
<span id="cb13-19"><a href="#cb13-19" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(ex_dat_mrg_wide,</span>
<span id="cb13-20"><a href="#cb13-20" tabindex="-1"></a>                                 noise <span class="sc">==</span> <span class="st">&quot;No&quot;</span>, window_width_n <span class="sc">==</span> <span class="dv">1</span>),</span>
<span id="cb13-21"><a href="#cb13-21" tabindex="-1"></a>            <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb13-22"><a href="#cb13-22" tabindex="-1"></a>  <span class="fu">scale_color_grey</span>(<span class="at">start =</span> <span class="fl">0.8</span>, <span class="at">end =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb13-23"><a href="#cb13-23" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>() <span class="sc">+</span></span>
<span id="cb13-24"><a href="#cb13-24" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;moving-average&quot;</span>) <span class="sc">+</span></span>
<span id="cb13-25"><a href="#cb13-25" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb13-26"><a href="#cb13-26" tabindex="-1"></a><span class="co">#&gt; Warning: Transformation introduced infinite values in continuous y-axis</span></span>
<span id="cb13-27"><a href="#cb13-27" tabindex="-1"></a><span class="co">#&gt; Warning: Removed 12 rows containing missing values (`geom_line()`).</span></span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Here we can see that <code>moving-average</code> has helped reduce
the effects of some of that early noise. However, as the window width
gets larger, it also starts underrepresenting the maximum density peaks
relative to the true value (red line).</p>
</div>
<div id="combining-multiple-smoothing-methods" class="section level2">
<h2>Combining multiple smoothing methods</h2>
<p>Often, combining multiple smoothing methods can provide improved
results. For instance, <code>moving-median</code> is particularly good
at removing outliers, but not very good at producing smoothly changing
data. In contrast, <code>moving-average</code> works well at producing
smoothly changing data, but isn’t as good at removing outliers. Often,
we can get the best of both by using <code>moving-median</code> first,
followed by <code>moving-average</code>:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a>ex_dat_mrg <span class="ot">&lt;-</span></span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">group_by</span>(ex_dat_mrg, Well, Bacteria_strain, Phage, noise),</span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a>         <span class="at">smoothed_no =</span> Measurements,</span>
<span id="cb14-4"><a href="#cb14-4" tabindex="-1"></a>         <span class="at">sm_med3 =</span> </span>
<span id="cb14-5"><a href="#cb14-5" tabindex="-1"></a>           <span class="fu">smooth_data</span>(<span class="at">x =</span> Time, <span class="at">y =</span> Measurements,</span>
<span id="cb14-6"><a href="#cb14-6" tabindex="-1"></a>                       <span class="at">sm_method =</span> <span class="st">&quot;moving-median&quot;</span>, <span class="at">window_width_n =</span> <span class="dv">3</span>),</span>
<span id="cb14-7"><a href="#cb14-7" tabindex="-1"></a>         <span class="co">#Note that for the second round, we&#39;re using the </span></span>
<span id="cb14-8"><a href="#cb14-8" tabindex="-1"></a>         <span class="co">#first smoothing as the input y</span></span>
<span id="cb14-9"><a href="#cb14-9" tabindex="-1"></a>         <span class="at">smoothed_yes =</span> </span>
<span id="cb14-10"><a href="#cb14-10" tabindex="-1"></a>           <span class="fu">smooth_data</span>(<span class="at">x =</span> Time, <span class="at">y =</span> sm_med3,</span>
<span id="cb14-11"><a href="#cb14-11" tabindex="-1"></a>                       <span class="at">sm_method =</span> <span class="st">&quot;moving-average&quot;</span>, <span class="at">window_width_n =</span> <span class="dv">3</span>))</span>
<span id="cb14-12"><a href="#cb14-12" tabindex="-1"></a></span>
<span id="cb14-13"><a href="#cb14-13" tabindex="-1"></a><span class="co">#Reshape our data for plotting purposes</span></span>
<span id="cb14-14"><a href="#cb14-14" tabindex="-1"></a>ex_dat_mrg_wide <span class="ot">&lt;-</span> </span>
<span id="cb14-15"><a href="#cb14-15" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(ex_dat_mrg, <span class="at">cols =</span> <span class="fu">starts_with</span>(<span class="st">&quot;smoothed&quot;</span>),</span>
<span id="cb14-16"><a href="#cb14-16" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">&quot;smoothed&quot;</span>, <span class="at">names_prefix =</span> <span class="st">&quot;smoothed_&quot;</span>)</span>
<span id="cb14-17"><a href="#cb14-17" tabindex="-1"></a></span>
<span id="cb14-18"><a href="#cb14-18" tabindex="-1"></a><span class="co">#Plot data</span></span>
<span id="cb14-19"><a href="#cb14-19" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(ex_dat_mrg_wide, noise <span class="sc">==</span> <span class="st">&quot;Yes&quot;</span>),</span>
<span id="cb14-20"><a href="#cb14-20" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> Time, <span class="at">y =</span> value, <span class="at">color =</span> smoothed)) <span class="sc">+</span></span>
<span id="cb14-21"><a href="#cb14-21" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="fl">0.6</span>, <span class="at">alpha =</span> <span class="fl">0.75</span>) <span class="sc">+</span></span>
<span id="cb14-22"><a href="#cb14-22" tabindex="-1"></a>  <span class="fu">scale_color_grey</span>(<span class="at">start =</span> <span class="fl">0.8</span>, <span class="at">end =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb14-23"><a href="#cb14-23" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Well, <span class="at">scales =</span> <span class="st">&quot;free_y&quot;</span>) <span class="sc">+</span></span>
<span id="cb14-24"><a href="#cb14-24" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(ex_dat_mrg_wide,</span>
<span id="cb14-25"><a href="#cb14-25" tabindex="-1"></a>                                 noise <span class="sc">==</span> <span class="st">&quot;No&quot;</span>, smoothed <span class="sc">==</span> <span class="st">&quot;no&quot;</span>),</span>
<span id="cb14-26"><a href="#cb14-26" tabindex="-1"></a>            <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb14-27"><a href="#cb14-27" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>() <span class="sc">+</span></span>
<span id="cb14-28"><a href="#cb14-28" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;median then average smoothing&quot;</span>) <span class="sc">+</span></span>
<span id="cb14-29"><a href="#cb14-29" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb14-30"><a href="#cb14-30" tabindex="-1"></a><span class="co">#&gt; Warning: Transformation introduced infinite values in continuous y-axis</span></span>
<span id="cb14-31"><a href="#cb14-31" tabindex="-1"></a><span class="co">#&gt; Warning: Removed 4 rows containing missing values (`geom_line()`).</span></span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Here we can see that the combination of minimal
<code>moving-median</code> and <code>moving-average</code> smoothing has
produced a curve that has most of the noise removed with minimal
introduction of bias relative to the true values (red line).</p>
</div>
<div id="smoothing-with-other-methods" class="section level2">
<h2>Smoothing with other methods</h2>
<p>I typically recommend against using other smoothing algorithms, since
they have a tendency to add artifacts to growth curve data. However,
they may work for your analyses, so if you are considering using them
make sure to plot the smoothed output to check for any introduced
artifacts.</p>
<p>For <code>loess</code>, the tuning parameter is the <code>span</code>
argument. <code>loess</code> works by doing fits on subset windows of
the data centered at each data point. <code>span</code> is the width of
the window, as a fraction of all data points. <code>span</code> values
typically are between 0 and 1, and larger values are more “smoothed”.
The fits can be linear (<code>degree = 1</code>) or polynomial
(typically <code>degree = 2</code>).</p>
<p>For <code>gam</code>, the primary tuning parameter is the
<code>k</code> argument. <code>gam</code> works by doing fits on subsets
of the data and linking these fits together. <code>k</code> determines
how many link points (“knots”) it can use. If not specified, the default
<code>k</code> value for smoothing a time series is 10, with
<strong>smaller values being more “smoothed”</strong>. However,
<strong>unlike earlier methods, <code>k</code> values that are too large
are also problematic</strong>, as they will tend to ‘overfit’ the
data.</p>
<p>For <code>smooth.spline</code>, the primary tuning parameters are
<code>df</code> and <code>spar</code>. <code>df</code> is the number of
degrees of freedom, and must be between 1 and the number of unique x
values. <code>spar</code> is the smoothing parameter, and is typically
between 0 and 1.</p>
</div>
</div>
<div id="DerivsOfSmoothed" class="section level1">
<h1>Calculating derivatives of smoothed data</h1>
<p>Once you’ve smoothed your data, you can calculate derivatives using
the smoothed data. Combining smoothing of raw data and fitting using
multiple points for calculating derivatives can be a powerful
combination for reducing the effects of noise while minimizing the
introduction of bias.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a><span class="co"># Note here that we&#39;re calculating derivatives of the smoothed column generated</span></span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a><span class="co">#  in the previous section by combining moving median and moving average smoothing</span></span>
<span id="cb15-3"><a href="#cb15-3" tabindex="-1"></a>ex_dat_mrg <span class="ot">&lt;-</span> </span>
<span id="cb15-4"><a href="#cb15-4" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">group_by</span>(ex_dat_mrg, Well, Bacteria_strain, Phage, noise),</span>
<span id="cb15-5"><a href="#cb15-5" tabindex="-1"></a>         <span class="at">smderiv_0 =</span> <span class="fu">calc_deriv</span>(<span class="at">x =</span> Time, <span class="at">y =</span> Measurements),</span>
<span id="cb15-6"><a href="#cb15-6" tabindex="-1"></a>         <span class="at">smderivpercap_0 =</span> <span class="fu">calc_deriv</span>(<span class="at">x =</span> Time, <span class="at">y =</span> Measurements,</span>
<span id="cb15-7"><a href="#cb15-7" tabindex="-1"></a>                                       <span class="at">percapita =</span> <span class="cn">TRUE</span>, <span class="at">blank =</span> <span class="dv">0</span>),</span>
<span id="cb15-8"><a href="#cb15-8" tabindex="-1"></a>         <span class="at">smderiv_3 =</span> <span class="fu">calc_deriv</span>(<span class="at">x =</span> Time, <span class="at">y =</span> smoothed_yes, <span class="at">window_width_n =</span> <span class="dv">3</span>),</span>
<span id="cb15-9"><a href="#cb15-9" tabindex="-1"></a>         <span class="at">smderivpercap_3 =</span> <span class="fu">calc_deriv</span>(<span class="at">x =</span> Time, <span class="at">y =</span> smoothed_yes, <span class="at">percapita =</span> <span class="cn">TRUE</span>, </span>
<span id="cb15-10"><a href="#cb15-10" tabindex="-1"></a>                                    <span class="at">blank =</span> <span class="dv">0</span>, <span class="at">window_width_n =</span> <span class="dv">3</span>))</span>
<span id="cb15-11"><a href="#cb15-11" tabindex="-1"></a></span>
<span id="cb15-12"><a href="#cb15-12" tabindex="-1"></a><span class="co">#Reshape our data for plotting purposes</span></span>
<span id="cb15-13"><a href="#cb15-13" tabindex="-1"></a>ex_dat_mrg_wide <span class="ot">&lt;-</span> </span>
<span id="cb15-14"><a href="#cb15-14" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(ex_dat_mrg, <span class="at">cols =</span> <span class="fu">starts_with</span>(<span class="st">&quot;smderiv&quot;</span>),</span>
<span id="cb15-15"><a href="#cb15-15" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="fu">c</span>(<span class="st">&quot;deriv&quot;</span>, <span class="st">&quot;window_width_n&quot;</span>), <span class="at">names_sep =</span> <span class="st">&quot;_&quot;</span>)</span>
<span id="cb15-16"><a href="#cb15-16" tabindex="-1"></a>ex_dat_mrg_wide <span class="ot">&lt;-</span> </span>
<span id="cb15-17"><a href="#cb15-17" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(ex_dat_mrg_wide, <span class="at">names_from =</span> deriv, <span class="at">values_from =</span> value)</span>
<span id="cb15-18"><a href="#cb15-18" tabindex="-1"></a></span>
<span id="cb15-19"><a href="#cb15-19" tabindex="-1"></a><span class="co">#Plot derivative</span></span>
<span id="cb15-20"><a href="#cb15-20" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(ex_dat_mrg_wide, noise <span class="sc">==</span> <span class="st">&quot;Yes&quot;</span>),</span>
<span id="cb15-21"><a href="#cb15-21" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> Time, <span class="at">y =</span> smderiv, <span class="at">color =</span> window_width_n)) <span class="sc">+</span></span>
<span id="cb15-22"><a href="#cb15-22" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="fl">0.6</span>, <span class="at">alpha =</span> <span class="fl">0.75</span>) <span class="sc">+</span></span>
<span id="cb15-23"><a href="#cb15-23" tabindex="-1"></a>  <span class="fu">scale_color_grey</span>(<span class="at">start =</span> <span class="fl">0.8</span>, <span class="at">end =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb15-24"><a href="#cb15-24" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Well, <span class="at">scales =</span> <span class="st">&quot;free_y&quot;</span>) <span class="sc">+</span></span>
<span id="cb15-25"><a href="#cb15-25" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(ex_dat_mrg_wide,</span>
<span id="cb15-26"><a href="#cb15-26" tabindex="-1"></a>                                 noise <span class="sc">==</span> <span class="st">&quot;No&quot;</span>, window_width_n <span class="sc">==</span> <span class="dv">0</span>),</span>
<span id="cb15-27"><a href="#cb15-27" tabindex="-1"></a>            <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb15-28"><a href="#cb15-28" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb15-29"><a href="#cb15-29" tabindex="-1"></a><span class="co">#&gt; Warning: Removed 7 rows containing missing values (`geom_line()`).</span></span>
<span id="cb15-30"><a href="#cb15-30" tabindex="-1"></a><span class="co">#&gt; Warning: Removed 1 row containing missing values (`geom_line()`).</span></span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a></span>
<span id="cb16-2"><a href="#cb16-2" tabindex="-1"></a><span class="co">#Plot per-capita derivative</span></span>
<span id="cb16-3"><a href="#cb16-3" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(ex_dat_mrg_wide, noise <span class="sc">==</span> <span class="st">&quot;Yes&quot;</span>),</span>
<span id="cb16-4"><a href="#cb16-4" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> Time, <span class="at">y =</span> smderivpercap, <span class="at">color =</span> window_width_n)) <span class="sc">+</span></span>
<span id="cb16-5"><a href="#cb16-5" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="fl">0.6</span>, <span class="at">alpha =</span> <span class="fl">0.75</span>) <span class="sc">+</span></span>
<span id="cb16-6"><a href="#cb16-6" tabindex="-1"></a>  <span class="fu">scale_color_grey</span>(<span class="at">start =</span> <span class="fl">0.8</span>, <span class="at">end =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb16-7"><a href="#cb16-7" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Well, <span class="at">scales =</span> <span class="st">&quot;free_y&quot;</span>) <span class="sc">+</span></span>
<span id="cb16-8"><a href="#cb16-8" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(ex_dat_mrg_wide,</span>
<span id="cb16-9"><a href="#cb16-9" tabindex="-1"></a>                                 noise <span class="sc">==</span> <span class="st">&quot;No&quot;</span>, window_width_n <span class="sc">==</span> <span class="dv">3</span>),</span>
<span id="cb16-10"><a href="#cb16-10" tabindex="-1"></a>            <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb16-11"><a href="#cb16-11" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="cn">NA</span>, <span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb16-12"><a href="#cb16-12" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb16-13"><a href="#cb16-13" tabindex="-1"></a><span class="co">#&gt; Warning: Removed 8 rows containing missing values (`geom_line()`).</span></span>
<span id="cb16-14"><a href="#cb16-14" tabindex="-1"></a><span class="co">#&gt; Warning: Removed 6 rows containing missing values (`geom_line()`).</span></span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Here we can see that calculating derivatives from smoothed raw data
can be a powerfully useful combination.</p>
</div>
<div id="whats-next" class="section level1">
<h1>What’s next?</h1>
<p>Now that you’ve analyzed your data and dealt with any noise, there’s
just some concluding notes on best practices for running statistics,
merging growth curve analyses with other data, and additional resources
for analyzing growth curves.</p>
<ol style="list-style-type: decimal">
<li>Introduction: <code>vignette(&quot;gc01_gcplyr&quot;)</code></li>
<li>Importing and reshaping data:
<code>vignette(&quot;gc02_import_reshape&quot;)</code></li>
<li>Incorporating experimental designs:
<code>vignette(&quot;gc03_incorporate_designs&quot;)</code></li>
<li>Pre-processing and plotting your data:
<code>vignette(&quot;gc04_preprocess_plot&quot;)</code></li>
<li>Processing your data: <code>vignette(&quot;gc05_process&quot;)</code></li>
<li>Analyzing your data: <code>vignette(&quot;gc06_analyze&quot;)</code></li>
<li>Dealing with noise: <code>vignette(&quot;gc07_noise&quot;)</code></li>
<li><strong>Statistics, merging other data, and other
resources:</strong> <code>vignette(&quot;gc08_conclusion&quot;)</code></li>
<li>Working with multiple plates:
<code>vignette(&quot;gc09_multiple_plates&quot;)</code></li>
</ol>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
