<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Mike Blazanin" />


<title>Dealing with noise</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Dealing with noise</h1>
<h4 class="author">Mike Blazanin</h4>


<div id="TOC">
<ul>
<li><a href="#where-are-we-so-far" id="toc-where-are-we-so-far">Where
are we so far?</a></li>
<li><a href="#introduction" id="toc-introduction">Introduction</a></li>
<li><a href="#SubsetAnalysis" id="toc-SubsetAnalysis">Summarizing on
subsets of derivatives</a></li>
<li><a href="#FittingDeriv" id="toc-FittingDeriv">Fitting during
derivative calculation</a></li>
<li><a href="#Smoothing" id="toc-Smoothing">Smoothing raw data</a>
<ul>
<li><a href="#smoothing-with-moving-median" id="toc-smoothing-with-moving-median">Smoothing with
moving-median</a></li>
<li><a href="#smoothing-with-moving-average" id="toc-smoothing-with-moving-average">Smoothing with
moving-average</a></li>
<li><a href="#combining-multiple-smoothing-methods" id="toc-combining-multiple-smoothing-methods">Combining multiple
smoothing methods</a></li>
<li><a href="#smoothing-with-other-methods" id="toc-smoothing-with-other-methods">Smoothing with other
methods</a></li>
<li><a href="#ChoosingTuningParams" id="toc-ChoosingTuningParams">Choosing tuning parameter values</a></li>
</ul></li>
<li><a href="#DerivsOfSmoothed" id="toc-DerivsOfSmoothed">Calculating
derivatives of smoothed data</a></li>
<li><a href="#whats-next" id="toc-whats-next">What’s next?</a></li>
</ul>
</div>

<div id="where-are-we-so-far" class="section level1">
<h1>Where are we so far?</h1>
<ol style="list-style-type: decimal">
<li>Introduction: <code>vignette(&quot;gc01_gcplyr&quot;)</code></li>
<li>Importing and reshaping data:
<code>vignette(&quot;gc02_import_reshape&quot;)</code></li>
<li>Incorporating experimental designs:
<code>vignette(&quot;gc03_incorporate_designs&quot;)</code></li>
<li>Pre-processing and plotting your data:
<code>vignette(&quot;gc04_preprocess_plot&quot;)</code></li>
<li>Processing your data: <code>vignette(&quot;gc05_process&quot;)</code></li>
<li>Analyzing your data: <code>vignette(&quot;gc06_analyze&quot;)</code></li>
<li><strong>Dealing with noise:</strong>
<code>vignette(&quot;gc07_noise&quot;)</code></li>
<li>Best practices and other tips:
<code>vignette(&quot;gc08_conclusion&quot;)</code></li>
<li>Working with multiple plates:
<code>vignette(&quot;gc09_multiple_plates&quot;)</code></li>
<li>Using make_design to generate experimental designs:
<code>vignette(&quot;gc10_using_make_design&quot;)</code></li>
</ol>
<p>So far, we’ve imported and transformed our measures, combined them
with our design information, pre-processed, processed, plotted, and
analyzed our data. Here, we’re going to learn potential strategies for
dealing with noise in our growth curve data.</p>
<p>If you haven’t already, load the necessary packages.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">library</span>(gcplyr)</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span></code></pre></div>
</div>
<div id="introduction" class="section level1">
<h1>Introduction</h1>
<p>Oftentimes, growth curve data produced by a plate reader will have
some noise in it. Since <code>gcplyr</code> does model-free analyses,
our approach can sometimes be sensitive to noise, necessitating steps to
reduce the effects of noise.</p>
<p>When assessing the effects of noise in our data, one of the first
steps is simply to visualize our data, including both the raw data and
any derivatives we’ll be analyzing. This is especially important because
per-capita derivatives can be very sensitive to noise, especially when
density is low. By visualizing our data, we can assess whether the noise
we see is likely to throw off our analyses.</p>
<p>Broadly speaking, there are three strategies we can use to deal with
noise.</p>
<ol style="list-style-type: decimal">
<li><a href="#SubsetAnalysis">Excluding low-density data points</a></li>
<li><a href="#FittingDeriv">Using fitting during derivative
calculations</a></li>
<li><a href="#Smoothing">Smoothing the raw data</a></li>
</ol>
<p>Each approach is progressively more involved, so I recommend trying
them out in that order. Typically, noise is most problematic in the
derivatives, and all three approaches will help with that. However, if
you’re dealing with substantial noise in your raw density data, only
approach #3 will help.</p>
<p>Let’s start by pulling out some example data. The example data here
is the same example data we’ve been working with, along with a version
of that data with simulated noise added to it.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a>ex_dat_mrg <span class="ot">&lt;-</span> <span class="fu">make_example</span>(<span class="at">vignette =</span> <span class="dv">7</span>, <span class="at">example =</span> <span class="dv">1</span>)</span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a><span class="co">#&gt; Joining with `by = join_by(Time, Well, Measurements, noise)`</span></span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a><span class="co">#&gt; Joining with `by = join_by(Well)`</span></span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a><span class="co"># Plot with a log y-axis</span></span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(ex_dat_mrg, noise <span class="sc">==</span> <span class="st">&quot;Yes&quot;</span>),</span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> Time, <span class="at">y =</span> Measurements)) <span class="sc">+</span></span>
<span id="cb2-8"><a href="#cb2-8" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb2-9"><a href="#cb2-9" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(ex_dat_mrg, noise <span class="sc">==</span> <span class="st">&quot;No&quot;</span>),</span>
<span id="cb2-10"><a href="#cb2-10" tabindex="-1"></a>            <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb2-11"><a href="#cb2-11" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Well) <span class="sc">+</span></span>
<span id="cb2-12"><a href="#cb2-12" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">trans =</span> <span class="st">&quot;log10&quot;</span>)</span>
<span id="cb2-13"><a href="#cb2-13" tabindex="-1"></a><span class="co">#&gt; Warning: Transformation introduced infinite values in continuous y-axis</span></span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Great! Here we can see how the noisy (points) and noiseless (red
line) data compare. We’ve plotted our data with log-transformed y-axes,
which are useful because exponential growth is a straight line when
plotted on a log scale. log axes also reveal another common pattern:
<strong>random noise tends to have a much larger effect at low
densities</strong>.</p>
<p>This level of noise doesn’t seem like it would mess up calculations
of maximum density or area under the curve much, so that’s not enough of
a reason to smooth. But let’s look at what our derivatives look
like.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a>ex_dat_mrg <span class="ot">&lt;-</span> </span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">group_by</span>(ex_dat_mrg, Well, Bacteria_strain, Phage, noise),</span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a>         <span class="at">deriv_2 =</span> <span class="fu">calc_deriv</span>(<span class="at">x =</span> Time, <span class="at">y =</span> Measurements),</span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a>         <span class="at">derivpercap_2 =</span> <span class="fu">calc_deriv</span>(<span class="at">x =</span> Time, <span class="at">y =</span> Measurements,</span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a>                                   <span class="at">percapita =</span> <span class="cn">TRUE</span>, <span class="at">blank =</span> <span class="dv">0</span>))</span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a></span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a><span class="co"># Plot derivative</span></span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(ex_dat_mrg, noise <span class="sc">==</span> <span class="st">&quot;Yes&quot;</span>),</span>
<span id="cb3-9"><a href="#cb3-9" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> Time, <span class="at">y =</span> deriv_2)) <span class="sc">+</span></span>
<span id="cb3-10"><a href="#cb3-10" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb3-11"><a href="#cb3-11" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(ex_dat_mrg, noise <span class="sc">==</span> <span class="st">&quot;No&quot;</span>),</span>
<span id="cb3-12"><a href="#cb3-12" tabindex="-1"></a>            <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb3-13"><a href="#cb3-13" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Well, <span class="at">scales =</span> <span class="st">&quot;free_y&quot;</span>)</span>
<span id="cb3-14"><a href="#cb3-14" tabindex="-1"></a><span class="co">#&gt; Warning: Removed 4 rows containing missing values (`geom_point()`).</span></span>
<span id="cb3-15"><a href="#cb3-15" tabindex="-1"></a><span class="co">#&gt; Warning: Removed 1 row containing missing values (`geom_line()`).</span></span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a></span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a><span class="co"># Plot per-capita derivative</span></span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(ex_dat_mrg, noise <span class="sc">==</span> <span class="st">&quot;Yes&quot;</span>),</span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> Time, <span class="at">y =</span> derivpercap_2)) <span class="sc">+</span></span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(ex_dat_mrg, noise <span class="sc">==</span> <span class="st">&quot;No&quot;</span>),</span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a>            <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Well, <span class="at">scales =</span> <span class="st">&quot;free_y&quot;</span>)</span>
<span id="cb4-9"><a href="#cb4-9" tabindex="-1"></a><span class="co">#&gt; Warning: Removed 8 rows containing missing values (`geom_point()`).</span></span>
<span id="cb4-10"><a href="#cb4-10" tabindex="-1"></a><span class="co">#&gt; Removed 1 row containing missing values (`geom_line()`).</span></span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Those values are jumping all over the place! Let’s see what we can do
to address this.</p>
</div>
<div id="SubsetAnalysis" class="section level1">
<h1>Summarizing on subsets of derivatives</h1>
<p>One strategy we can employ when dealing with noisy data is excluding
data points where the density is near 0. If we compare our per-capita
growth rates and our density plots, we’ll see that most of the noise
occurs when the density is very close to 0:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="co">#Plot density</span></span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(ex_dat_mrg, noise <span class="sc">==</span> <span class="st">&quot;Yes&quot;</span>),</span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> Time, <span class="at">y =</span> Measurements)) <span class="sc">+</span></span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Well, <span class="at">scales =</span> <span class="st">&quot;free_y&quot;</span>) <span class="sc">+</span></span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>()</span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a><span class="co">#&gt; Warning: Transformation introduced infinite values in continuous y-axis</span></span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a></span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a><span class="co"># Plot per-capita derivative</span></span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(ex_dat_mrg, noise <span class="sc">==</span> <span class="st">&quot;Yes&quot;</span>),</span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> Time, <span class="at">y =</span> derivpercap_2)) <span class="sc">+</span></span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Well, <span class="at">scales =</span> <span class="st">&quot;free_y&quot;</span>)</span>
<span id="cb6-7"><a href="#cb6-7" tabindex="-1"></a><span class="co">#&gt; Warning: Removed 8 rows containing missing values (`geom_point()`).</span></span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Per-capita growth rates are often very noisy when the density is
close to 0, so it can make sense to simply exclude those data
points.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="co">#Plot density</span></span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(ex_dat_mrg, noise <span class="sc">==</span> <span class="st">&quot;Yes&quot;</span>, Measurements <span class="sc">&gt;</span> <span class="fl">0.01</span>),</span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> Time, <span class="at">y =</span> Measurements)) <span class="sc">+</span></span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Well, <span class="at">scales =</span> <span class="st">&quot;free_y&quot;</span>) <span class="sc">+</span></span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.01</span>, <span class="at">lty =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb7-7"><a href="#cb7-7" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>()</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a></span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a><span class="co"># Plot per-capita derivative</span></span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(ex_dat_mrg, noise <span class="sc">==</span> <span class="st">&quot;Yes&quot;</span>, Measurements <span class="sc">&gt;</span> <span class="fl">0.01</span>),</span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> Time, <span class="at">y =</span> derivpercap_2)) <span class="sc">+</span></span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb8-6"><a href="#cb8-6" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Well, <span class="at">scales =</span> <span class="st">&quot;free_y&quot;</span>)</span>
<span id="cb8-7"><a href="#cb8-7" tabindex="-1"></a><span class="co">#&gt; Warning: Removed 3 rows containing missing values (`geom_point()`).</span></span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>When we limit our analysis to data points where the density is not
too close to 0, much of the noise in our per-capita derivative
disappears.</p>
<p>To take this to the final step, we can use these cutoffs in our
<code>summarize</code> commands to calculate the maximum growth rate of
the bacteria when their density is at least 0.01.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a>ex_dat_mrg_sum <span class="ot">&lt;-</span></span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="fu">group_by</span>(ex_dat_mrg, Well, Bacteria_strain, Phage, noise),</span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a>            <span class="at">max_growth_rate =</span> <span class="fu">max</span>(derivpercap_2[Measurements <span class="sc">&gt;</span> <span class="fl">0.01</span>], </span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a>                                  <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb9-5"><a href="#cb9-5" tabindex="-1"></a><span class="co">#&gt; `summarise()` has grouped output by &#39;Well&#39;, &#39;Bacteria_strain&#39;, &#39;Phage&#39;. You can</span></span>
<span id="cb9-6"><a href="#cb9-6" tabindex="-1"></a><span class="co">#&gt; override using the `.groups` argument.</span></span>
<span id="cb9-7"><a href="#cb9-7" tabindex="-1"></a><span class="fu">head</span>(ex_dat_mrg_sum)</span>
<span id="cb9-8"><a href="#cb9-8" tabindex="-1"></a><span class="co">#&gt; # A tibble: 6 × 5</span></span>
<span id="cb9-9"><a href="#cb9-9" tabindex="-1"></a><span class="co">#&gt; # Groups:   Well, Bacteria_strain, Phage [3]</span></span>
<span id="cb9-10"><a href="#cb9-10" tabindex="-1"></a><span class="co">#&gt;   Well  Bacteria_strain Phage       noise max_growth_rate</span></span>
<span id="cb9-11"><a href="#cb9-11" tabindex="-1"></a><span class="co">#&gt;   &lt;fct&gt; &lt;chr&gt;           &lt;chr&gt;       &lt;chr&gt;           &lt;dbl&gt;</span></span>
<span id="cb9-12"><a href="#cb9-12" tabindex="-1"></a><span class="co">#&gt; 1 A1    Strain 1        No Phage    No               1.23</span></span>
<span id="cb9-13"><a href="#cb9-13" tabindex="-1"></a><span class="co">#&gt; 2 A1    Strain 1        No Phage    Yes              2   </span></span>
<span id="cb9-14"><a href="#cb9-14" tabindex="-1"></a><span class="co">#&gt; 3 E11   Strain 29       Phage Added No               2.11</span></span>
<span id="cb9-15"><a href="#cb9-15" tabindex="-1"></a><span class="co">#&gt; 4 E11   Strain 29       Phage Added Yes             12.3 </span></span>
<span id="cb9-16"><a href="#cb9-16" tabindex="-1"></a><span class="co">#&gt; 5 F1    Strain 31       No Phage    No               0.8 </span></span>
<span id="cb9-17"><a href="#cb9-17" tabindex="-1"></a><span class="co">#&gt; 6 F1    Strain 31       No Phage    Yes              1.75</span></span></code></pre></div>
</div>
<div id="FittingDeriv" class="section level1">
<h1>Fitting during derivative calculation</h1>
<p>The next approach to try is to calculate derivatives by fitting a
line to multiple points. (You might recall we previously used this in
the Calculating Derivatives article
<code>vignette(&quot;gc05_process&quot;)</code>.)</p>
<p>To use the fitting functionality of <code>calc_deriv</code>, specify
the width of the moving window using <code>window_width</code>,
<code>window_width_n</code>, <code>window_width_frac</code>, or
<code>window_width_n_frac</code>. Wider windows will be more
smoothed.</p>
<p>Fitting using a moving window is subject to a trade off between the
amount of variance (noise) that remains and the amount of bias added to
your data. A small window will allow higher variance but add little
bias, while a wide window will allow less variance but add more
bias.</p>
<p>Thus, I recommend using as small a window as possible, like
<code>window_width_n = 3</code> or <code>window_width_n = 5</code>. The
best way to figure out what values to use for your data are to try
different window widths and plot the results, then choose the smallest
one that is sufficient for your analyses to succeed.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a>ex_dat_mrg <span class="ot">&lt;-</span> </span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">group_by</span>(ex_dat_mrg, Well, Bacteria_strain, Phage, noise),</span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a>         <span class="at">deriv_5 =</span> <span class="fu">calc_deriv</span>(<span class="at">x =</span> Time, <span class="at">y =</span> Measurements,</span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a>                            <span class="at">window_width_n =</span> <span class="dv">5</span>),</span>
<span id="cb10-5"><a href="#cb10-5" tabindex="-1"></a>         <span class="at">derivpercap_5 =</span> <span class="fu">calc_deriv</span>(<span class="at">x =</span> Time, <span class="at">y =</span> Measurements,</span>
<span id="cb10-6"><a href="#cb10-6" tabindex="-1"></a>                                   <span class="at">percapita =</span> <span class="cn">TRUE</span>, <span class="at">blank =</span> <span class="dv">0</span>,</span>
<span id="cb10-7"><a href="#cb10-7" tabindex="-1"></a>                                   <span class="at">window_width_n =</span> <span class="dv">5</span>),</span>
<span id="cb10-8"><a href="#cb10-8" tabindex="-1"></a>         <span class="at">deriv_9 =</span> <span class="fu">calc_deriv</span>(<span class="at">x =</span> Time, <span class="at">y =</span> Measurements,</span>
<span id="cb10-9"><a href="#cb10-9" tabindex="-1"></a>                            <span class="at">window_width_n =</span> <span class="dv">9</span>),</span>
<span id="cb10-10"><a href="#cb10-10" tabindex="-1"></a>         <span class="at">derivpercap_9 =</span> <span class="fu">calc_deriv</span>(<span class="at">x =</span> Time, <span class="at">y =</span> Measurements,</span>
<span id="cb10-11"><a href="#cb10-11" tabindex="-1"></a>                                   <span class="at">percapita =</span> <span class="cn">TRUE</span>, <span class="at">blank =</span> <span class="dv">0</span>,</span>
<span id="cb10-12"><a href="#cb10-12" tabindex="-1"></a>                                   <span class="at">window_width_n =</span> <span class="dv">9</span>))</span>
<span id="cb10-13"><a href="#cb10-13" tabindex="-1"></a><span class="co">#Reshape our data for plotting purposes</span></span>
<span id="cb10-14"><a href="#cb10-14" tabindex="-1"></a>ex_dat_mrg_wide <span class="ot">&lt;-</span> </span>
<span id="cb10-15"><a href="#cb10-15" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(ex_dat_mrg, <span class="at">cols =</span> <span class="fu">starts_with</span>(<span class="st">&quot;deriv&quot;</span>),</span>
<span id="cb10-16"><a href="#cb10-16" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="fu">c</span>(<span class="st">&quot;deriv&quot;</span>, <span class="st">&quot;window_width_n&quot;</span>), <span class="at">names_sep =</span> <span class="st">&quot;_&quot;</span>)</span>
<span id="cb10-17"><a href="#cb10-17" tabindex="-1"></a>ex_dat_mrg_wide <span class="ot">&lt;-</span> </span>
<span id="cb10-18"><a href="#cb10-18" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(ex_dat_mrg_wide, <span class="at">names_from =</span> deriv, <span class="at">values_from =</span> value)</span>
<span id="cb10-19"><a href="#cb10-19" tabindex="-1"></a>                               </span>
<span id="cb10-20"><a href="#cb10-20" tabindex="-1"></a><span class="co">#Plot derivative</span></span>
<span id="cb10-21"><a href="#cb10-21" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(ex_dat_mrg_wide, noise <span class="sc">==</span> <span class="st">&quot;Yes&quot;</span>),</span>
<span id="cb10-22"><a href="#cb10-22" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> Time, <span class="at">y =</span> deriv)) <span class="sc">+</span></span>
<span id="cb10-23"><a href="#cb10-23" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">color =</span> window_width_n), <span class="at">linewidth =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb10-24"><a href="#cb10-24" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Well, <span class="at">scales =</span> <span class="st">&quot;free_y&quot;</span>) <span class="sc">+</span></span>
<span id="cb10-25"><a href="#cb10-25" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(ex_dat_mrg_wide, </span>
<span id="cb10-26"><a href="#cb10-26" tabindex="-1"></a>                                 noise <span class="sc">==</span> <span class="st">&quot;No&quot;</span>, window_width_n <span class="sc">==</span> <span class="dv">2</span>),</span>
<span id="cb10-27"><a href="#cb10-27" tabindex="-1"></a>            <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb10-28"><a href="#cb10-28" tabindex="-1"></a>  <span class="fu">scale_color_grey</span>(<span class="at">start =</span> <span class="fl">0.8</span>, <span class="at">end =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb10-29"><a href="#cb10-29" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb10-30"><a href="#cb10-30" tabindex="-1"></a><span class="co">#&gt; Warning: Removed 13 rows containing missing values (`geom_line()`).</span></span>
<span id="cb10-31"><a href="#cb10-31" tabindex="-1"></a><span class="co">#&gt; Warning: Removed 1 row containing missing values (`geom_line()`).</span></span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a>       </span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a><span class="co">#Plot per-capita derivative</span></span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(ex_dat_mrg_wide, noise <span class="sc">==</span> <span class="st">&quot;Yes&quot;</span>),</span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> Time, <span class="at">y =</span> derivpercap)) <span class="sc">+</span></span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">color =</span> window_width_n), <span class="at">linewidth =</span> <span class="fl">0.6</span>, <span class="at">alpha =</span> <span class="fl">0.75</span>) <span class="sc">+</span></span>
<span id="cb11-6"><a href="#cb11-6" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Well, <span class="at">scales =</span> <span class="st">&quot;free_y&quot;</span>) <span class="sc">+</span></span>
<span id="cb11-7"><a href="#cb11-7" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(ex_dat_mrg_wide,</span>
<span id="cb11-8"><a href="#cb11-8" tabindex="-1"></a>                                 noise <span class="sc">==</span> <span class="st">&quot;No&quot;</span>, window_width_n <span class="sc">==</span> <span class="dv">5</span>),</span>
<span id="cb11-9"><a href="#cb11-9" tabindex="-1"></a>            <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb11-10"><a href="#cb11-10" tabindex="-1"></a>  <span class="fu">scale_color_grey</span>(<span class="at">start =</span> <span class="fl">0.8</span>, <span class="at">end =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb11-11"><a href="#cb11-11" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="cn">NA</span>, <span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb11-12"><a href="#cb11-12" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb11-13"><a href="#cb11-13" tabindex="-1"></a><span class="co">#&gt; Warning: Removed 14 rows containing missing values (`geom_line()`).</span></span>
<span id="cb11-14"><a href="#cb11-14" tabindex="-1"></a><span class="co">#&gt; Warning: Removed 4 rows containing missing values (`geom_line()`).</span></span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>As we can see, increasing the width of the window reduces the effects
of noise, getting us closer to the noiseless data (red line). However,
it also starts making peaks shorter and valleys shallower. Finding the
right width that balances those two effects is the key to choosing the
right <code>window_width</code>.</p>
</div>
<div id="Smoothing" class="section level1">
<h1>Smoothing raw data</h1>
<p>The final approach to dealing with noise is to smooth the raw density
data. <code>gcplyr</code> has a <code>smooth_data</code> function that
can carry out such smoothing. <code>smooth_data</code> has five
different smoothing algorithms to choose from:
<code>moving-average</code>, <code>moving-median</code>,
<code>loess</code>, <code>gam</code>, and
<code>smooth.spline</code>.</p>
<ul>
<li><code>moving-average</code> and <code>moving-median</code> are
simple smoothing algorithms that primarily act to reduce the effects of
outliers on the data</li>
<li><code>loess</code>, <code>gam</code>, and <code>smooth.spline</code>
are spline-fitting approaches that use polynomial-like curves, which
produces curves with smoothly changing derivatives, but can in some
cases create curvature artifacts not present in the original data</li>
</ul>
<p>Generally, I recommend sticking to the first two algorithms, alone or
in combination, since the others tend to add artifacts to the
derivatives of growth curve data.</p>
<p><strong>Regardless of which smoothing algorithm you use, you will
need to set a tuning parameter</strong> that controls how “smoothed” the
data are. That choice is subject to a trade off between the amount of
variance (noise) that remains and the amount of bias added to your data.
Choosing a value that smooths your data less will allow higher variance
but will add little bias to your data, while choosing a value that
smooths your data more will allow less variance but add more bias to
your data. Because of this, I generally recommend choosing the value
that smooths your data as little as necessary for your analyses to work.
For more details, see the <a href="#ChoosingTuningParams">Choosing
tuning parameter values</a> section.</p>
<p>Additionally, when sharing your findings, it’s important to be
transparent by sharing the raw data and smoothing methods, rather than
presenting the smoothed data as your source.</p>
<p>To use <code>smooth_data</code>, pass your x and y values, your
method of choice, and any additional arguments needed for the method. It
will return a vector of your smoothed y values.</p>
<div id="smoothing-with-moving-median" class="section level2">
<h2>Smoothing with moving-median</h2>
<p>For <code>moving-median</code>, specify the width of the moving
window using <code>window_width</code>, <code>window_width_n</code>,
<code>window_width_frac</code>, or <code>window_width_n_frac</code>.
Wider windows will be more smoothed. Here, we’ll show moving medians
with windows that are 5 and 9 data points wide (<code>movemed_1</code>
is just our raw, unsmoothed data).</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a>ex_dat_mrg <span class="ot">&lt;-</span></span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">group_by</span>(ex_dat_mrg, Well, Bacteria_strain, Phage, noise),</span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a>         <span class="at">movmed_1 =</span> Measurements,</span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a>         <span class="at">movmed_5 =</span> </span>
<span id="cb12-5"><a href="#cb12-5" tabindex="-1"></a>           <span class="fu">smooth_data</span>(<span class="at">x =</span> Time, <span class="at">y =</span> Measurements,</span>
<span id="cb12-6"><a href="#cb12-6" tabindex="-1"></a>                       <span class="at">sm_method =</span> <span class="st">&quot;moving-median&quot;</span>, <span class="at">window_width_n =</span> <span class="dv">5</span>),</span>
<span id="cb12-7"><a href="#cb12-7" tabindex="-1"></a>         <span class="at">movmed_9 =</span> </span>
<span id="cb12-8"><a href="#cb12-8" tabindex="-1"></a>           <span class="fu">smooth_data</span>(<span class="at">x =</span> Time, <span class="at">y =</span> Measurements,</span>
<span id="cb12-9"><a href="#cb12-9" tabindex="-1"></a>                       <span class="at">sm_method =</span> <span class="st">&quot;moving-median&quot;</span>, <span class="at">window_width_n =</span> <span class="dv">9</span>))</span>
<span id="cb12-10"><a href="#cb12-10" tabindex="-1"></a></span>
<span id="cb12-11"><a href="#cb12-11" tabindex="-1"></a><span class="co">#Reshape our data for plotting purposes</span></span>
<span id="cb12-12"><a href="#cb12-12" tabindex="-1"></a>ex_dat_mrg_wide <span class="ot">&lt;-</span> </span>
<span id="cb12-13"><a href="#cb12-13" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(ex_dat_mrg, <span class="at">cols =</span> <span class="fu">starts_with</span>(<span class="st">&quot;movmed&quot;</span>),</span>
<span id="cb12-14"><a href="#cb12-14" tabindex="-1"></a>               <span class="at">names_prefix =</span> <span class="st">&quot;movmed_&quot;</span>, <span class="at">names_to =</span> <span class="st">&quot;window_width_n&quot;</span>)</span>
<span id="cb12-15"><a href="#cb12-15" tabindex="-1"></a></span>
<span id="cb12-16"><a href="#cb12-16" tabindex="-1"></a><span class="co">#Plot data</span></span>
<span id="cb12-17"><a href="#cb12-17" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(ex_dat_mrg_wide, noise <span class="sc">==</span> <span class="st">&quot;Yes&quot;</span>),</span>
<span id="cb12-18"><a href="#cb12-18" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> Time, <span class="at">y =</span> value)) <span class="sc">+</span></span>
<span id="cb12-19"><a href="#cb12-19" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">color =</span> window_width_n), <span class="at">linewidth =</span> <span class="fl">0.6</span>, <span class="at">alpha =</span> <span class="fl">0.75</span>) <span class="sc">+</span></span>
<span id="cb12-20"><a href="#cb12-20" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Well, <span class="at">scales =</span> <span class="st">&quot;free_y&quot;</span>) <span class="sc">+</span></span>
<span id="cb12-21"><a href="#cb12-21" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(ex_dat_mrg_wide,</span>
<span id="cb12-22"><a href="#cb12-22" tabindex="-1"></a>                                 noise <span class="sc">==</span> <span class="st">&quot;No&quot;</span>, window_width_n <span class="sc">==</span> <span class="dv">1</span>),</span>
<span id="cb12-23"><a href="#cb12-23" tabindex="-1"></a>            <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb12-24"><a href="#cb12-24" tabindex="-1"></a>  <span class="fu">scale_color_grey</span>(<span class="at">start =</span> <span class="fl">0.8</span>, <span class="at">end =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb12-25"><a href="#cb12-25" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>() <span class="sc">+</span></span>
<span id="cb12-26"><a href="#cb12-26" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;moving-median&quot;</span>) <span class="sc">+</span></span>
<span id="cb12-27"><a href="#cb12-27" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb12-28"><a href="#cb12-28" tabindex="-1"></a><span class="co">#&gt; Warning: Transformation introduced infinite values in continuous y-axis</span></span>
<span id="cb12-29"><a href="#cb12-29" tabindex="-1"></a><span class="co">#&gt; Warning: Removed 12 rows containing missing values (`geom_line()`).</span></span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAACqVBMVEUAAAAAADoAAGYAOjoAOmYAOpAAZmYAZpAAZrYZGT8ZGWIZP4EZYp8aGhonLjMpKSkqKiorKysrMzMzMzM1NTU2NjY6AAA6ADo6AGY6OgA6Ojo6OmY6OpA6ZmY6ZpA6ZrY6kLY6kNs/GRk/GWI/P4E/gb1AQEBNTU1NTVdNTV5NTWRNTWtNTW5NTXJNTXlNTY5NUU1NUVtNU01NV1ZNV1lNWY5NXl5NZE1NbMhNbqtNechNjshSTV5TTU1TTWBTTY5TXp1UTU1UTWlVTU1ZTU1ZTVNZTW5ZTY5ZjuRcXmleTU1eTVleTWReTY5eXoNgTW5iGRliGT9iGWJiP4FiYmJin9ljTU1jbo5jbqtkTU1kWU1kY01kq+RmAABmADpmAGZmOgBmZmZmkLZmkNtmtpBmtttmtv9pTVluTU1uTVxuTWRuTWluTW5uTW9uTXluTY5ubqtunZ1uq7Vuq+RvTW5vaU1vtf9yTU15TU15TW95TY55yMh5yP9/U01/zf+BPxmBPz+BP2KBn4GBvZ+BvdmDTU2DyP+OTU2OTWOOTW6OTY6OyP+O5P+QOgCQOjqQOmaQZgCQZjqQZmaQkGaQkLaQtpCQttuQ27aQ2/+d5P+fYhmf2dmijk2i//+lpaWmpqarZE2raU2raV6rbk2rbm6rbo6rom6rtYOryKur5OSr5P+wsLC1bk21jk22ZgC2tpC2ttu225C229u22/+2/9u2//+9gT+92dnIjk3IyI7I5I7I/8jI///Nq27U1NTZn2LZvYHZ2Z/Z2b3Z2dnbkDrbtmbbtpDb29vb/7bb///kjlnknV7kq27k/8jk/+Tk///r6+v/AAD/tW//tmb/yIP/yI7/zX//25D/27b/5I7/5J3/5Kv//6L//7b//8j//83//9v//+T///8H9JrlAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAP50lEQVR4nO2diYPcVB3Hs7Wrg6VmZOsUFNRR6yhW8EQL4lkvFBW1atWFenTEeqAWEbVaDxRkXTxqcaGyCPWoiw5q3RZ1TY+ZYlfRThzaLV237uYv8R05J+/lveQl2XnJ+7bdZCb5TSef/f1+75rMT7OUIqUt9xsYdClADClADClADClADClADClADClADGUOaHF8eDa5bUXIPg0pQAwNdIhBQMstUUBztfqx2tDHrF5Nezr8TZ/eomkr91tWZ8U0eLQwWoEeAP49eIEGzgI6VtOGPupeOMn8afvt81b+0fWgYxdoyN7/SvlIHNBFNfDed4MfGrjqHtxqQxPg+SY42tOaGJCGBJ7q4L0K2XzOMcfnrdxiA+o49r5XyknigLSt1jFNq4M9RGIrvDjkNOAX31oxbQOqwKusAJcautM6Pe4DFDQfAuYP1/znYfsV++G58JHzSnlJHFAFRhKgAa8EPQJcgA90wD8QYc4FTqN4Ay5Vd4yI5vAoDE+8h5GgJP33B39cQ7icV8pLKeQg5w234BUi3++hGKvDCLMBwYuEKRdis/dgpNSD5j0cPyDGeiiI3FYMh57m4MozeWcGCF4KiLBUAC2Mahf95PfHR4sAyA0xwOKn8OkgoHCIEfg6z7ship/3Ak5eQF6Shkc+At0gCCicpIPm4Cg4vGIanLcVZWQntc3CHoD/lfJSuoC8Zh5ehQYTahBQuJkPmuOjdQvvOc2807gXAJA1Z3cULctujPsAoY7ix0cpgJD547bCIw9v0Vb+yUnSqPt5p91pkAtQIi2M1pfjv02knAHN1Z4AujytHHvCosoZkJ1NlneAHkt5h9jij0AOf4Y8fAZ7umMQpAAxpAAxpAAxpAAxpAAxJApoJKwczXOQMKB2v+IBEjPPQQoQQwoQQwoQQwoQQwoQQwoQQwoQQ2kAOnLNLejaDj97T9wrXA10zi2uLdicJ/iG0lYagA69dx28uEOrnxgb0Hm239i2YFNAQEe/8e33HGy37z7nW/E9yAZk28JNAQEdfs7BuzclDDHHgwodYgfWtQ+dK5CDVh0sNqCjO8FFogyiPIigERhhIHtsUoDIGmkfgGxQjClABI0c/eYepyuUMAet3lRoQKonHS0FiCEFiCEFiCEFiCEFiKGoha35G2bQ9uytjQ0n+jds88GQMKCu1QV/7R9w417hycalCNDS3jHrkSv6Nq65a2f/kBEQ2ROw6IAeWr8P2529fQa+RHDjmhcAENkTbIUAmaEQm//cCevs96aCG8sOr26fDPkAUTzBPhoEVDXNMKCTGxCS4MY1D3iQacroQWRPsPpdwDR1XQdbbg+CQoDahgOoKmWIkT3BPuZ6kGn2J2nHjpmD7jXt19DlBkRxAXxxuh5qxRy7pb3bce7yb1xzxNaBLGeSJnuCfcwFFG7m0VnwX1Q/qEiAKC5AB8Sh4gAKewKWDcgkdBR5hAHpkgOKUhqAqg4gvbiAqgKAdEv3hakC1GeuADHMISA7SZvFBeQ0Q0kAgfxl2n3xbqAjPhhafkDAWHlQhHnxAbnBYSsBoOInaV3Eg8rQiilAVKUIqP1kBYhg7vWDqgVN0qm1Yqask/aRQoDMLgGQf9CPJkxo80ElBeRf/EDrItR1MQdQtVyAfBOPeF2ENidtOkm6wICqBECBqWs05UZZFNHR367zUz5AtFyCRQUUWPyAdrR1sWpXbg+i5RJbAh6EzT1AkiZpWi6xD1MBBU6bj8hB1a7crRjNEyzfyqp/rNp1WzHf4ge0o62LmZIDouUS+zCrH4SdJaofJDugCA+CogPikh+QpEmalkvsw6kAQknakBQQLZfYGjEoSZpPI12jKjkgai7BUoAYShGQpEmaIQhIJ35Gkc8cAUJJWi8uIFMAkAEdB/WjdFPSsVi00gCEPciedFOA+sxdQLoCRDSHgPR2sQGJJGkDtWKFBuTMdCVbWS0BoLQ8qMBJWhiQWXBA4q1YKQF5QzZ3jzSU08sKyJu6dvdIU9oeoAInaSIgb9rI2SNOaSNApWzFvIlH3154StuAfQQd9BUMnbOXMLd2IvC4hwp1ccgxhAan94deh6LMAHlT194eYUrbgMbQg9pJPYgbkM8AwkkNEC3ZYo0Y7aQehM1dQEmT9HIDoiVbW1RA4RxEnNJGgEwWoMVxVKylaVmtCriwubWwYlsTFujQhnahCku4dJR3FtnQNvhDDdZdWrsrUMnNfdGYgGjJ1gPk3EnX34ptd8E6e6QpbZMHkNUZnrVaT62DC25CQDVYtQ5WAKqDS4b1Wiq44pR3FtnQMUAeZL+IC6jvMS8gWqhYTpY1AsuGXpb15rIj+0EOoGokoLnzpxfv2DU8C7YIUBPlXBRd4JrQFkaOdxbZ0DHAgJqBjN//mBcQLdm6V0jxID55gJylI7I5dIALj183DRwChdgEupYOKgd0/nQPbddO+M4iGzoGbg7yA+p7zAsowoNSAwSTdDUSEEghvcri+FaQUiIA+c4iG2YBiJZsPUC6ECCdD1Bv+IdNq/P4ayf8gJzQghXxUGvmnUU2dGMxRUC0ZOteYT6AFkYBhB4sCuQDBOtu+ZO07yyyoWOwMNpMDRA12aYMKDoH4fJjqOyWD1BfM+8/i2zoGrS0SmqAWFeYAiB2kl4+pQBIKEmj1TDT8D5jVDxA1RSa+aek7UF2YVZcbVHozOUGZBo2IEaSXjYNBKDJYgPqigDqYkBrJhUgsjmyKzag4LJhglsyMaDiNvMpeJBZaEAmBVBoJpLYEceAqrpZ3BCjAArNRJInJMsLKDQLQJ6QdADphQVkUgCF5pHIE5L4uwF1/P1whRxqOGz6AYVmIskTksjOaBvua5QGENuDsLlcgDqa1uzEqlRNBUTNQTIDag0fH23Gq3ZP/Trf0EwkeUIyrW8D9i1kpCs/oIXRJpyLjL1USVZoJpLUD0pLPS2dNx1WdoDyVGtodx4eZHVgiPVN6Q6KQl9d3m77D+cSYtBTgQaSD0s5AZJXChBDObVieP46TpIelGLYOXrQwrVcHyyyNShlI/IMsV6crvSgAMpMJECxQqyEgFrKg3wiJGn2aqRPpQKURAoQQ+UB5HSC4vaDSgMooUbah58FCznCas8Ji0C6pkfetXrVwQICwvUthYphI9OjOze1D5w70IDsz8rECzEHkEAxbGx65N17BryM6OJ4fXEczZnxy+dBIoVooSks+XvkmifFMc9BfTOKVqsed6iBcpBAMWzX9NAqGQB1KnGHGiXyIHiTDKATa90nRUCDn4PQzUOtuEON1AAd3blu0FuxBEoRkEA/qBOz7Y2hYgw1WnEa3ngKJun4CxoDAWjxjjhZIZ6C62Ia4Z7EaOUG6IGw3GNoHJmRE/WHWEvG+SB4C0pWXkSaUZRzNJ9RHiJ4UKzmoFyA4saXNSDrYnBwtPiD7Jv50DCVp9w37QNUfAqVMk72GcVO/N8sr6L6QXzlvkUBWZ75wH/CLCjOct9BQEYiQKaUgBKV+zaT3KshO6Doct9+DzLjlvsuBqDoct8+QHo1YQ6qyg2INwfhgrIJABmSA4ou9+0Csm+3SABIlznEmOW+XUBm8vvFZPUgDqUDSFYP4pAHqKorQAT5APX1pLkLsEmcgzhEBcRfgK2kgLgLsDn9p6IDMvsAcRdgg180qQuO5jNUOqWM/RWiQnccWtEF2NJo5udqudztk0SeB1HvOLSiC7ClAAitmce6D5BfqQHSqXccWtEF2FJo5ucunI35+Xd+ZQaIuwAbJ6DnhuUekwEQ/p6ucD+IXYDNbubboiGW0ZxrWoDMECBOczTZIQgIJuln5rcuFkvpAKoKAgJauG5AP7yQAiBTFBDMP50492rHUAQgzsHUAACCt5Jm1MpHAOIdTNGSNJdSApSh6IB4B1OigNoAkGiSzlB0QHEGU92kgykESLwVy1B0QLyDKQtHiYAHSQqIdzBVWkC8gylRQAaITx1uZJvu4B1MiXuQpK0Y72DKXhIrISAu2YAEPv6iAEWby9sP4hMGZAoBkrQV4xMAZAgC0i0FKMLcBmQoQBRzBKhaZEDdvkqrsQGZBQcEPUioFVOAIs0RIEsvMKC24ZZ8CADiKyMKXAcAMksIiLOMKACklxMQbxnR0gLiLSNqoKoBpiHfdAefEKAqARBvGVHkQTBJGwX2IBIg3jKihtOKyQeIsxlqo4roHDmIXEbUMGX1IN5miAKIt4yogZYcZQTE2QzRAPGWEcWATAkBcTZDXRgkyUvXYLpSAuJshoAHEcup80lmQJzNUHkBcTZDABCxGDafHEAyJmnOZkgYkLStGGczVGJAXAKA1kwqQHQBQLpQkjalTdJ8AoDE6qzqbQUoylzX0TyHaTjzHQUEJFTreRIlMORB7aJ6UBqA9AID0vvqiMYEZBYekGkIeVAJAHUVoAiJAjJNL0kb3Xv14n0jOa1KJqc5jk8X0JriAbIjQwGiSAFiKCVAOgZUNWQCxFfNmgqI09wPyJAKEGc1axogXnN5AXFWs6YB4jWXFxBvNWujSxxqcJrb1iYQrIgd80v0clCMZR9KNWuL7EFximGDP8YDk21jsipTT5q3mjUFUJxi2HIC4q1mTQEUpxg2BGRN4jVseQAJVrPOuRh2Zoqz7EOsZj2C/vZtEprbewMl4UK0VEAJzBUghnkhARVdChBDChBDChBDChBDYoBA1+ayRqNx8T3zN/xlYwPqkpvRM96EBp/5ZzY3Gi9FL7Dhb9zmuUgIEJzi+e3lJxuX/rnxws03nf3SxVNnrroJPBPf/HlfHHvsda9cuu9NU4+8YkzkLaUuIUBgeLV0/8b1+963ft8nL5l59GUbd5y9ecfS/Vdz/v4981+94Cszj77oNX+9/WdjZ972fZG3lLqEAIEBOoiSRuPNM/Of/gDefdVdaMPlBUHz/4Ioa7xzCm0GyImEAJ3ccGJ+241T4Jc+v23DiTNXvf43P3/xXfCZpV9Msa2D5v++79U3/volb5167I1ft/jM85GoB6GZns07gAv869Yv3Hb95z/4XTTp8xCPD/jN3/+d7Wdvu/61vxtDU0Zc5vlINAfBoTm8ws9+efPYqSthDsITzzxX6DPf9oYd1qkrvwpyEBrqFwXQ0t7tJy+7wjrz9nvmP7XxLf9pXG7972sfhs8s/ZInT3vmp6780HZgvrT3HTP/ePkJTvN8lEY/6PlXz8x/omFrM3xmPV8Occ3/2XAF+0Gc5rlI9aQZUoAYUoAYUoAYUoAYUoAYygjQ4riGVYFFYmVWhh4kOxosBYihzAGBn3Nrd9c0rT5XQxWrYfRlVSUkA+UCqDY8a3Xgd4Z3VkwvjleszKqEZKB8ADVh4YImetCD3hOqCTy4yifEJuxH4EcHt2717P7fdJU/IHmiCyl3QL2sqlZnpNwBLY4DF5KIUu6AUDMvDx81FmNJAWJIAWJIAWJIAWJIAWJIAWJIAWJIAWJIAWLo/2LKrR+Q6fKcAAAAAElFTkSuQmCC" /><!-- --></p>
<p>Here we can see that <code>moving-median</code> has done a great job
excluding noise without biasing our data very far from the true values
(red line). However, it has produced a smoothed density that is fairly
“jumpy”, something that is common with moving-median. To address this,
you often will need to combine <code>moving-median</code> with other
smoothing methods.</p>
</div>
<div id="smoothing-with-moving-average" class="section level2">
<h2>Smoothing with moving-average</h2>
<p>For <code>moving-average</code>, specify the width of the moving
window using <code>window_width</code>, <code>window_width_n</code>,
<code>window_width_frac</code>, or <code>window_width_n_frac</code>.
Wider windows will be more smoothed. Here, we’ll show moving averages
with <code>window_width_n</code> values of 5 or 9 data points wide
(<code>movavg_1</code> is just our raw, unsmoothed data).</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a>ex_dat_mrg <span class="ot">&lt;-</span></span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">group_by</span>(ex_dat_mrg, Well, Bacteria_strain, Phage, noise),</span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a>         <span class="at">movavg_1 =</span> Measurements,</span>
<span id="cb13-4"><a href="#cb13-4" tabindex="-1"></a>         <span class="at">movavg_5 =</span> <span class="fu">smooth_data</span>(<span class="at">x =</span> Time, <span class="at">y =</span> Measurements,</span>
<span id="cb13-5"><a href="#cb13-5" tabindex="-1"></a>              <span class="at">sm_method =</span> <span class="st">&quot;moving-average&quot;</span>, <span class="at">window_width_n =</span> <span class="dv">5</span>),</span>
<span id="cb13-6"><a href="#cb13-6" tabindex="-1"></a>         <span class="at">movavg_9 =</span> <span class="fu">smooth_data</span>(<span class="at">x =</span> Time, <span class="at">y =</span> Measurements,</span>
<span id="cb13-7"><a href="#cb13-7" tabindex="-1"></a>              <span class="at">sm_method =</span> <span class="st">&quot;moving-average&quot;</span>, <span class="at">window_width_n =</span> <span class="dv">9</span>))</span>
<span id="cb13-8"><a href="#cb13-8" tabindex="-1"></a></span>
<span id="cb13-9"><a href="#cb13-9" tabindex="-1"></a><span class="co">#Reshape our data for plotting purposes</span></span>
<span id="cb13-10"><a href="#cb13-10" tabindex="-1"></a>ex_dat_mrg_wide <span class="ot">&lt;-</span> </span>
<span id="cb13-11"><a href="#cb13-11" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(ex_dat_mrg, <span class="at">cols =</span> <span class="fu">starts_with</span>(<span class="st">&quot;movavg&quot;</span>),</span>
<span id="cb13-12"><a href="#cb13-12" tabindex="-1"></a>               <span class="at">names_prefix =</span> <span class="st">&quot;movavg_&quot;</span>, <span class="at">names_to =</span> <span class="st">&quot;window_width_n&quot;</span>)</span>
<span id="cb13-13"><a href="#cb13-13" tabindex="-1"></a></span>
<span id="cb13-14"><a href="#cb13-14" tabindex="-1"></a><span class="co">#Plot data</span></span>
<span id="cb13-15"><a href="#cb13-15" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(ex_dat_mrg_wide, noise <span class="sc">==</span> <span class="st">&quot;Yes&quot;</span>),</span>
<span id="cb13-16"><a href="#cb13-16" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> Time, <span class="at">y =</span> value)) <span class="sc">+</span></span>
<span id="cb13-17"><a href="#cb13-17" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">color =</span> window_width_n), <span class="at">linewidth =</span> <span class="fl">0.6</span>, <span class="at">alpha =</span> <span class="fl">0.75</span>) <span class="sc">+</span></span>
<span id="cb13-18"><a href="#cb13-18" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Well, <span class="at">scales =</span> <span class="st">&quot;free_y&quot;</span>) <span class="sc">+</span></span>
<span id="cb13-19"><a href="#cb13-19" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(ex_dat_mrg_wide,</span>
<span id="cb13-20"><a href="#cb13-20" tabindex="-1"></a>                                 noise <span class="sc">==</span> <span class="st">&quot;No&quot;</span>, window_width_n <span class="sc">==</span> <span class="dv">1</span>),</span>
<span id="cb13-21"><a href="#cb13-21" tabindex="-1"></a>            <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb13-22"><a href="#cb13-22" tabindex="-1"></a>  <span class="fu">scale_color_grey</span>(<span class="at">start =</span> <span class="fl">0.8</span>, <span class="at">end =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb13-23"><a href="#cb13-23" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>() <span class="sc">+</span></span>
<span id="cb13-24"><a href="#cb13-24" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;moving-average&quot;</span>) <span class="sc">+</span></span>
<span id="cb13-25"><a href="#cb13-25" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb13-26"><a href="#cb13-26" tabindex="-1"></a><span class="co">#&gt; Warning: Transformation introduced infinite values in continuous y-axis</span></span>
<span id="cb13-27"><a href="#cb13-27" tabindex="-1"></a><span class="co">#&gt; Warning: Removed 12 rows containing missing values (`geom_line()`).</span></span></code></pre></div>
<p><img src="data:image/png;base64,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z/3izsdf+4rVu9449/DLd4q8pdwlBAjszlbv3rzx3vduvPeT5yw88tLNO45es2P17os5f/+++a+e/5WFR1746r/c+LOdR976fZG3lLuEAIH9PRglrdabFpY//X5885W3oQOXF4TN/wtGWesdc+gwRE4kBOjwpkPLV1w1B37py1dsOnTkotf95ucvug0+svqLObZ12Pzfd73qql+/+C1zj7/h6w6feTkS9SCUKNq6A7jAv67/wg2Xf/4D30U5owd4fCBo/r7vbD96w+Wv+f1OlHHiMi9HojEI7uxhDz/75a07H70QxiCct+bpYcD8itfvcB698KsgBqFMQVUAre7efvi8C5wjb7tz+VOb3/yf1vnO/772IfjI6i954rRv/uiFH9wOzFd3v33hHy87xGlejvJYBz3v4oXlT7SItsJHNvLFEM/8ny1PcB3EaV6K1EqaIQWIIQWIIQWIIQWIIQWIoYIA9Wc0rAYsEiuzCvQg2dFgKUAMFQ4I/Fxaf8u4pk0sjaOK1XD0FVUlpACVAmh8dNHpwu8M766Z7880nMKqhBSgcgBNw8IF0+hOD3pPpCbw8KqcIbaL3AM/unh2myju/81X5QOSZ3QhlQ6oV1TV6oJUOqD+DHAhiSiVDghN8/LwUXsxlhQghhQghhQghhQghhQghhQghhQghhQghhQghv4Pam6NlcSdGiQAAAAASUVORK5CYII=" /><!-- --></p>
<p>Here we can see that <code>moving-average</code> has helped reduce
the effects of some of that early noise. However, as the window width
gets larger, it starts biasing our data more strongly
[e.g. underrepresenting the maximum density peaks relative to the true
value (red line)].</p>
</div>
<div id="combining-multiple-smoothing-methods" class="section level2">
<h2>Combining multiple smoothing methods</h2>
<p>Often, combining multiple smoothing methods can provide improved
results. For instance, <code>moving-median</code> is particularly good
at removing outliers, but not very good at producing smoothly changing
data. In contrast, <code>moving-average</code> works well at producing
smoothly changing data, but isn’t as good at removing outliers. Often,
we can get the best of both by using <code>moving-median</code> first,
followed by <code>moving-average</code>:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a>ex_dat_mrg <span class="ot">&lt;-</span></span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">group_by</span>(ex_dat_mrg, Well, Bacteria_strain, Phage, noise),</span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a>         <span class="at">smoothed_no =</span> Measurements,</span>
<span id="cb14-4"><a href="#cb14-4" tabindex="-1"></a>         <span class="at">sm_med3 =</span> </span>
<span id="cb14-5"><a href="#cb14-5" tabindex="-1"></a>           <span class="fu">smooth_data</span>(<span class="at">x =</span> Time, <span class="at">y =</span> Measurements,</span>
<span id="cb14-6"><a href="#cb14-6" tabindex="-1"></a>                       <span class="at">sm_method =</span> <span class="st">&quot;moving-median&quot;</span>, <span class="at">window_width_n =</span> <span class="dv">3</span>),</span>
<span id="cb14-7"><a href="#cb14-7" tabindex="-1"></a>         <span class="co">#Note that for the second round, we&#39;re using the </span></span>
<span id="cb14-8"><a href="#cb14-8" tabindex="-1"></a>         <span class="co">#first smoothing as the input y</span></span>
<span id="cb14-9"><a href="#cb14-9" tabindex="-1"></a>         <span class="at">smoothed_yes =</span> </span>
<span id="cb14-10"><a href="#cb14-10" tabindex="-1"></a>           <span class="fu">smooth_data</span>(<span class="at">x =</span> Time, <span class="at">y =</span> sm_med3,</span>
<span id="cb14-11"><a href="#cb14-11" tabindex="-1"></a>                       <span class="at">sm_method =</span> <span class="st">&quot;moving-average&quot;</span>, <span class="at">window_width_n =</span> <span class="dv">3</span>))</span>
<span id="cb14-12"><a href="#cb14-12" tabindex="-1"></a></span>
<span id="cb14-13"><a href="#cb14-13" tabindex="-1"></a><span class="co">#Reshape our data for plotting purposes</span></span>
<span id="cb14-14"><a href="#cb14-14" tabindex="-1"></a>ex_dat_mrg_wide <span class="ot">&lt;-</span> </span>
<span id="cb14-15"><a href="#cb14-15" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(ex_dat_mrg, <span class="at">cols =</span> <span class="fu">starts_with</span>(<span class="st">&quot;smoothed&quot;</span>),</span>
<span id="cb14-16"><a href="#cb14-16" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">&quot;smoothed&quot;</span>, <span class="at">names_prefix =</span> <span class="st">&quot;smoothed_&quot;</span>)</span>
<span id="cb14-17"><a href="#cb14-17" tabindex="-1"></a></span>
<span id="cb14-18"><a href="#cb14-18" tabindex="-1"></a><span class="co">#Plot data</span></span>
<span id="cb14-19"><a href="#cb14-19" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(ex_dat_mrg_wide, noise <span class="sc">==</span> <span class="st">&quot;Yes&quot;</span>),</span>
<span id="cb14-20"><a href="#cb14-20" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> Time, <span class="at">y =</span> value, <span class="at">color =</span> smoothed)) <span class="sc">+</span></span>
<span id="cb14-21"><a href="#cb14-21" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="fl">0.6</span>, <span class="at">alpha =</span> <span class="fl">0.75</span>) <span class="sc">+</span></span>
<span id="cb14-22"><a href="#cb14-22" tabindex="-1"></a>  <span class="fu">scale_color_grey</span>(<span class="at">start =</span> <span class="fl">0.8</span>, <span class="at">end =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb14-23"><a href="#cb14-23" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Well, <span class="at">scales =</span> <span class="st">&quot;free_y&quot;</span>) <span class="sc">+</span></span>
<span id="cb14-24"><a href="#cb14-24" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(ex_dat_mrg_wide,</span>
<span id="cb14-25"><a href="#cb14-25" tabindex="-1"></a>                                 noise <span class="sc">==</span> <span class="st">&quot;No&quot;</span>, smoothed <span class="sc">==</span> <span class="st">&quot;no&quot;</span>),</span>
<span id="cb14-26"><a href="#cb14-26" tabindex="-1"></a>            <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb14-27"><a href="#cb14-27" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>() <span class="sc">+</span></span>
<span id="cb14-28"><a href="#cb14-28" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;median then average smoothing&quot;</span>) <span class="sc">+</span></span>
<span id="cb14-29"><a href="#cb14-29" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb14-30"><a href="#cb14-30" tabindex="-1"></a><span class="co">#&gt; Warning: Transformation introduced infinite values in continuous y-axis</span></span>
<span id="cb14-31"><a href="#cb14-31" tabindex="-1"></a><span class="co">#&gt; Warning: Removed 4 rows containing missing values (`geom_line()`).</span></span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Here we can see that the combination of minimal
<code>moving-median</code> and <code>moving-average</code> smoothing has
produced a curve that has most of the noise removed with minimal
introduction of bias relative to the true values (red line).</p>
</div>
<div id="smoothing-with-other-methods" class="section level2">
<h2>Smoothing with other methods</h2>
<p>I typically recommend against using other smoothing algorithms, since
they have a tendency to add artifacts to the derivatives of growth curve
data. However, they may work for your analyses, so if you are
considering using them make sure to plot the smoothed output to check
for any introduced artifacts.</p>
<p>For <code>loess</code>, the tuning parameter is the <code>span</code>
argument. <code>loess</code> works by doing fits on subset windows of
the data centered at each data point. <code>span</code> is the width of
the window, as a fraction of all data points. <code>span</code> values
typically are between 0 and 1, and larger values are more “smoothed”.
The fits can be linear (<code>degree = 1</code>) or polynomial
(typically <code>degree = 2</code>).</p>
<p>For <code>gam</code>, the primary tuning parameter is the
<code>k</code> argument. <code>gam</code> works by doing fits on subsets
of the data and linking these fits together. <code>k</code> determines
how many link points (“knots”) it can use. If not specified, the default
<code>k</code> value for smoothing a time series is 10, with smaller
values being more “smoothed”. However, unlike earlier methods,
<code>k</code> values that are too large are also problematic, as they
will tend to ‘overfit’ the data.</p>
<p>For <code>smooth.spline</code>, the primary tuning parameters are
<code>df</code> and <code>spar</code>. <code>df</code> is the number of
degrees of freedom, and must be between 1 and the number of unique x
values. <code>spar</code> is the smoothing parameter, and is typically
between 0 and 1.</p>
</div>
<div id="ChoosingTuningParams" class="section level2">
<h2>Choosing tuning parameter values</h2>
<p>Given that smoothing reduces the variance of your data but adds bias,
how can you know the right value of the tuning ‘smoothness’ parameter
for your data?</p>
<p>One way you can choose is by trying smoothing with different tuning
parameter values, plotting the results, and then choosing the one that
smooths your data as little as necessary for your analyses to work. This
approach is especially useful if you’re trying to deal with noise that
is most strongly affecting your derivatives.</p>
<p>An alternative way is to use cross-validation to attempt to estimate
the best smoothing parameter value. Cross-validation works by randomly
splitting the data into blocks of roughly equal size, leaving out one
block and smoothing the data, then seeing how close the smoothed values
are to the left-out data, reporting the average error across all the
blocks. We can then repeat this whole process at different values of the
smoothing parameter, testing which smoothing parameter value gives us
the lowest error. Note, however, that this approach doesn’t quantify how
well the smoothing improved your derivatives.</p>
<p>To do cross-validation of smoothing parameters, use
<code>train_smooth_data</code>. <code>train_smooth_data</code> works
similar to <code>smooth_data</code>, except that instead of returning
the smoothed data values, it returns the average accuracy metrics.
Because of this, we have to use <code>train_smooth_data</code> within
the <code>dplyr</code> function <code>reframe</code>, which works like
<code>summarize</code> except that it allows multiple rows to be
returned.</p>
<p>By default, <code>train_smooth_data</code> will test an evenly spaced
grid of three values of the smoothing parameter. Usually, that’s not
enough values, so you’ll want to set the number of values to test with
<code>tuneLength</code> (more values will take longer to calculate).</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a>ex_dat_mrg_fortraining <span class="ot">&lt;-</span> <span class="fu">make_example</span>(<span class="at">vignette =</span> <span class="dv">7</span>, <span class="at">example =</span> <span class="dv">2</span>)</span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a><span class="co">#&gt; Joining with `by = join_by(Well)`</span></span>
<span id="cb15-3"><a href="#cb15-3" tabindex="-1"></a></span>
<span id="cb15-4"><a href="#cb15-4" tabindex="-1"></a>training_results <span class="ot">&lt;-</span> </span>
<span id="cb15-5"><a href="#cb15-5" tabindex="-1"></a>  <span class="fu">reframe</span>(<span class="fu">group_by</span>(ex_dat_mrg_fortraining, Bacteria_strain, Phage, Well),</span>
<span id="cb15-6"><a href="#cb15-6" tabindex="-1"></a>          <span class="fu">train_smooth_data</span>(<span class="at">x =</span> Time, <span class="at">y =</span> Measurements, </span>
<span id="cb15-7"><a href="#cb15-7" tabindex="-1"></a>                   <span class="at">sm_method =</span> <span class="st">&quot;moving-average&quot;</span>,</span>
<span id="cb15-8"><a href="#cb15-8" tabindex="-1"></a>                   <span class="at">tuneLength =</span> <span class="dv">5</span>))</span>
<span id="cb15-9"><a href="#cb15-9" tabindex="-1"></a><span class="co">#&gt; Loading required package: lattice</span></span>
<span id="cb15-10"><a href="#cb15-10" tabindex="-1"></a><span class="fu">head</span>(training_results)</span>
<span id="cb15-11"><a href="#cb15-11" tabindex="-1"></a><span class="co">#&gt; # A tibble: 6 × 10</span></span>
<span id="cb15-12"><a href="#cb15-12" tabindex="-1"></a><span class="co">#&gt;   Bacteria_strain Phage    Well  window_width_n    RMSE Rsquared     MAE  RMSESD</span></span>
<span id="cb15-13"><a href="#cb15-13" tabindex="-1"></a><span class="co">#&gt;   &lt;chr&gt;           &lt;chr&gt;    &lt;fct&gt;          &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;</span></span>
<span id="cb15-14"><a href="#cb15-14" tabindex="-1"></a><span class="co">#&gt; 1 Strain 1        No Phage A1                 1 0.0109     0.999 0.00484 0.0131 </span></span>
<span id="cb15-15"><a href="#cb15-15" tabindex="-1"></a><span class="co">#&gt; 2 Strain 1        No Phage A1                 3 0.00892    1.00  0.00481 0.00738</span></span>
<span id="cb15-16"><a href="#cb15-16" tabindex="-1"></a><span class="co">#&gt; 3 Strain 1        No Phage A1                 7 0.0114     0.999 0.00715 0.00669</span></span>
<span id="cb15-17"><a href="#cb15-17" tabindex="-1"></a><span class="co">#&gt; 4 Strain 1        No Phage A1                 9 0.0130     0.999 0.00860 0.00599</span></span>
<span id="cb15-18"><a href="#cb15-18" tabindex="-1"></a><span class="co">#&gt; 5 Strain 1        No Phage A1                13 0.0182     0.999 0.0128  0.00598</span></span>
<span id="cb15-19"><a href="#cb15-19" tabindex="-1"></a><span class="co">#&gt; 6 Strain 1        Phage A… A7                 1 0.0175     0.949 0.00834 0.0130 </span></span>
<span id="cb15-20"><a href="#cb15-20" tabindex="-1"></a><span class="co">#&gt; # ℹ 2 more variables: RsquaredSD &lt;dbl&gt;, MAESD &lt;dbl&gt;</span></span></code></pre></div>
<p>We can see that <code>train_smooth_data</code> has given us a number
of accuracy metrics. The first one is ‘RMSE’, which stands for “root
mean squared error” and is often a good default value to use (where
lower values are better) to decide what the best parameter value is.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> training_results,</span>
<span id="cb16-2"><a href="#cb16-2" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> window_width_n, <span class="at">y =</span> RMSE)) <span class="sc">+</span></span>
<span id="cb16-3"><a href="#cb16-3" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Based on this plot, a window_width_n of 1 has the lowest average
error of all the values we tested.</p>
<p>However, often you’ll want to test different values from the defaults
in <code>train_smooth_data</code>. To do so, specify exactly what values
you want to test with the <code>tuneGrid</code> argument:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a>training_results <span class="ot">&lt;-</span> </span>
<span id="cb17-2"><a href="#cb17-2" tabindex="-1"></a>  <span class="fu">reframe</span>(<span class="fu">group_by</span>(ex_dat_mrg_fortraining, Bacteria_strain, Phage, Well),</span>
<span id="cb17-3"><a href="#cb17-3" tabindex="-1"></a>          <span class="fu">train_smooth_data</span>(<span class="at">x =</span> Time, <span class="at">y =</span> Measurements, </span>
<span id="cb17-4"><a href="#cb17-4" tabindex="-1"></a>                   <span class="at">sm_method =</span> <span class="st">&quot;moving-average&quot;</span>,</span>
<span id="cb17-5"><a href="#cb17-5" tabindex="-1"></a>                   <span class="at">tuneGrid =</span> <span class="fu">list</span>(</span>
<span id="cb17-6"><a href="#cb17-6" tabindex="-1"></a>                     <span class="st">&quot;window_width_n&quot;</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">9</span>, <span class="dv">13</span>))))</span>
<span id="cb17-7"><a href="#cb17-7" tabindex="-1"></a></span>
<span id="cb17-8"><a href="#cb17-8" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> training_results,</span>
<span id="cb17-9"><a href="#cb17-9" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> window_width_n, <span class="at">y =</span> RMSE)) <span class="sc">+</span></span>
<span id="cb17-10"><a href="#cb17-10" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Here we can see for our example data that cross-validation suggests
little smoothing is necessary. This makes sense, since our example data
has noise that is most problematic for our derivatives, and
cross-validation doesn’t consider the derivatives. For your data, I
suggest combining cross-validation and manual observation of different
smoothings to decide the best smoothing parameter value to use.</p>
</div>
</div>
<div id="DerivsOfSmoothed" class="section level1">
<h1>Calculating derivatives of smoothed data</h1>
<p>Once you’ve smoothed your data, you can calculate derivatives using
the smoothed data. Combining smoothing of raw data and fitting using
multiple points for calculating derivatives can be a powerful
combination for reducing the effects of noise while minimizing the
introduction of bias.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a><span class="co"># Note here that we&#39;re calculating derivatives of the smoothed column generated</span></span>
<span id="cb18-2"><a href="#cb18-2" tabindex="-1"></a><span class="co">#  in the previous section by combining moving median and moving average smoothing</span></span>
<span id="cb18-3"><a href="#cb18-3" tabindex="-1"></a>ex_dat_mrg <span class="ot">&lt;-</span> </span>
<span id="cb18-4"><a href="#cb18-4" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">group_by</span>(ex_dat_mrg, Well, Bacteria_strain, Phage, noise),</span>
<span id="cb18-5"><a href="#cb18-5" tabindex="-1"></a>         <span class="at">smderiv_0 =</span> <span class="fu">calc_deriv</span>(<span class="at">x =</span> Time, <span class="at">y =</span> Measurements),</span>
<span id="cb18-6"><a href="#cb18-6" tabindex="-1"></a>         <span class="at">smderivpercap_0 =</span> <span class="fu">calc_deriv</span>(<span class="at">x =</span> Time, <span class="at">y =</span> Measurements,</span>
<span id="cb18-7"><a href="#cb18-7" tabindex="-1"></a>                                       <span class="at">percapita =</span> <span class="cn">TRUE</span>, <span class="at">blank =</span> <span class="dv">0</span>),</span>
<span id="cb18-8"><a href="#cb18-8" tabindex="-1"></a>         <span class="at">smderiv_3 =</span> <span class="fu">calc_deriv</span>(<span class="at">x =</span> Time, <span class="at">y =</span> smoothed_yes, <span class="at">window_width_n =</span> <span class="dv">3</span>),</span>
<span id="cb18-9"><a href="#cb18-9" tabindex="-1"></a>         <span class="at">smderivpercap_3 =</span> <span class="fu">calc_deriv</span>(<span class="at">x =</span> Time, <span class="at">y =</span> smoothed_yes, <span class="at">percapita =</span> <span class="cn">TRUE</span>, </span>
<span id="cb18-10"><a href="#cb18-10" tabindex="-1"></a>                                    <span class="at">blank =</span> <span class="dv">0</span>, <span class="at">window_width_n =</span> <span class="dv">3</span>))</span>
<span id="cb18-11"><a href="#cb18-11" tabindex="-1"></a></span>
<span id="cb18-12"><a href="#cb18-12" tabindex="-1"></a><span class="co">#Reshape our data for plotting purposes</span></span>
<span id="cb18-13"><a href="#cb18-13" tabindex="-1"></a>ex_dat_mrg_wide <span class="ot">&lt;-</span> </span>
<span id="cb18-14"><a href="#cb18-14" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(ex_dat_mrg, <span class="at">cols =</span> <span class="fu">starts_with</span>(<span class="st">&quot;smderiv&quot;</span>),</span>
<span id="cb18-15"><a href="#cb18-15" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="fu">c</span>(<span class="st">&quot;deriv&quot;</span>, <span class="st">&quot;window_width_n&quot;</span>), <span class="at">names_sep =</span> <span class="st">&quot;_&quot;</span>)</span>
<span id="cb18-16"><a href="#cb18-16" tabindex="-1"></a>ex_dat_mrg_wide <span class="ot">&lt;-</span> </span>
<span id="cb18-17"><a href="#cb18-17" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(ex_dat_mrg_wide, <span class="at">names_from =</span> deriv, <span class="at">values_from =</span> value)</span>
<span id="cb18-18"><a href="#cb18-18" tabindex="-1"></a></span>
<span id="cb18-19"><a href="#cb18-19" tabindex="-1"></a><span class="co">#Plot derivative</span></span>
<span id="cb18-20"><a href="#cb18-20" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(ex_dat_mrg_wide, noise <span class="sc">==</span> <span class="st">&quot;Yes&quot;</span>),</span>
<span id="cb18-21"><a href="#cb18-21" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> Time, <span class="at">y =</span> smderiv, <span class="at">color =</span> window_width_n)) <span class="sc">+</span></span>
<span id="cb18-22"><a href="#cb18-22" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="fl">0.6</span>, <span class="at">alpha =</span> <span class="fl">0.75</span>) <span class="sc">+</span></span>
<span id="cb18-23"><a href="#cb18-23" tabindex="-1"></a>  <span class="fu">scale_color_grey</span>(<span class="at">start =</span> <span class="fl">0.8</span>, <span class="at">end =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb18-24"><a href="#cb18-24" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Well, <span class="at">scales =</span> <span class="st">&quot;free_y&quot;</span>) <span class="sc">+</span></span>
<span id="cb18-25"><a href="#cb18-25" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(ex_dat_mrg_wide,</span>
<span id="cb18-26"><a href="#cb18-26" tabindex="-1"></a>                                 noise <span class="sc">==</span> <span class="st">&quot;No&quot;</span>, window_width_n <span class="sc">==</span> <span class="dv">0</span>),</span>
<span id="cb18-27"><a href="#cb18-27" tabindex="-1"></a>            <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb18-28"><a href="#cb18-28" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb18-29"><a href="#cb18-29" tabindex="-1"></a><span class="co">#&gt; Warning: Removed 7 rows containing missing values (`geom_line()`).</span></span>
<span id="cb18-30"><a href="#cb18-30" tabindex="-1"></a><span class="co">#&gt; Warning: Removed 1 row containing missing values (`geom_line()`).</span></span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAACWFBMVEUAAAAAADoAAGYAOpAAZmYAZrYZGT8ZGWIZP4EZYp8aGhozMzM1NTU2NjY6AAA6ADo6AGY6Ojo6OpA6kNs7Ozs/GRk/GWI/P4E/gb1AQEBNTU1NTV5NTWRNTW5NTW9NTY5NU01NWY5NY6tNZE1NaX9NaZ1Na3lNbqtNeXlNechNg45Ng8hNjshQWZ1STU1TTU1TTW5TTYNVTY5ZTU1ZTVJZTVNZTWRZTW5ZTY5eTU1eTVleTWReTWleTW5eTY5eneRiGRliGT9iGWJiP4FiYmJin9ljnZ1kTU1kTY5mAABmADpmAGZmtttmtv9nZU1pTU1pTY5pq+RuTU1uTWNuTW5uTXluTYNuTY5uY4NuaX9ubo5ubqtuq+RvTW9yTU15TU15eU15yMh5yP9/aU1/zf+BPxmBPz+BP2KBn4GBvZ+BvdmDTVODTW6DeVmOTU2OTV6OTWOOTW6OTW+OTY6Obk2Obm6Og02OtY6OtauOyOSOyP+O5P+QOgCQOjqQZgCQkGaQtpCQ2/+dbk2dnW6fYhmf2dmijk2iyI6i//+rY1erY1mraU2raV6raW+rbk2rbm6rboOrbo6rtY6ryI6ryKurzaur5Mir5OSr5P+1//+2ZgC225C22/+2//+9gT+92dnIeU3Ig03Ijk3IyI7I5KvI/8jI///Nq27U1NTZn2LZvYHZ2Z/Z2b3Z2dnbkDrb/7bb///kjlnkq27k5Kvk/8jk///r6+v/AAD/tW//tmb/yIP/yI7/zX//25D/27b/5I7/5J3/5Kv//6L//7b//8j//9v//+T///9ZVoBwAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAQVUlEQVR4nO2di58dNRXHL60LbXemVZZHuVIRQeujvgXxLWptF1yRFVuFVXxQRVQQAa3raqlQRFHwgVJWt9VVy/QxS632jmtZy7qP/FsmmcxMMpPcZHJnpptMfv189j46STvfPTk5Sc4kHeDUV50L/R9Y63KAJHKAJHKAJHKAJHKAJNIDNCxUczU0JE1AoUDqgAauoSE5QBI5QBI5QBI5QBI5QBI5QBI5QBINBOjkzffh1xNXHCoP6MTlm6Auvi8rj1+sAnT8E1vxy6ZLdAClVEn5+MUmQKe+/s2PHw3Dxy++V8uCkkKkPHmxCdCJK48+vlO/iaWFrG1iR7aGxzcO6IM2HLUX0Kl98Aax93AWlNcwaWHQc+x0gDjCgI4gNriNOUB5IUCnvnEoCYUG8EGbdloLiCsXScdygCRygCRygCRygCQqs2izfH93+1n87ky3273mWPkaLqg0AfVAD4AeKLwUb2/16UlwZgd+OztJ1cCWzqppHaDlh46Bxb3IblafOUzV4AARLd51Fiw/iNDAttbtYiNCLaknUOsAndueAFq843BmRbZbUKBhQViJHyoACi0DpNxAMh+E1RpAJXqxCdKLoca2+pukm28JoFAKiMRByIhgHLQtaWsxoCjh0mZAghrw9V7kAIlqyAEKDQWUjRMWx0kQg1QZIN9wQNk4AfXUKJCJVQEg3OlFgUe6vyDoeQYGilkffQ5hSgdTVVlQBPzUgiLfQAtio7z4HR5yJ3GQJ42DBMKAostAlADyI4jLOEDZOAHEEQ1RakHRABYU9qDNEEBBGHkIUGgYINqClu9P+aSAguoA+QGIIuMAUeOExXF6NocAisLLFANF9h0NCHdfgQ8Bwc+mAcrGCQyfFBBqFiCQDDWSjpCaOssA+QwgzzRA2TgBTZdmgVAJQJkRMsNWBCjKAMGAKMCBo2mABCoBKHNj2Ts8YRZBlwO7wcjzPPg2CHDHGBkWB4lEAIUKgLKOkOkSh2ExVNCPsOkEIX4xzgeJROIg2InBQCjoGwfxLAhkgKJ4NGYfIGwzMHbx9H1QGwAFckBZR5i9AxQgLwkTbATk9+SAqAmzXBzEA2TaUEOkDFDkywAJaiCA/BSQkdMdzC+dmnrPAAWRPqCe+YDo4Pdcuq5OA+oNCigyGhDV8cxue7ZgQWikqdvEkvmSyOiVVSZ0IaSo+SAcCkviIIESC4rMtiAm+C36oEEsyA5APAtCigHhSdJBAZntpJngtwAouAo56avaDIgJfguA4nuLlAJFJCbDzI5ungqDdQFJMsxMByQQDcjH0xW6GWaGx0EiESetAkiSYWZ4HCTScJCEQb0eXhwNhLcnyTAzvJsXaRjNdhELCiOhBc12uzskGWYtAITX+1R8EFYBkLVOOgDhZQSQjwBFXiToxfpmmNkMiOQdQEBBiNYl0DJFyQwz87t5/rIoC6jnR77no/dhi+eDmGVRDCiiAIVBqAvIbCctWJKAgHyq+0ETi6HISQtkCSDRsugwWgpNY7ugXxwkUBIoRmYHioJlUWhBaccOcJqZuJsXyJI4SLAsWiUgs5202Ac5QFiCZdEKARnezQuWRYuA+s4oJpaXX1m1AZBApQAlC2r5DDMbunmRhgN6rSfo20mnC2qF7A6rAdEZ5IpNLJdhZkUcJJIWoFyGmRVxkEiKgNCEGeBYELCmmxdJy4K4PoisiRgLSJj+ogGokGGG/oRmAxKnv5QFxMswswCQOP2lDCCeUkBmO2lx+ot6HMSXJYDE6S9VWZDB3XxhUUsICOgAsiNQFKe/DAzIjm5enP7iAMUSpr9UBcjwbl6kEnt3iGpwgDIlpsfLMDO8mxepxPY4VAjOyzCzFpC6BaUhODfDLHluvsWAstE8L8MsHwYZFgeJpAWIn2HWagtiJ8zir/IJVIYDkm2PU6oXQ8oDCs0GJN0epwwgboaZ4YCk2+MoAxJlmJVvYgtbDjKf59fNyIqwBVGB//6pUI9AA26Po90HVeeDlAFRBRCcSgBJt8dRsiCeLACUnw/ibY8zAKBScdDK1Ai8sc4YANND8MYWtjy6uYM+LY12LjoAAa1MdTpDzFX8gqTAH2HpkYUtBzq4EqK0UlVAGIpke5zGLGhu/Wkw/aoReMNjCNBm+HFu3czS6Ai85XUzK1OIzhB9Fb9gUgBbEKkkBZT7rARItj1OY4AWXjmz8uMD60/DVwxoDPtc3LrgPeFX1HKyq/gFkwIxoDHG4+c/cwAhvjlJtscZHJBiN48M4NIXb52BBoGb2EF8L8g8EIJ5/LrlIHUVv2BSIPVBNKDcZw4gMNfhNELu7TUNCLqQ+aGVqU9Bl9IHEHUVv+CggFB9nc5Fcu/efC82v/4nY2DuFbccpAElTWse/ZfRh+wqfsG0LeoDgpqW95tl4qBsjMJbWVUFtDQKIcx3oAVQgJZGhxgnTV3FL5gUWBodG8CCFOKKEhaUjVG4GWbKcdA0vEXsJClAuW6evopfMC0w3RnSAaTWvsoBysYo/OyOgQPFmsX2YkoeGoAye9ojcfcwG3Sw0pBq3/QfpGMUboYZqMeCFmBQjCRvELIrU0DQfGADxVJw0mqA4gmzZIzCzTCrCVB1qv/omjQGZ32QiUfXUEOY6pSNUdhkfVOk56RLiIxRCsn6pogdatARlhMWa0GqTrpF0nPSLZIDJBELaK7TGXOOiBE7Flv/4ugYHhZLNHgUY2QchIPpMZVlgpYeAukAcZSLg15EjAoz0wW1FRCYR2GQnM+aAwQjuLq6FisOokWDyDl516IlKwAt3ToDqLWwSkXNB3USrUknzbk0/buFS0+DpVuUJotLi3XSCI3KmB7f3onLN0FtRe+uOFQeUK74yY9u2nBU04LQulgTgAga1W4+xXJ80yU6gJjip/btDI9s1ATUlAVpAnr84nu1LIgpfvJjh+Jv1qwPQiJNTDEOyhqWXhNjip+48mh48ub7dHuxkYZ6MRwHKUwrZj5ooz4gpvjxDQMAWqNx0NqxoDq1VgAN5IPqFAOILKKV7cWqAHRq31b9XqxOscs+qo6uekADxUF1SnNtPhTI7tG8+sJhSwGppxy3FVA5J90+QCtTCnNlWC0F5Jw0R5pOup3LPuoj4pIpeLwaTEyg4iQv0BkrKEuVqKWAimIyd890ywEqPM7J21jAcEB01tzinQ9LAAUMoOLjnLyNBUAlW1PM15ezwwCKEzmpf4rKu1x95rmn04fe+Um8AZPEW3ick7uxADk9dDBAyHc2MmE2PYQmFal/isrcPTMh9UGsBRUe5+RuLBDv76WzyVdOTUy5LsWpHdSAg9lwuySgwuOc3I0FlC3oqqKYv2/CgpbihXkKUNZM4lzM5KHMshaUPc6Zf26+kiaGBklqz1CUV26ogR4sms5+F0zmbkkL4j/OWRMg0MzCIRysDuGnY1LRO1CVBFR4nJO7sUBlgMB0DTnMoNpnNQJeHEQ9zsnbWKASQE2trKpLCVD/Giq1oDnV57jKyw5ANcoBkuhCAgpsBiQfakhqsB1QVRYUOkCiGuIRGD5js4qxWF264Bbkhc6CuDWkgCIHiFtDAihygPg1UIBCgwGJtgmsDFBkNiDhNoGVAfI932RAwm0CeYBCLUCB0YCE2wRyA+lcJF04xDa/PQ4E5CeAQjMBCbcJVLCgwiG2he1xAhD5YQwoMBSQcJtABUCFAyRz2+ME6HRoONSIEJ4gxD8C0wAJtwlUAFQ4gjS3PU4UeR5ql/DFg30ZevH4x2lfUGluE6gAqHCIbW57nIAMVqMIFoQWROJFswAJtwlEd8P076UsCGSAQALITB8kEgUI/erjUzZK+qBkPshvBaCA14vlDrEtHMBGAzI0DhJJBVDxEFtOHIQAedYDwv1zqBdJI0DAckBe5A0CCJ+TaR+gdJo0CDx4jwH8mB9q9K/BdkBpv+PDJhL5+hbUw2fU2QoI3mLkI0qeA8QoAxREoR6gtJF6EbOsYRsgOB5HnhqGw7oW5NttQR6IB1EDALLTScczOAH2zgiQj+O99gEqzArGSgB5KSAYDsGvdDLtje7mC7OCRAkg1IURQADFi60DVBiRk+8xIOiZE0AorvbCSA+QyU66MKcDyKR9PAXYy458xqG0xtk+hgMqzAqS77EF+clEUGxBAT+JE6nvwyxGd/M8C0LC3XzYH5DiwyxmAxL7IAIIiAEpPsxidjdfmBUkQoAAAwgUACk+zNJDaxvmDjUKs4KxVAApPsxidjcvEg8QnbwgPpus8KxGOwEhKT7MEnfzpiYviKQCSPFhlvYCUnyYpRdaCig9GkwIqH8NtgNik5v1Mu0JoMBKQBVakAPErSFz0g4QtwYHSFKD9d38oIBS1x6xh/VaBAhUZEE9ky2o1kx7CwDVm2lPunmTAZXKtG8joFKZ9rqT9iYDKpVp3zYfJJ70coBSlcq0Fy/7kPUe3lnPhgMqlWkvXPYhzp171rPhgPpl2ssAZdZHZuq5Zz2bDkigcjtQkfUewVnPuWml9gDKekCy3iM469noOEgkGaB8D4i+mhSc9dzaJsYuVkNAzgeJln3Iek/hYRarASkMNbJla7LeY2EcJJKLpCVygCRy0x0SOUASuSYmUTVbdJFVDaOHGqX2tG+hBZXb076FgMrtad9r36kI5fa0L+NBLAFUbk/7llkQO2WR29O+pUfXFCTa0z7+PQ/Tb7JPimJKs9WsJalO2gOmm3eAEgn2tHeAnBI5QBI5QBI5QBI5QBLpAMJdGwqMrn4SgPPv7l5/Gw6Suru621+gHkuVVYGufc1uGGh97u5uqrhilSoakgageIg/O3kO3cd/utf8/Vtvmf3BDfesPvXew2eum5SXT6qA16IqznW7X3nwsev2f/aO557ef8djO2bVqmhKGoBweL3nke9ve3bvsdmrv7j7r2/e88hvr5tcfuiJyZff/yPlKuC1s7CKJ7b97saf7YAf/vwm+O3s/j2PHJaXb1AagPAA7bvjsCXcBEl94TPH4g/77/z24f/tolJAJFXga/fDEPSldzxPPtz1rwf/gOtaQ0akAQgP8R/40GFkA+Dc9RDQAx/82sTqz197Ozh/wz2Aebi5TxX42l9++Bj497bnwfn3fHpi9Rev/+kErliliqaka0FoiL+466uJBU2A5bvfSr5WcCJpFX+5KbGgj8APb7udzB2sIT+k64PQ6AwBWv7e7mMvvR2CGv/ybvK1wt2lVSBA5298cnEctdZd70rmDswGhIf4b4SN5OUPPAlWn3rn3257w/Z/jv/w1w9PgH9cSz2WKqkCX/srSPXl931y/DvXnl0c//zDpGKVKprSIHHQq6EDQXEQFcW8QD2WKqsCXfv7vSgO+lJWw+vOnlGsoiG5SFoiB0giB0giB0giB0giB0ii6gGtTHViDS1sqelozyZVjwVZgSaWAyRRnYDgz4Utj27udEYW4I+xuPWtq+dY+NpUN6DN60+DuQ76sW4GHWYP5uiztg1Q7YDG0CHkY/gDPsh+abSeU73rUu1N7CD5BH/Mxb3bSC3/ZF1qFJBhrQurSUDzdR15XqeaBLQyBU3INEpNAsLdvGF83FhMJgdIIgdIIgdIIgdIIgdIIgdIIgdIIgdIIgdIov8DnQNsPOtH238AAAAASUVORK5CYII=" /><!-- --></p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a></span>
<span id="cb19-2"><a href="#cb19-2" tabindex="-1"></a><span class="co">#Plot per-capita derivative</span></span>
<span id="cb19-3"><a href="#cb19-3" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(ex_dat_mrg_wide, noise <span class="sc">==</span> <span class="st">&quot;Yes&quot;</span>),</span>
<span id="cb19-4"><a href="#cb19-4" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> Time, <span class="at">y =</span> smderivpercap, <span class="at">color =</span> window_width_n)) <span class="sc">+</span></span>
<span id="cb19-5"><a href="#cb19-5" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="fl">0.6</span>, <span class="at">alpha =</span> <span class="fl">0.75</span>) <span class="sc">+</span></span>
<span id="cb19-6"><a href="#cb19-6" tabindex="-1"></a>  <span class="fu">scale_color_grey</span>(<span class="at">start =</span> <span class="fl">0.8</span>, <span class="at">end =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb19-7"><a href="#cb19-7" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Well, <span class="at">scales =</span> <span class="st">&quot;free_y&quot;</span>) <span class="sc">+</span></span>
<span id="cb19-8"><a href="#cb19-8" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(ex_dat_mrg_wide,</span>
<span id="cb19-9"><a href="#cb19-9" tabindex="-1"></a>                                 noise <span class="sc">==</span> <span class="st">&quot;No&quot;</span>, window_width_n <span class="sc">==</span> <span class="dv">3</span>),</span>
<span id="cb19-10"><a href="#cb19-10" tabindex="-1"></a>            <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb19-11"><a href="#cb19-11" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="cn">NA</span>, <span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb19-12"><a href="#cb19-12" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb19-13"><a href="#cb19-13" tabindex="-1"></a><span class="co">#&gt; Warning: Removed 8 rows containing missing values (`geom_line()`).</span></span>
<span id="cb19-14"><a href="#cb19-14" tabindex="-1"></a><span class="co">#&gt; Warning: Removed 6 rows containing missing values (`geom_line()`).</span></span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Here we can see that calculating derivatives from smoothed raw data
can be a powerfully useful combination.</p>
</div>
<div id="whats-next" class="section level1">
<h1>What’s next?</h1>
<p>Now that you’ve analyzed your data and dealt with any noise, there’s
just some concluding notes on best practices for running statistics,
merging growth curve analyses with other data, and additional resources
for analyzing growth curves.</p>
<ol style="list-style-type: decimal">
<li>Introduction: <code>vignette(&quot;gc01_gcplyr&quot;)</code></li>
<li>Importing and reshaping data:
<code>vignette(&quot;gc02_import_reshape&quot;)</code></li>
<li>Incorporating experimental designs:
<code>vignette(&quot;gc03_incorporate_designs&quot;)</code></li>
<li>Pre-processing and plotting your data:
<code>vignette(&quot;gc04_preprocess_plot&quot;)</code></li>
<li>Processing your data: <code>vignette(&quot;gc05_process&quot;)</code></li>
<li>Analyzing your data: <code>vignette(&quot;gc06_analyze&quot;)</code></li>
<li>Dealing with noise: <code>vignette(&quot;gc07_noise&quot;)</code></li>
<li><strong>Best practices and other tips:</strong>
<code>vignette(&quot;gc08_conclusion&quot;)</code></li>
<li>Working with multiple plates:
<code>vignette(&quot;gc09_multiple_plates&quot;)</code></li>
<li>Using make_design to generate experimental designs:
<code>vignette(&quot;gc10_using_make_design&quot;)</code></li>
</ol>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
