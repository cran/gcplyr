<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Mike Blazanin" />


<title>Dealing with noise</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Dealing with noise</h1>
<h4 class="author">Mike Blazanin</h4>


<div id="TOC">
<ul>
<li><a href="#where-are-we-so-far" id="toc-where-are-we-so-far">Where
are we so far?</a></li>
<li><a href="#introduction" id="toc-introduction">Introduction</a></li>
<li><a href="#FittingDeriv" id="toc-FittingDeriv">Fitting during
derivative calculation</a></li>
<li><a href="#Smoothing" id="toc-Smoothing">Smoothing raw data</a>
<ul>
<li><a href="#smoothing-with-moving-average" id="toc-smoothing-with-moving-average">Smoothing with
moving-average</a></li>
<li><a href="#smoothing-with-moving-median" id="toc-smoothing-with-moving-median">Smoothing with
moving-median</a></li>
<li><a href="#smoothing-with-loess" id="toc-smoothing-with-loess">Smoothing with LOESS</a></li>
<li><a href="#smoothing-with-gam" id="toc-smoothing-with-gam">Smoothing
with GAM</a></li>
<li><a href="#combining-multiple-smoothing-methods" id="toc-combining-multiple-smoothing-methods">Combining multiple
smoothing methods</a></li>
</ul></li>
<li><a href="#DerivsOfSmoothed" id="toc-DerivsOfSmoothed">Calculating
derivatives of smoothed data</a></li>
<li><a href="#SubsetAnalysis" id="toc-SubsetAnalysis">Summarizing on
subsets of derivatives</a></li>
<li><a href="#whats-next" id="toc-whats-next">What’s next?</a></li>
</ul>
</div>

<div id="where-are-we-so-far" class="section level1">
<h1>Where are we so far?</h1>
<ol style="list-style-type: decimal">
<li>Introduction: <code>vignette(&quot;gcplyr&quot;)</code></li>
<li>Importing and transforming data:
<code>vignette(&quot;import_transform&quot;)</code></li>
<li>Incorporating design information:
<code>vignette(&quot;incorporate_designs&quot;)</code></li>
<li>Pre-processing and plotting your data:
<code>vignette(&quot;preprocess_plot&quot;)</code></li>
<li>Processing your data: <code>vignette(&quot;process&quot;)</code></li>
<li>Analyzing your data: <code>vignette(&quot;analyze&quot;)</code></li>
<li><strong>Dealing with noise:</strong>
<code>vignette(&quot;noise&quot;)</code></li>
<li>Statistics, merging other data, and other resources:
<code>vignette(&quot;conclusion&quot;)</code></li>
</ol>
<p>So far, we’ve imported and transformed our measures, combined them
with our design information, pre-processed, processed, plotted, and
analyzed our data. Here, we’re going to learn potential strategies for
dealing with noise in our growth curve data.</p>
<p>If you haven’t already, load the necessary packages.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gcplyr)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co">#This code was previously explained</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="co">#Here we&#39;re re-running it so it&#39;s available for us to work with</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>example_design <span class="ot">&lt;-</span> <span class="fu">make_design</span>(</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">pattern_split =</span> <span class="st">&quot;,&quot;</span>, <span class="at">nrows =</span> <span class="dv">8</span>, <span class="at">ncols =</span> <span class="dv">12</span>,</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;Bacteria_strain&quot;</span> <span class="ot">=</span> <span class="fu">make_designpattern</span>(</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">paste</span>(<span class="st">&quot;Strain&quot;</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">48</span>),</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">rows =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>, <span class="at">cols =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>, <span class="at">pattern =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">48</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>),</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;Bacteria_strain&quot;</span> <span class="ot">=</span> <span class="fu">make_designpattern</span>(</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">paste</span>(<span class="st">&quot;Strain&quot;</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">48</span>),</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">rows =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>, <span class="at">cols =</span> <span class="dv">7</span><span class="sc">:</span><span class="dv">12</span>, <span class="at">pattern =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">48</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>),</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;Phage&quot;</span> <span class="ot">=</span> <span class="fu">make_designpattern</span>(</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;No Phage&quot;</span>), <span class="at">rows =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>, <span class="at">cols =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>, <span class="at">pattern =</span> <span class="st">&quot;1&quot;</span>),</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;Phage&quot;</span> <span class="ot">=</span> <span class="fu">make_designpattern</span>(</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;Phage Added&quot;</span>), <span class="at">rows =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>, <span class="at">cols =</span> <span class="dv">7</span><span class="sc">:</span><span class="dv">12</span>, <span class="at">pattern =</span> <span class="st">&quot;1&quot;</span>))</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>sample_wells <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;A1&quot;</span>, <span class="st">&quot;F1&quot;</span>, <span class="st">&quot;F10&quot;</span>, <span class="st">&quot;E11&quot;</span>)</span></code></pre></div>
</div>
<div id="introduction" class="section level1">
<h1>Introduction</h1>
<p>Oftentimes, growth curve data produced by a plate reader will have
some noise it it. In model-fitting analysis of growth curves implemented
by other packages, the effect of this noise is often eliminated by the
fitting step. However, since <code>gcplyr</code> does model-free
analyses, our approach can sometimes be more sensitive to noise,
necessitating steps to reduce the effects of noise.</p>
<p>When assessing the effects of noise in our data, one of the first
steps is simply to visualize our data. In particular, we want to
visualize the raw data, but also any derivatives we’ll be using in our
analyses. This is especially important because per-capita derivatives
are often the most sensitive to noise, especially when bacterial
population sizes are small. By visualizing our data, we can assess
whether the density, derivative, and per-capita derivative are all
changing smoothly, as we would expect. If, instead, we observe spikes
and rapid fluctuations, we know that noise is likely to throw off our
estimates of maxima and minima of the data or derivatives.</p>
<p>Broadly speaking, there are three strategies we can use to deal with
noise:</p>
<ul>
<li><a href="#FittingDeriv">Using fitting during derivative
calculations</a></li>
<li><a href="#Smoothing">Smooth the raw data</a></li>
<li><a href="#SubsetAnalysis">Analyze only less-noisy subsets of the
data</a></li>
</ul>
<p>Let’s start by pulling out some example data. Luckily for us, there
is a version of the same example data we’ve been working with but with
simulated noise added to it.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co">#This is the data we&#39;ve been working with previously</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>noiseless_data <span class="ot">&lt;-</span> </span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">trans_wide_to_tidy</span>(example_widedata_noiseless, <span class="at">id_cols =</span> <span class="st">&quot;Time&quot;</span>)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="co">#This is the same data but with simulated noise added</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>noisy_data <span class="ot">&lt;-</span> <span class="fu">trans_wide_to_tidy</span>(example_widedata, <span class="at">id_cols =</span> <span class="st">&quot;Time&quot;</span>)</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="co">#We&#39;ll add some identifiers and then merge them together</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>noiseless_data <span class="ot">&lt;-</span> <span class="fu">mutate</span>(noiseless_data, <span class="at">noise =</span> <span class="st">&quot;No&quot;</span>)</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>noisy_data <span class="ot">&lt;-</span> <span class="fu">mutate</span>(noisy_data, <span class="at">noise =</span> <span class="st">&quot;Yes&quot;</span>)</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>ex_dat_mrg <span class="ot">&lt;-</span> <span class="fu">merge_dfs</span>(noisy_data, noiseless_data)</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Joining, by = c(&quot;Time&quot;, &quot;Well&quot;, &quot;Measurements&quot;, &quot;noise&quot;)</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Warning in merge_dfs(noisy_data, noiseless_data): </span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; merged_df has more rows than x or y, this may indicate</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                mis-matched values in the shared column(s) used to merge </span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;               (e.g. &#39;Well&#39;)</span></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>ex_dat_mrg <span class="ot">&lt;-</span> <span class="fu">merge_dfs</span>(ex_dat_mrg, example_design)</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Joining, by = &quot;Well&quot;</span></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>ex_dat_mrg<span class="sc">$</span>Well <span class="ot">&lt;-</span> </span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">factor</span>(ex_dat_mrg<span class="sc">$</span>Well,</span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>         <span class="at">levels =</span> <span class="fu">paste</span>(<span class="fu">rep</span>(LETTERS[<span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>], <span class="at">each =</span> <span class="dv">12</span>), <span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>, <span class="at">sep =</span> <span class="st">&quot;&quot;</span>))</span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a><span class="co">#For computational speed, let&#39;s just keep the wells we&#39;ll be focusing on</span></span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a><span class="co"># (for your own analyses, you should skip this step and continue using</span></span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a><span class="co"># all of your data)</span></span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a>ex_dat_mrg <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(ex_dat_mrg, Well <span class="sc">%in%</span> sample_wells)</span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a><span class="co">#Plot with a linear y-axis</span></span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(ex_dat_mrg, Well <span class="sc">%in%</span> sample_wells),</span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> Time, <span class="at">y =</span> Measurements, <span class="at">color =</span> noise)) <span class="sc">+</span></span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Well)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAvVBMVEUAAAAHwMUOwcYaGhodxMgfx8szMzM6ys08y88/z9JNTU111dd52Nt/3+GLnZqMnpyZoJ2cop+3paK7iIK8iIO8qqe+iIO+iYPCiYPJi4XKjIbYjYfZ2dnaf3faf3jbf3jdf3jdgHjhgHnhgXnogXrpenLpg3vqenLrenLre3Lr6+vte3PxeG/yeG/ysKzy8vLzeHD1d271k4z1tK/2d273dm33hHz3lY74dm34fXT4fnb4h3/5mJH7urb////kuU5BAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAO9klEQVR4nO2dC2ObOBLHc0l71HbTZnNbJ6J7Cc7GUWqUvZVbWnq3x/f/WCveLz1hMI/o382GGHtgfh4N0gDiLLKS6mzsHZi6LCCFLCCFLCCFLCCFLCCFzAH9BqRhzIHLAlLIAlLIAlLIAlLIAlLIAlLIAlLIAlIIHtBF7ZfSI4mhRLomYbGUAgd0kfpxAQCoJFX9tQxAFxARVLOoMgmLpdRQEQQIaFlN7CJ3xOYgiVdAgJpLywD0G1wELRFQmX8soOEBLTIH6WsYc+CygBSygBSygBSygBSSAloXC+tiMTocDvFPqqi1wHmJv24Yc+CSASqorKMKLAuo4FNCiSwgrlqA/snUf5supbi/lRNJFxBcDkJhGHgYLy2CoAAxPAxQsDhAFVS9PKLhMgFVk1EPj+LwCdi/MMQLStLrpBu0BjiK4SABFONZyFGMq84e0QLPYg7zXHX0CGV4aMMjCyhZQGl2DgPc9MgCOhxWDg1CmsQPanlkAR2cL0njYjFEOR4tD5Ch3Dw3s+Y1yAZWq9UgdjMNFkGOs2KpB2epJz54Ie5X3jeCnM1m40wqgvQ8Yvt9uQ9L0dbbjczJAN2yse8cAe3zphWWyXkIQCz735UjF3ANBWib4Um6Poj3diNzwnVx94oE8wOEi9hJxxVDAfKDxtgXXMMAwkEGKM7MAwLyg+bYF1zymvS6taTlEU67Pa3MAw3IJWn3aqR+UFmqNyzaI0LYbge+3FsAQBizDcWjl5kBwgFhXy1SeCsz56wcHUB0T2m4PUwIkFbRnn2t7J/bY6dWb9++1egesw3tyU2P7ehIF5B+wcwlmAYUKduLxNw5ctG5MoKQ52KCG+bGARTj0QaEsecRxF+nCWh79cvVVg2IsE2haQCKDHIQxeyfYJ0mIOTtPMT5SH0BI5xuaHxAJkmaJQacBFAPQD9ZE/upBkSIV3YkRgCU9X7WkUk/qJ4YOgI6fv/f96MKEPKQOzIgvhSAaomhIyD/4fc/lICwR3a4ZQ5c0IDqiaEbIHT9+NTuZTYWWAChXbuCCy5wQLXE0BXQ9Q6rkjS69jxceQkWSylgQI3E0BWQ53rXQit5BHmeOz9AjcTQDdAB4d31fAHJ5O5c9l9vKy7+9OmTwoyrfguIYCOomRg6RRBLQdcYqXIQ669fTzOCpIAacd8ZkMv9SO1N7KvgmAPXfAGxLDVDQFXfuh/FEBJuIV+IW9gMATUTw2CA0mQ3O0CtxNAJkE4TS1rY6ICMi/atxLBsQObljlZiGA4QFpzqHw9QITGgdmLoBEgjB6UBNCVAWROTF+3djx8/AnRuXVdp5FTd6EgX0FqriW0fHh62vSOonsjmEkFagOJuIjoJoAPGmG9u2oBah5ahAM00gvz7+6tj/yTNcrS4KzolQKZFe3T9+OiL2oQBIPFHpgaILwmg1l53ARQHkBIQxs1Tk7BYSgECSrqJvQE1EhnXXPZVzAxQXiyzgISA2nttAcED0slBWQqaKCChWOcNzphMJxxoTDCCkgCSR1C+pYlG0LCAmn2FiQGK/zpTMBN5nB3lTwAoG4mNAOgs/ZETEnhcnBJbcgT1A8TZa3NA085BZwUjiQS7n7ew3od5yUemBsikaO8WJ51PEEFZN2iMJF3jExmUO9z8Wx0+B/E3dRpANRld5eom1cSlAzqr/eIAEhft3d2u/3UvkVYv+aQdaV1AGjkIponlOQjl179wIihPQaeOoLNCbUDKJlYcxHoCchxHwXv78QPv6rMTAGomJBNA6FNx5VQvQM7nz58dKSDn9perD2MBqsvkKIY+KS8q1AKUd3FkgO7v70YDVGtiJkV7vFNelmoESJyDRgWkNbTneYyud5744lYDQMerq6uj8COJppODBOIC0ro9RyeCfP8o/kgi/+lxfoAwchFEBLmtUVbLyvGP3x98zjpwMlwmOoS4gMobEIYH9H/ujS7gZHhI6v0gfUDVGxCGBiS6E6iLv4N8gCe8IzuYgr2q8L+6+fj05INsSlMQNenanUmDRpCzub2/428KFkupVj9IyYwHiBB84O21KaB21a0JaP/rv1zuzQ5C/7KUkaWOs3IxUmaTFiDdiuLKcaq7SNnoEQQQi0PkSQG9YYeDO5MIyqmclf5VFjVaUBdAzuVm45S7mNzGq7x3QAcQy2XNsmTDCiZY0Jpl/nEARacDhAgl2OsNiA3jkeeiZtWt9hEHkWf6wg9WfUD5iS2NIzYEIBSGhARY9JVrAEom6oinItuTIM9lvLGYc/4PSolH/uoLqFFaNgDUgCos2ic5KK7cbON5uGhAqWxsoADkbN6+OWfZ5Q0Ng112RjA9nCW1oeIjq1u2sYDQb1JzeoA0zm7xAdUkLHcgP6yLKC8qlAG6zc0FNCQoB+QFIVcvggs89QH1SNJ6gNAjpdX57YJsBp+OgJBXmKM074+7Xm0bheJtdQIEc5iv14M4gJKivftU3/meE0j+dZ+Zi0OmKMYXk3zVthSyBnZiaZVcpRGEFYMnVQQdv5cRVK5H8RxNbf1UmZsCoGoO8lvjRvOj2PG/qa1vtYvQUbuJZRubPiApjV5Djf7mhgVU/0sA6JXJvGj/ymRecn1lsoAUWjig//BlYMG8aD8rAQPSKtrPStARtDiNAQj4oYTA5gYGpFO0B/YI2NywgLQqisAeAZuzgBTmLCCFOTNAZ20GrxbQjx8/OIDUZVdZ0X5JgH58/fr1ByeCKmVYHUA6AvYI2FxHQOKGYz4Wk+/nRaxkQdMjbVPZH8CAKmc6TgSo8K4/oJqpi9/k0BWABDkoyqJIE5AWIS1AFxARVDPVF5DwKGYCSGuwqgUIpInVFgYDFJ0ZRJCOFIDyVAGTg04B6LRHsXlFkIZedxMzBSR8yQIyIDQSoJ79oMkA0tcw5iwghblhAWnV7IE9AjY3LCAtAXsEbM4CUpgbGFDap7SARIAqxZFExSUdhg+BnM71QcMCKq8CjuZ6ARU8oMqwdl27aMoCagGK2oC0HgI5JYEn6XpdpAJokTlI46yPfO2SAL17964dQeqTXLqAKqjmCejd+/fv3wkBlZfeKwA1xhrr1sLCAFVPjAniiZOkGzlonXSD9B9EOytAUXFqVXRZi/mp53kC4uegomyf3emiamJLBiQ4zDdPziubmDDUoAClMyhND5BWDtIarPbzKL710pkaIP2jmI6WBUgpc0D9tLq8vNR4lDyUoAF1m3nB6CufWA4yA3SqoxhCrgUkXofDkOyQBcRfl9xpSQKMLSDeOre4uftEgPqLN1iVf6KzR45T3qdLTtTE+ktGw/ghkFKPnNvs3vj4VvJTJelBAQHf9bwPMkAUne4wPyNANMNTzA+0SEDdi/aUptHT7dMjqgRUzpZcnPapAOpZMMNBwEIo8Csv9TE3TgQ1D1+VhrVe92timISYBdCR49GMADWH+/X5FnoAWm0JJWFAuR7NClCdEVSSdi4pjWfx4ns0N0BRpakZPgRSCOhLQAilAo/mBkh9U7ixR4jQgBLRo1RmBUjrlnljj4oGNndAmhMKmHqEiwY2c0CtfhAMoKSBvYinEJ8PoIFE6QvpOQ3cqBr6rMaR3BcN7JVEkJlH+3gmXNnstK8c0JY8U8Fc013MLQ8Q3j4/05UFJHrJofv9di/16FUDcp7/pHtytIBELyEP+S++3KM5A+pdtEcEY080lfL8AfUvd/i3+z1VeLQYQIUMPMIvL4/CJzqam5syoKyJmRXtMcEuyJMhx5QeoHWXJuZ6CBMsfLupuWlHUCdAaYq2gER7jRHGVLDOAjpUHjq2VEA9i/aqB/UsABBfuh6pHtRjaG5xgJQP6jEzt0RAxUPHLCDeS5WHjr0yQHpydxiTufeiYw0VQfEww2ue7HkdEaTlEcqHGRaQCFDluZAWUPsljBCygGSA2DDDFayzgNJH01pAkr3GHhtm6Hk0Z0Cdi/ZpsX7xgLqXO9JK0CsCFEVmgNJhxmsEpFe0v7nbL2OYEUsTkEkOcp4fyB3W/col5pKn9c4rghQepUt7sk8qQX0BoeTh88sDdHN/uyfNq8Y7AHK2d543E0BGR7GbPzH+97E3IGezv91yU/1kAHUs2lNM/dZl9Z0AJQ8PnzIgvhSA8Et8SRAAoGdC77jdzXkDQp7/8PwAAOh4f0spuV4eIILpi2/gkRAQeaa+tzxALANhzn0H5oD8z8/PIZr0UayLcHxZNEgnGr+8PE2hNw4bQfGthbhVq+8SQZhgVL80ZDYRJAG0DcPizqd+gG7IPrsAfUmAEAlpwL8xwxCQww5gd+178GYNyHGYVwENSbvSag6oco9ZwWzlzBrQarOhYbgPAt/wK+etx0GY38SZv+RsLjfO/ACVX+vqOWROxVMHdAbEYjBdykgfkoLHbAHFc5EVe43SmTmCgFsG0gMUz48X3/aC4tlzwqSBxQUPd8KAZEX7ZLq/8ze/7ospgRigxCtjQFkYOpvbbH4hmk4wxAB9+PDBdZzzeF64+F3FBHHTACQsdyBcUglpdZnPRQ7I+fwlbCgIwyQBbR9IcxVXFE8KEPIo5e4nEnCRA2qZY5ksu8UM6fGpzvg1MqCkaO/umoCSiW+6jgsa5mJbNyvuKhmgjhtXq18EBfmXjvlRohNBx/vMXJDbKt5YrJpNBCUeVXPQN18KQQfQ4ejnmFt9qGKVXBPLQXIa3ftBIOYmAIiJc/Kw80vw5mBlXrSPLCClLCCFLCCrQhaQQhaQQhaQQhaQQh0AJZ2irGeUPfQnf6n+K12svxQ1f0Gbg5Y5oNSDqN3TznxLHv2XvyG9oXxd/Uz9F7Q5cHUElC2sKy+tI5FH60gFCM4cuHoCqo1Git1f13e/WKME1N8cuLoDqvzUv+u2R+2XuGYgzIGrH6Ds72In+R5FMo+AzYGrM6B15W+hR2ttQFDmwNUV0LqyLG4T3CNRxAEEZg5cHftB+VMPq50QTi9l3VwTRc1f0OagZXvSCllACllACllACllACllACp0SUDnj+Yy+llPv6ozQpLKAFBoHUPKswPSZpcUzcieKbjxAydMUs0cqno2xK3oaMYKi8n8WUGN7LUAaD58cSRMBdOK9MJAFpNCEAE2T0jQA2cP8fGUBKWQBKWQBKWQBKWQBKWQBKWQBKWQBKWQBKfQ3Aryv6CTzwRkAAAAASUVORK5CYII=" /><!-- --></p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="co">#Plot with a log y-axis</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(ex_dat_mrg, Well <span class="sc">%in%</span> sample_wells),</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> Time, <span class="at">y =</span> Measurements, <span class="at">color =</span> noise)) <span class="sc">+</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Well) <span class="sc">+</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">trans =</span> <span class="st">&quot;log10&quot;</span>)</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Warning: Transformation introduced infinite values in continuous y-axis</span></span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Great! Here we can see how the noisy and noiseless data compare.
We’ve plotted our data both with linear axes and with log-transformed
y-axes. log axes are useful because exponential growth is a straight
line when plotted on a log scale, but in this case it also helps
highlight the higher relative noise at low densities compared to high
densities. In fact, this is a common occurrence: <strong>at low
densities, random noise tends to have a much larger effect</strong> than
at high densities.</p>
<p>This level of noise doesn’t seem like it would mess up calculations
of maximum density or area under the curve much, so that’s not enough of
a reason to smooth. But let’s look at what our derivatives look
like.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>ex_dat_mrg <span class="ot">&lt;-</span> </span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">group_by</span>(ex_dat_mrg, Well, Bacteria_strain, Phage, noise),</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">deriv =</span> <span class="fu">calc_deriv</span>(<span class="at">x =</span> Time, <span class="at">y =</span> Measurements, <span class="at">x_scale =</span> <span class="dv">3600</span>),</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">deriv_percap =</span> <span class="fu">calc_deriv</span>(<span class="at">x =</span> Time, <span class="at">y =</span> Measurements, <span class="at">x_scale =</span> <span class="dv">3600</span>,</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">percapita =</span> <span class="cn">TRUE</span>, <span class="at">blank =</span> <span class="dv">0</span>))</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="co">#Plot derivative</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(ex_dat_mrg, Well <span class="sc">%in%</span> sample_wells),</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> Time, <span class="at">y =</span> deriv, <span class="at">color =</span> noise)) <span class="sc">+</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Well, <span class="at">scales =</span> <span class="st">&quot;free_y&quot;</span>)</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Warning: Removed 8 rows containing missing values (`geom_point()`).</span></span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="co">#Plot per-capita derivative</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(ex_dat_mrg, Well <span class="sc">%in%</span> sample_wells),</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> Time, <span class="at">y =</span> deriv_percap, <span class="at">color =</span> noise)) <span class="sc">+</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Well, <span class="at">scales =</span> <span class="st">&quot;free_y&quot;</span>)</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Warning: Removed 12 rows containing missing values (`geom_point()`).</span></span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Those values are jumping all over the place, including some where the
growth rate was calculated as infinite! Let’s see what we can do to
address this.</p>
</div>
<div id="FittingDeriv" class="section level1">
<h1>Fitting during derivative calculation</h1>
<p>One thing we can do is actually something we already did in the
Calculating Derivatives article (<code>vignette(&quot;process&quot;)</code>):
instead of calculating the derivative of each point relative to the
next, we can use a moving window of more than two points and fit a
linear regression to this data. In the earlier situation we had used
more than two points because of limited resolution at low densities.
However, the same solution can apply here. By calculating our
derivatives by fitting many points instead of just two, the effect of
any single noisy point will be reduced.</p>
<p>To use the fitting functionality of <code>calc_deriv</code>, we need
to specify either the <code>window_width</code> parameter, or the
<code>window_width_n</code> parameter. <code>window_width</code>
specifies how wide the window used to include points for the fitting is
in units of <code>x</code>, while <code>window_width_n</code> specifies
it in number of data points. Here, we’ll demonstrate its use by fitting
regressions with more data points. Note that when using
<code>calc_deriv</code> in this way, you should use <em>as few</em>
points as is necessary for your analyses to work, so you should
visualize different window widths and choose the smallest one that is
sufficient for your analyses to succeed.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>ex_dat_mrg <span class="ot">&lt;-</span> </span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">group_by</span>(ex_dat_mrg, Well, Bacteria_strain, Phage, noise),</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">deriv5 =</span> <span class="fu">calc_deriv</span>(<span class="at">x =</span> Time, <span class="at">y =</span> Measurements, <span class="at">x_scale =</span> <span class="dv">3600</span>,</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>                            <span class="at">window_width_n =</span> <span class="dv">5</span>),</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">deriv_percap5 =</span> <span class="fu">calc_deriv</span>(<span class="at">x =</span> Time, <span class="at">y =</span> Measurements, <span class="at">x_scale =</span> <span class="dv">3600</span>,</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">percapita =</span> <span class="cn">TRUE</span>, <span class="at">blank =</span> <span class="dv">0</span>,</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">window_width_n =</span> <span class="dv">5</span>),</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">deriv9 =</span> <span class="fu">calc_deriv</span>(<span class="at">x =</span> Time, <span class="at">y =</span> Measurements, <span class="at">x_scale =</span> <span class="dv">3600</span>,</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>                            <span class="at">window_width_n =</span> <span class="dv">9</span>),</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">deriv_percap9 =</span> <span class="fu">calc_deriv</span>(<span class="at">x =</span> Time, <span class="at">y =</span> Measurements, <span class="at">x_scale =</span> <span class="dv">3600</span>,</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">percapita =</span> <span class="cn">TRUE</span>, <span class="at">blank =</span> <span class="dv">0</span>,</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">window_width_n =</span> <span class="dv">9</span>))</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a><span class="co">#Plot derivative 5</span></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(ex_dat_mrg, Well <span class="sc">%in%</span> sample_wells),</span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> Time, <span class="at">y =</span> deriv, <span class="at">color =</span> noise)) <span class="sc">+</span></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.75</span>, <span class="at">size =</span> <span class="fl">0.75</span>) <span class="sc">+</span></span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="fl">1.25</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="fu">aes</span>(<span class="at">y =</span> deriv5)) <span class="sc">+</span></span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Well, <span class="at">scales =</span> <span class="st">&quot;free_y&quot;</span>) <span class="sc">+</span></span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;window_width_n = 5&quot;</span>)</span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Warning: Removed 8 rows containing missing values (`geom_point()`).</span></span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Warning: Removed 8 rows containing missing values (`geom_line()`).</span></span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="co">#Plot derivative 9</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(ex_dat_mrg, Well <span class="sc">%in%</span> sample_wells),</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> Time, <span class="at">y =</span> deriv, <span class="at">color =</span> noise)) <span class="sc">+</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.75</span>, <span class="at">size =</span> <span class="fl">0.75</span>) <span class="sc">+</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="fl">1.25</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="fu">aes</span>(<span class="at">y =</span> deriv9)) <span class="sc">+</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Well, <span class="at">scales =</span> <span class="st">&quot;free_y&quot;</span>) <span class="sc">+</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;window_width_n = 5&quot;</span>)</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Warning: Removed 8 rows containing missing values (`geom_point()`).</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Warning: Removed 16 rows containing missing values (`geom_line()`).</span></span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="co">#Plot per-capita derivative 5</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(ex_dat_mrg, Well <span class="sc">%in%</span> sample_wells),</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> Time, <span class="at">y =</span> deriv_percap, <span class="at">color =</span> noise)) <span class="sc">+</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.75</span>, <span class="at">size =</span> <span class="fl">0.75</span>) <span class="sc">+</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="fl">1.25</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="fu">aes</span>(<span class="at">y =</span> deriv_percap5)) <span class="sc">+</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Well, <span class="at">scales =</span> <span class="st">&quot;free_y&quot;</span>) <span class="sc">+</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;window_width_n = 5&quot;</span>) <span class="sc">+</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="cn">NA</span>, <span class="dv">10</span>)</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Warning: Removed 22 rows containing missing values (`geom_point()`).</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Warning: Removed 8 rows containing missing values (`geom_line()`).</span></span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="co">#Plot per-capita derivative 9</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(ex_dat_mrg, Well <span class="sc">%in%</span> sample_wells),</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> Time, <span class="at">y =</span> deriv_percap, <span class="at">color =</span> noise)) <span class="sc">+</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.75</span>, <span class="at">size =</span> <span class="fl">0.75</span>) <span class="sc">+</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="fl">1.25</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="fu">aes</span>(<span class="at">y =</span> deriv_percap9)) <span class="sc">+</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Well, <span class="at">scales =</span> <span class="st">&quot;free_y&quot;</span>) <span class="sc">+</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;window_width_n = 9&quot;</span>) <span class="sc">+</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="cn">NA</span>, <span class="dv">10</span>)</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Warning: Removed 22 rows containing missing values (`geom_point()`).</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Warning: Removed 16 rows containing missing values (`geom_line()`).</span></span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Great! As we can see, increasing the number of points in the
derivative calculation reduces the amount of noise and gets the result
closer to the ‘true’ noiseless data. However, you may have also noticed
that it biases our results slightly, making peaks less high and valleys
less deep. Moreover, in some of our derivatives, especially the
per-capita derivative, some noise remains. In the next two sections,
we’ll explore how <a href="#Smoothing">smoothing raw data</a> and <a href="#SubsetAnalysis">analyzing just a subset of our data</a> can
further reduce the effects on noise on our analyses.</p>
</div>
<div id="Smoothing" class="section level1">
<h1>Smoothing raw data</h1>
<p>One of the most obvious approaches to deal with noise in our raw data
is to use a smoothing algorithm. <code>gcplyr</code> has a
<code>smooth_data</code> function that can carry out such smoothing.
Note that when using <code>smooth_data</code>, you should generally
carry out <em>as little</em> smoothing as is necessary for your analyses
to work, so you should visualize different degrees of smoothing and
choose the least smoothed one that is sufficient for your analyses to
succeed.</p>
<p><code>smooth_data</code> has four different smoothing algorithms to
choose from: <code>moving-average</code>, <code>moving-median</code>,
<code>loess</code>, and <code>gam</code>.</p>
<ul>
<li><code>moving-average</code> is a simple smoothing algorithm that
primarily acts to reduce the effects of outliers on the data</li>
<li><code>moving-median</code> is another simple smoothing algorithm
that primarily acts to reduce the effects of outliers on the data</li>
<li><code>loess</code> is a spline-fitting approach that uses
polynomial-like curves, which produces curves with smoothly changing
derivatives, but can in some cases create curvature artifacts not
present in the original data</li>
<li><code>gam</code> is also spline-fitting approach that uses
polynomial-like curves, which produces curves with smoothly changing
derivatives, but can in some cases create curvature artifacts not
present in the original data</li>
</ul>
<p><strong>Additionally, all four smoothing algorithms have a tuning
parameter</strong> that controls how “smoothed” the data are. For
whichever smoothing method you’re using, <strong>you should plot
smoothing with multiple different tuning parameter values</strong>, then
choose the value that smooths the data as little as is necessary to
reduce noise. Make sure to plot the smoothing for every well in your
data, so that you’re choosing the best setting for all your data and not
just one well.</p>
<p>Smoothing data is a step that alters the values you will analyze.
Because of that, and because there are so many options for how to smooth
your data, it is a step that can be rife with pitfalls. I recommend
starting with the simplest and least “smoothed” smoothing, plotting your
results, and only increasing your smoothing as much as is needed to
enable downstream analyses. Additionally, when sharing your findings,
it’s important to be transparent by sharing the raw data and smoothing
methods, rather than treating the smoothed data as your source.</p>
<p>To use <code>smooth_data</code>, pass your x and y values, your
method of choice, and any additional arguments needed for the method. It
will return a vector of your smoothed y values.</p>
<div id="smoothing-with-moving-average" class="section level2">
<h2>Smoothing with moving-average</h2>
<p>For <code>moving-average</code>, there are two tuning parameters to
choose between:</p>
<ul>
<li><code>window_width</code> specifies how wide the moving window used
to calculate the average is in units of <code>x</code>.</li>
<li><code>window_width_n</code> specifies how many data points wide the
moving window used to calculate the average is.</li>
</ul>
<p>Specifying the <code>window_width</code> or
<code>window_width_n</code> is required, and larger values will be more
“smoothed”. Think carefully about whether you want to hold the
<em>amount</em> of time or the <em>number</em> of data points in each
window constant (if your data was all collected on constant intervals,
then there will be no difference).</p>
<p>Here, we’ll show moving averages with <code>window_width_n</code>
values of 5 or 9 data points wide (because the window is centered on
each data point, <code>window_width_n</code> must be an odd number of
data points wide). Note that <code>moving-average</code> returns
<code>NA</code> for data points at the start and end of your data where
the window extends beyond the domain of your data.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>ex_dat_mrg <span class="ot">&lt;-</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">group_by</span>(ex_dat_mrg, Well, Bacteria_strain, Phage, noise),</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">smoothed5 =</span> <span class="fu">smooth_data</span>(<span class="at">x =</span> Time, <span class="at">y =</span> Measurements,</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>              <span class="at">sm_method =</span> <span class="st">&quot;moving-average&quot;</span>, <span class="at">window_width_n =</span> <span class="dv">5</span>),</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">smoothed9 =</span> <span class="fu">smooth_data</span>(<span class="at">x =</span> Time, <span class="at">y =</span> Measurements,</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>              <span class="at">sm_method =</span> <span class="st">&quot;moving-average&quot;</span>, <span class="at">window_width_n =</span> <span class="dv">9</span>))</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a><span class="co">#What does the smoothed data look like compared to the &#39;true&#39; noiseless data?</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(ex_dat_mrg, Well <span class="sc">%in%</span> sample_wells),</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> Time, <span class="at">y =</span> Measurements, <span class="at">color =</span> noise)) <span class="sc">+</span></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.75</span>, <span class="at">size =</span> <span class="fl">0.75</span>) <span class="sc">+</span></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="fl">1.25</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="fu">aes</span>(<span class="at">y =</span> smoothed5)) <span class="sc">+</span></span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Well, <span class="at">scales =</span> <span class="st">&quot;free_y&quot;</span>) <span class="sc">+</span></span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;window_width_n = 5&quot;</span>) <span class="sc">+</span></span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>()</span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Warning: Transformation introduced infinite values in continuous y-axis</span></span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Warning: Removed 8 rows containing missing values (`geom_line()`).</span></span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAA8FBMVEUAAAAAv8QBv8QCv8QEwMUHwMUIwcYPwscQw8gaGhodxMkexcogx8szMzM7ys4+ra4/ra9Az9NCrq9NTU1NsLFOsbJoaGhsn55tn55woJ90nZx11dd4nJp5nJp5uLh52Nt7m5l7oqF8fHx8m5l8nJt8nZt8o6J9mph9vb1/3+GEnJqMjIyampqnp6eysrK9vb3Hx8fJi4XQ0NDZ2dnaf3jbf3jhgHnh4eHoe3Ppe3Pp6enr6+vse3PweHDw8PDxeHDyeHDysKzy8vL1tK/2dm73dm73fXX3hH33hX34dm34d274eXH4enH5f3b7urb///+KZmY2AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAR50lEQVR4nO2dDWPUthnHnSuHL6wlxUchnY0WsLPeEShd2NYFb8muK2xHAH//bzO9+EWSJUuy5LMd9G+5OOb0nPS7R49ebPwEhVengrErMHV5QAp5QAp5QAp5QAp5QAp5QAp5QAq5BRQIzInO6VpBR2/WvYygMkjm5TgrtgZYawMAwr/1aOivUwQk/ASLj7ABdBm87v/BVBXsil8Gr+Dr2+ASvl4El6RB7y6CNa7cuxfBBWnbu1dB8Ood//YOK3VZ4gXwz+vSaFP15oPIrwHjM2+CX+zaVpq1LY8ixGv8ZeHWoB9rVE145hodXKBz+ChYX3Nv77BSl60AXZRGqUL1B5W/soBeBZcXwZNfLdtnDehVAKuwRg38FboBacuLa/j1rVGLXxTXL9A5dFS8gG1h395hpSlbdjFo9GfMsal6/UFCXRBc7ywbaAvoMvgZ9o3XwVtY1csSEKoTOnqCjt5RR0+4t3dYacqWgCqjVNUF55i/vkT97JXkr3VlH+VfwG/7GjrHRUAFVfkR/XZ9K82vVBn2HN/F6DfZtM+yPOwd1+uL4mJdwJiqAYh5u76VGQOCvQMOF7/A/vEL3zRBF2Pf3mGl1cWKQgGI15r89RPL9tnPg3AgvIav1zygn1EUZYM0+/YOK03ZvoBeBW9QDHpj2zzL8qgi6Et6ghBwgATDPPv2DitN2QCNUz0AvcOfaetADgCRGevPuMuwgAo4kWMnitzbO6w0Zd/0BIQsBK+vZX+rq+GXGjOXB6TQmIAC8cjsvIyVPCDVBx7oc2YrD0ghD0ghD0ghD0ghD0ghW0BvjTQV0wbygBTygBTygBTygBTygBTygBTygBTygBQaANAx88MRoGOsDvOW7ZDKPaBjUvdjx4AaUvSP+QI6du1BHP75e9BAgObfxY6ryvsYhNUGxDXEFSD+aL6A3g7jQXcFUBN/PCCsgwG6MzGoU1MxbSAPSCEPSCEPSCEPSCEPSCFbQHkO/891X5ty9f3x6/W6/cPKtFuNBKjmsCZ/2B9Wph1LB5Dk28YyaMX+Km8sOgUUjgtI8m0TadQfpET7/RVlVGizNv0dlGYLEmj6/ZX6fT2lBiT7tomkaOIk5XUliEHaHvRe/DFJm71bmXQx/a9504IDpWFTDgh6iQhQ+S28v5pEDNL2II5M1yimCQiCSCS9N5lOkNYEVMacvaBPqGzKTIP0LAUCQPD0lEYxPUAgTZDT6MyDsCWdeVBylm4EgJBfzQ8QdB7Rl23eCgZQIgR0lk5nHtT+trFEYSERoLECBJIECACh05MA1KUWiKQJC84AJT8iQIA3B/1qGjPpLvEIYDjNnAMCsNOKAKUzBESHBZceJAQ0Qw+CDpS4ByT2oA0KQXMDhBzIFaBG0IOKzWYjODu8nANKnAFq3DKCrrJJeA+KUmDPXinnXQy4BxQ9i3Ichxhzy+Q0mQEgVpvUodvXjc9Os7ztQXAWtJsBINZHkh9liwyrLpZBNq0gTVxqZoA2aWssdgEoEQEC7IrGsh1SufagRILGAtAGW+UBxdmfs9kBwosj94BAkrcBgex8NztAXFjoAEStd9f0CdE6mIRnHlB2et6fvYHcepB8o4NtBbVjsl5TJ4Q7KQQ7D+gEjf1zA6TtQQ2IdaEEJPSg8HGymR2gMgSZeZAYEH09oFxkcGsNOE20rLqeXAIqHcgFINp0OUUEgJmkR8lkupgsoGIxHpRupGgsAJVzBxZQDCbTxWQBlWh4DwJCDwLZ80+TA8QGVCI2Bg3hQSAigY0DBDKxadcy8iAOEH9ldZPwWzZyo+vaimoeFJHxvOVBYPqAkOg663cxLZXF8FqeB7TMns/Ag5AYQIkcTW9AIThvd7HwQZTtZgMoLOuJtkCdAwofRhtBDFqCZDaAVg/DyoPAIB4kAgS7881UAEkDKhblQcMAikEiAgT4iydGpg3kbiYN3HexVY5D/w0uHLEeBGYIqOuKWJ9WrB6t0BKMrLlWz6JmErE6zCUfJHeA0CA/hAcBMvv8fJrVHrR6EM3Sg/g6O4lB9fQ8AyCsDC2jZy89IFKsnn0CED0MiaEtyE5vZwdogC5W0Kt20HjQFoBbu/CmL2eAwDAeFFcxiB7mIaDdXADVMlipago1O4Ye9EUAKBsJUPPwb13VNcSxwvkoFsfJ32/agLLn43SxgPwxIdR0sQQYAGom49WRYJIePgrjJfiXyIPScTzoYIDoTbjq/lD2fEE8aPng5N8v24Dw7HocQAF/TqF+XawFSLxZuY3jKPvbpxagDUhG86DegCw9SLhZud1uN5tPZRnqso/7AUEuLkib8mkA4Z1RZ4CI6S0axKp9H8qDRPdI9Gu+Wq7mQRu8M+oeULPv0wCK27fjHTBI8+cUwq3IQxgWsk40vT3opu1B8QbspgRINiQ3rQgfhqIv1QmgWxGgbBRAkufpy4ZkqhXQg1S3TnGtaHYpO+ZB0DTI/nvbAIpjAugczRNH9CBWsiG5aUWcq2++69EKDAjUq3YMaEs8KB2piwkl6w7UWIwGXvdbfATQTgBoNA8q9LqYwINApLgzqK8HpQ2gpAIEP2zcIM1KC1B1fdg1oPTZnpqql4Ci778P5wYoO8uGAAQkHiT4NoxMG8gNoDhLhwBUnFD/sqGJQcJbIY1MG6i9H9SSbEguWwEBxfXVPZeAimKRJtS/toeLMTQeFEV6nspKuBfrQeZ5hQggEP3wcmgPypELIQ/ajehB5iKA+BsGHQH6sqP3nhtAm7i3aeP2OlisxvEyeaq6M6gXoP3+hioMIhDfD8NFlkb9ARmrNQ8y3+7AHvRlAEAf9/v9VVM4ehwtvzk6+keapuFIgPptmCE+t0MAyj9+vGp50PIEepC+6aAIqmSR9WZXwJ7qlgtAy+Ts989DAGIL4xgEBwQAtgaA6H32gD/UaKsrD1KhGQ0Q1S4aUHEoQEWx2m7P91+Migj2mIRTrGEAVVf+9KY0osWqfjvxxatllu73Zh4k2EIRbTWxhXeuABntvdsP86sYZHslGj1A6y4Put3jxxKl6Yk1IIPLfw7mQYDatLH1IHaridHnfQXobKFfP1kM6hekhftB3crzz2mqccnQEBAxzRb+QADtIR9zD3I2zJuKVPvqEIDyvFzN2w+QBrIGlH/ep1cH8SBEyNEMwkD2gPTQuAHkaoplII39oE71bEVrj0ljHhSGIb7vdVRAB80zbabVvaN7C3Tn9GFl28XuvDwghe44oN/EMrBgG6QnLseAemzaT1yuPejOaXxAE8+K4DwGGW/af12AeuwoekAHaMWApj0gD2hQQEGbAS/bTfuZA1Jvu975Yf4/lT5VB4wHUduwYgu2a7HZAPr0v08dgOSRxTmgofKssmaPNXM9Kz2IutKhAagHoTagukVuATFmBVk4xTY0gnRg4kHmi1UZoIGSYR+/HRVQD8kADZaI1jmgIjgwoCo8uI9BAwEyGcXcdbF5eJCGBDDsJopfASC7pYYH1NGKgwEymAdNDlCnDAxPczX/tS1WNXTnF6se0EEBkSnToVsxoGnXMagwuLvRXSsGND0+oAHvcnJh2j0gZtVW38009ZTeUg0LyGlK79CBB3XdKyq24TxIM3wKd4BQ5ue9Yb7hlqH3f7kaGxAnBSDNlN5VVmzTjNU8gqvT9449SOOqjxUgUSv4Vyottq0HRal5+kSFB2lcBey8idMaEKjp3HS0QiLeXJKedTxuWGzjt9/+VGlZHQgANbfedwMKuFHeFhDpXH1zffJhLDtLOx5YrQK0/MOyDYi+MCbxJ61hviegMpe6shV6gECSAQtAQg+qdqULzjOMALXv9tacB2E87iaKyVnSB5BiFKu6ViDbmB5uJk3cxxmg7ZCAuN9p2S5WpYCSVJB1vi5mkoCtHA4TyGdAQFoxqIe6xi95K6gwpk7ARl7RM8DqJwM7BqQ9ivWQDFB6lna0ogGhkYANv4Y/pGAIQEq15kGGzCSAMjy663iQGFBrkr4V53tWyTGgzmuwYokBAehAXV+zElDLNDhPduN7UA9AYiVn3U/4MQeEs6rOEZCwtnDtLl42VaV6eBB6ZlAFSPTP6sTVmygg2MP4pAW2gHBq8BJQ+Ej76S8DBGnTJy8IQMA5XWuKyLXCIAEbeY3QI1/MPcheQwzzG+RABoFCwzRIT3vFIHsNAQg7kFtA2SkyeUcAwQgke/BtH9M4GwvuYTnI7gQg4kCuAIUPUcTBMbqVAPuwgJqnJTdXNUxXlEXjQE49CGQ4gU30TP6wvd4EFKJX+pw39VhRFo0DOY1B2SnOiQmikbsYO8SbrygJIOEqzK4V0HXQD/O1mL34GMRt2ZutKJE2aGvdiSi6ZfrEiYxiFSLz6S56TX4ULlOtuliVPnEKgEw8iG1F9WWbX3qQiAZElnajA5LFIANAIO3KlWlUtaZYldttZEAdo5g+IDSGufegtMzthpLShlObBxmsKPNimZyZXx+WiKJ+mtSAwofhWB7US1w9YbToeiJeT9NooTG+B/UTV0/kQM4BxQlcypeA0FQ63sYzBIT3sO4PACiG08TKLUH0OETPwsO5TuYFiOQM30bt3HrCVmil8MPFII4m8RT2oHkCIh60SdvZGUWtoFcx1dV/9nxBUvhhHKB+sj1OrT5TQLg3nEu3yhSAhCn80N5zDHE02QFnCIjRNjm70Xpj24M4QGSZtyJZ/M6T6mnMeLW6RTrY0/CcehAe5Pt1MZEHoWLQg86f1rndag9atmZDlu2QygmgamqSyLfKLACdJCctQHFrNmTZDqlcAKont8MAiprkdxBQPLMYRHsQ7GGKBDZVKRNA0bPTWxpQPENAZT1LB9KfB63rI+k8CKUNavIqzRxQdia/6NCjFahAjBKJJncFUCTMCGIJCNzghIbERDRfQLDOu/TpAB6UvP/9Q2UifBxNCpD+ggktsOPsaXrfPaBo/6kxkUzKgzQXTATQfdiU9ESOpi+gZXqzr018eH4+aUDinOe4hstvlyB9mjkGhNKMRHsqr1I2cQ8SLpiwtvfRTUFuF0h5fj8+StKX9FpmXoBIK8oYBLp3o/u0YvXt0R/TdE9hx2kOS5nZ6i03gOCXGj3WSD9iVDXkQSctD8qJB8Vl3ud5eFDM7Gq5jEEoRfj8AeGwIPinK/aA+LRB0wKku2DCtd3epp2brb0AQegZs+8DTiCgZbxdLuP4qMgXOdqWXSyOFpOeSWNAm5ubzu36PoA+on9R9c+QMvFT9FO+fLC8/803y6PlYhEu8vDREdJi8oCSv95IruhZeBAk9IHxoN1Pu7YHIUCT96Ao3b/sRNMLUMvE7suuFYPQ4bQXq7CCSzhd+TAeoLGCtI5IDUGEQrQBoD5JIFuAyHx6FoDS1CwRrWCZRy+Ha9MtE192uxrQFqPZThxQga5ToccqGBWRAeKTQC54QPs9yXTYPM4BP/Pio+FDHQzkxINA6iqNaAWIrIMXKy7dI8r+zCIigEwfC2IgF4DgdHfnGFBpuuVBHytA+/l40Gf8ZI5hAEkM4e0OEonyauvDsh1SWQPCWTL3HQ/2GRZQPHlA2IMOlEa0fo0xpnwegKpx1gRQrySQ7dd5ACr6ANI0rTI6MiDd6W6sgWYYQPhGhh6mDWR2VUNvuvu1A+Kmu6s81Njo+JoAsdPd1aPFvXuD3BA3f0CkFaN6UF7nDzdst7bsAY0ag3qaNtCEAYmFe/NihQ7Qf631rGvZAoKRyPDYQAITK5QO+7vF0QrGPvjf0eK7xbCEjC77COZBhwbkyrS27DfMPCCFPKCvWx6QQh6QQh6QQh6QQnaA1ms8NcKv1DEj+l1lmZFNG8kK0Lr+ryh3idbliTU5YE4V7HR8NNNmsuxidf3KtjCtWFu1YkDTJnICqKlzU2WqY9gAGsS0iWwBrfkOwLaCOWUIaDjTJnIBCB8U7VYU9oCGMW0i6y42HKDhTJvIdpinXtz2gwFNG8lumKenIcxkhZqz9JusDGjaTH4mrZAHpJAHpJAHpJAHpJAHpNAIgJqH7c3h2xmpjnNAQ+QBKTQqIJymgqTLqbMPTQ3d6IBwIo8ym0cwYo1kGh1Q/ZsH1P7YFiDjvCfDa1qAxqlMpzwghaYHaGKUJgXID/MzlAekkAekkAekkAekkAekkAekkAekkAekkAek0P8B7SBj/1cUsYAAAAAASUVORK5CYII=" /><!-- --></p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="co">#What does the smoothed data look like compared to the &#39;true&#39; noiseless data?</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(ex_dat_mrg, Well <span class="sc">%in%</span> sample_wells),</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> Time, <span class="at">y =</span> Measurements, <span class="at">color =</span> noise)) <span class="sc">+</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.75</span>, <span class="at">size =</span> <span class="fl">0.75</span>) <span class="sc">+</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="fl">1.25</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="fu">aes</span>(<span class="at">y =</span> smoothed9)) <span class="sc">+</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Well, <span class="at">scales =</span> <span class="st">&quot;free_y&quot;</span>) <span class="sc">+</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;window_width_n = 9&quot;</span>) <span class="sc">+</span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>()</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Warning: Transformation introduced infinite values in continuous y-axis</span></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Warning: Removed 16 rows containing missing values (`geom_line()`).</span></span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Here we can see that <code>moving-average</code> has helped reduce
the effects of some of that early noise. However, as the window width
gets larger, it also starts underrepresenting the maximum density peaks.
Based on this, we’d probably want to use a <code>window_width_n</code>
less than 9. Unfortunately, with smaller <code>window_width_n</code> our
early data is still being affected by that early noise, so we should
explore other smoothing methods, or try combining multiple smoothing
methods.</p>
</div>
<div id="smoothing-with-moving-median" class="section level2">
<h2>Smoothing with moving-median</h2>
<p>For <code>moving-median</code>, there are the same two tuning
parameters:</p>
<ul>
<li><code>window_width</code> specifies how wide the moving window used
to calculate the average is in units of <code>x</code>.</li>
<li><code>window_width_n</code> specifies how many data points wide the
moving window used to calculate the average is.</li>
</ul>
<p>Specifying the <code>window_width</code> or
<code>window_width_n</code> is required, and larger values will be more
“smoothed”. Think carefully about whether you want to hold the
<em>amount</em> of time or the <em>number</em> of data points in each
window constant (if your data was all collected on constant intervals,
then there will be no difference).</p>
<p>Here, we’ll show moving medians with windows that are 5 and 9 data
points wide (because the window is centered on each data point, it must
be an odd number of data points wide). Note that
<code>moving-median</code> returns <code>NA</code> for data points at
the start and end of your data where the window extends beyond the
domain of your data.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>ex_dat_mrg <span class="ot">&lt;-</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">group_by</span>(ex_dat_mrg, Well, Bacteria_strain, Phage, noise),</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">smoothed5 =</span> </span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>           <span class="fu">smooth_data</span>(<span class="at">x =</span> Time, <span class="at">y =</span> Measurements,</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>                       <span class="at">sm_method =</span> <span class="st">&quot;moving-median&quot;</span>, <span class="at">window_width_n =</span> <span class="dv">5</span>),</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">smoothed9 =</span> </span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>           <span class="fu">smooth_data</span>(<span class="at">x =</span> Time, <span class="at">y =</span> Measurements,</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>                       <span class="at">sm_method =</span> <span class="st">&quot;moving-median&quot;</span>, <span class="at">window_width_n =</span> <span class="dv">9</span>))</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a><span class="co">#What does the smoothed data look like compared to the &#39;true&#39; noiseless data?</span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(ex_dat_mrg, Well <span class="sc">%in%</span> sample_wells),</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> Time, <span class="at">y =</span> Measurements, <span class="at">color =</span> noise)) <span class="sc">+</span></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.75</span>, <span class="at">size =</span> <span class="fl">0.75</span>) <span class="sc">+</span></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="fl">1.25</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="fu">aes</span>(<span class="at">y =</span> smoothed5)) <span class="sc">+</span></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Well, <span class="at">scales =</span> <span class="st">&quot;free_y&quot;</span>) <span class="sc">+</span></span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;window_width_n = 5&quot;</span>) <span class="sc">+</span></span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>()</span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Warning: Transformation introduced infinite values in continuous y-axis</span></span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Transformation introduced infinite values in continuous y-axis</span></span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Warning: Removed 8 rows containing missing values (`geom_line()`).</span></span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="co">#What does the smoothed data look like compared to the &#39;true&#39; noiseless data?</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(ex_dat_mrg, Well <span class="sc">%in%</span> sample_wells),</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> Time, <span class="at">y =</span> Measurements, <span class="at">color =</span> noise)) <span class="sc">+</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.75</span>, <span class="at">size =</span> <span class="fl">0.75</span>) <span class="sc">+</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="fl">1.25</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="fu">aes</span>(<span class="at">y =</span> smoothed9)) <span class="sc">+</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Well, <span class="at">scales =</span> <span class="st">&quot;free_y&quot;</span>) <span class="sc">+</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;window_width_n = 9&quot;</span>) <span class="sc">+</span></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>()</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Warning: Transformation introduced infinite values in continuous y-axis</span></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Warning: Transformation introduced infinite values in continuous y-axis</span></span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Warning: Removed 16 rows containing missing values (`geom_line()`).</span></span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Here we can see that <code>moving-median</code> has done a great job
excluded low-density noise, even with the smallest
<code>window_width_n = 5</code>. Additionally,
<code>moving-median</code> did not bias our larger data hardly at all,
except with the widest <code>window_width_n</code>. However, it has
produced a smoothed density that is fairly “jumpy”, something that wider
<code>window_width_n</code> did not fix. <strong>This is common with
moving-median</strong>, so often you may need to try other smoothing
methods or combining <code>moving-median</code> with other methods.</p>
</div>
<div id="smoothing-with-loess" class="section level2">
<h2>Smoothing with LOESS</h2>
<p>For <code>loess</code>, the tuning parameter is the <code>span</code>
argument. <code>loess</code> works by doing fits on subset windows of
the data centered at each data point. These fits can be linear
(<code>degree = 1</code>) or polynomial (typically
<code>degree = 2</code>). <code>span</code> is the width of the window,
as a fraction of all data points. For instance, with the default
<code>span</code> of 0.75, 75% of the data points are included in each
window. Thus, span values typically are between 0 and 1 (although see
<code>?loess</code> for use of <code>span</code> values greater than 1),
and larger values are more “smoothed”. Here, we’ll show
<code>loess</code> smoothing with spans of 0.15 and 0.35 and
<code>degree = 1</code>.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>ex_dat_mrg <span class="ot">&lt;-</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">group_by</span>(ex_dat_mrg, Well, Bacteria_strain, Phage, noise),</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">smoothed15 =</span> <span class="fu">smooth_data</span>(<span class="at">x =</span> Time, <span class="at">y =</span> Measurements,</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">sm_method =</span> <span class="st">&quot;loess&quot;</span>, <span class="at">span =</span> .<span class="dv">15</span>, <span class="at">degree =</span> <span class="dv">1</span>),</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">smoothed35 =</span> <span class="fu">smooth_data</span>(<span class="at">x =</span> Time, <span class="at">y =</span> Measurements,</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">sm_method =</span> <span class="st">&quot;loess&quot;</span>, <span class="at">span =</span> .<span class="dv">35</span>, <span class="at">degree =</span> <span class="dv">1</span>))</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a><span class="co">#What does the smoothed data look like compared to the &#39;true&#39; noiseless data?</span></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(ex_dat_mrg, Well <span class="sc">%in%</span> sample_wells),</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> Time, <span class="at">y =</span> Measurements, <span class="at">color =</span> noise)) <span class="sc">+</span></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.75</span>, <span class="at">size =</span> <span class="fl">0.75</span>) <span class="sc">+</span></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="fl">1.25</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="fu">aes</span>(<span class="at">y =</span> smoothed15)) <span class="sc">+</span></span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Well, <span class="at">scales =</span> <span class="st">&quot;free_y&quot;</span>) <span class="sc">+</span></span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;span = 0.15&quot;</span>) <span class="sc">+</span></span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>()</span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Warning: Transformation introduced infinite values in continuous y-axis</span></span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="co">#What does the smoothed data look like compared to the &#39;true&#39; noiseless data?</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(ex_dat_mrg, Well <span class="sc">%in%</span> sample_wells),</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> Time, <span class="at">y =</span> Measurements, <span class="at">color =</span> noise)) <span class="sc">+</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.75</span>, <span class="at">size =</span> <span class="fl">0.75</span>) <span class="sc">+</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="fl">1.25</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="fu">aes</span>(<span class="at">y =</span> smoothed35)) <span class="sc">+</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Well, <span class="at">scales =</span> <span class="st">&quot;free_y&quot;</span>) <span class="sc">+</span></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;span = 0.35&quot;</span>) <span class="sc">+</span></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>()</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Warning: Transformation introduced infinite values in continuous y-axis</span></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Warning in self$trans$transform(x): NaNs produced</span></span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Warning: Transformation introduced infinite values in continuous y-axis</span></span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Warning: Removed 8 rows containing missing values (`geom_line()`).</span></span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAABF1BMVEUAAAAAv8QBv8QCv8QEwMUHwMUIwcYPwscQw8gaGhodxMkexcogx8szMzM7ys4+ra5Az9NCrq9NTU1NsLFOsbJkpaVoaGhtn55woJ90nZx11dd4nJp5nJp5uLh52Nt6m5p6qal7m5l7np17oqF8fHx8mph8m5l8nJt8nZt8n519mph9vb1/3+GEnJqMjIyampqaoJ2coqCnp6eysrK6iIO7iYO9vb2+iYTHx8fJi4XKjIfQ0NDZ2dnaf3jbf3jhgHnh4eHoe3Ppe3Pp6enr6+vse3PsfHTweHDw8PDxeHDysKzy8vL0d2/1d2/1eG/1k431tK/2dm73dm73fXX3hX34dm34d274eXH4enH5f3b5h3/7urb///8o6+pGAAAACXBIWXMAAA7DAAAOwwHHb6hkAAASbklEQVR4nO2dDWObuBnHSRofzra2B93SFsa23FLnVpxkS2/tdcm2hnBt4uXW1R5ps/D9P8f0wouQBBIgDLj6t3WwGj+Wfn706JHAyIi1KmX0XYGhSwMSSAMSSAMSSAMSSAMSSAMSSAMSqH9A5weGcXyePf1xz9h7jY4MpJ5qlan3ClxhDu+Spz+iZ5DQOw0I6bVxGscnxqvk6Z5xHp8ZNjg6g//Rv9QAemXjfgE+8GPj4BIWnR8bhn2Kyi6P8RF+w1TJ82PoPO+M40Kl4H++Nn5UUreWUgLoNO0XhnECDuwr+PkjncIyOznCb0gBsg1cSpjDvnNinB0be+/inqUEEHCS+Bz2C8M4uIoPYPv24Of/DrYblb1GvYb/2vwR6xi70zHmeKmigi2kBJBtnJxha7C/XBp78Pjy7NUBBnQZUy5SqAAD6HQPETKMM9jPTlRUsIWUADoDnWgvx4AeD9KORBGguxgLCA5lRMhSUcEWUvT+7/YM+5xs7QmI2meX8oCKPTDHsimAYGdIu9OlcZA07IoDiNZecRSzjavkt5Povaeqgg2lKAadgzbiIB1fHcCkxgBFVwcSgE5hlDkxXmdPXyWRB5W9zv6jLykc5hEWGHrsrEgCUJIwp35zhXICGzoiOurbgRR1sVPbsGEuDLrYgXGCRmaQEB2cSwBCc7GD8+x3LsELsQWQXxqnV0rq10JqY2DvIVW9NCCBNCCBNCCBNq9FiqUBCaQBCaQBCaQBCaQBCaQC0Lm8OjNc07K8NCCBNCCBNCCBNCCBNCCBNCCBNCCBNCCBugG0W/ihBNAuUrlxBe3gqhNAu7j2u0oB5aTIH2MGtKvWgyj4m+BBnQDahC62m1ZfxyAsBhDVFO1Ba/GgzQGUxx8NCGs9gDYoBlWoM8M1LctLAxJIAxJIAxJIAxJIAxJIBaAwBH/D5JE45BS3MFxiPj1U0A6uegSUXRpt2zb7gzE8VEDiZkgDcqOCYZt4B5v+wRoeKCCJZogA+bNMBCE7VgfInQV9AZJpRhmgGSvKdqXlhw8fFusy5VcxQJYDibY2knQXK2/GQ97LOHRmbi3LMUX+4r3J86AI8+k/BtXzoAKYoDpIywEKomjFAYTfYQhBuhYgVGtPchSTBhSwgKBfer0G6UaAYLX5wbWeZdLC8mbJCdIJn5EBchM+MoCQIYk8KLhZckaxmTvzwyEAqmwGDcib7c+UZ9LBTcACcp/NvL7zIBlRJNz9mfqpRhBw8iCPiHMK2sGVekCeCzqYakDBWw6gubvvjhHQbD9Q70Ezz/NpQP5s/3p8gHzYw5QDcp+5nu9RgEAICkcBqCDwsSpL+/Ng47oeA8jzQQgaBaBCtd2nMzqWNvagTMCBYh+oUOi7zzqbgeVSDcizZpYyQFk09mA66Lte0YNcNxyfB3nf7/OmTO0A+dZvj2DIcUmTjvt0lIDcfc6UqS2gw6cr5EHk9M7zZovxAfKw36sFBMLzIQrVRUAgBI0QEHYg5YCCBFA2swgd4EHhAAARcy6bLODPxbyOALkgkUbmPcJXD/+36h8QMWu3baKgZDYPAAU0GnUeRAHy7gbgQTkIO5YBhOOCWkAOThEZQG48KEAxH1BxTdr3i+vylabFnTcdrvxrDqDksxg6IKhGHiTTeVNAKARRgKwns1F4EFQ+ZQKDPINGCKi882YeFDAe5IzLg6YJIDg7qu9BpZ0X/ec8n4OBo3l6aP36Q5P21pYSQOa3ZuJBnLXEpoDixIOA29wnvrJIFoXweBkOoYslITNrQUkehD3IV+pBcQ4oSGJQSAA6/ONqEIBklE2ZPG/ZiQfFabTJAIE8+nAYHiSjHBAYbroANA1pQKDw8xgBeZzV6LJEUaLzJlCs9yYL6PDjGLuYy0HTNpP2rMM3KwaQ5a1G50EeXANVD8h6Yt3RXWwOCoPxAEoEspSlOmtQiQfl6fPC8x0EyLOu3wajAZTNKd23HXgQHOYzO8m8FUS7xYg8KJ9TBl3EIM/9W8ACMsPxAUqWtdQBgpfdgZnGfXJ2J0DdGB75vvW+5Io81VLqQUsemjYeBOYwICVc4BfDfDr1IOvwh7GNYk4HHgTnMA4KN+jFQdbFrCePfzJHBmiSzClVxyAYo7MYZGJAjm95QTgMQHlemx7ZVDlux+SJ1RmgMB3FzEdWAsj7/HEYXYxc1kovNCuWx7gdjgV6gvouhgFldjIP8harXjwIPivcj5UBVFz+y9uBQkUXHuQ4DjEBxoDA4+ewD0AG/keUsR5EAUoX7cFofP1X1RdbYEDP39KJoueDqepIACXtcIAHHS25l8K38yCT40HwPNAq7AmQETcDBHpY9IZ7XUcZIInwD4b5RxNnYrKAFsH4AH3+eMtFUwJIJvwjD5o8CKYMoOu3/QzzBsWnlgdxLmSuA4gT/pMY9OaOAdSTB3GUr/tV5kEA0MuLaTsPYsM//DGfz+/yV6G5GHi4btjc+mKCNF0mIQTI+vDDhVJAceZBhB3gQQ5xqrWHGMSUSSgBxPsyhQJAz39DjGILH+SN+anW9QIy6H2JZAUBWe6nm7tOABU8KEwAMYbX6kF1hT3oetWNBznfUYBAvPNX/QBqrOncn32p+RqJ8I8AffeHFQPoy8d+EsW4YRczfzWZRVE9D5IyXOZB97e04YF3sW8cL6LOdKoD5FCAvP48qDGg2f5ssegI0PPMg+DQdY8ATXsZxZoDuoX3DOgIUPDzTRKD0HITAmTt7Ji9AGpIqFMPCoMV6UHoYunF1KQNr8mDmuZBc1DpsBNA20FxlRIDumUMD3qY7wxQHG9f3NwUl+Hgt6Kiu9umda3d3tqL9sWkBWmtHrQAb9WfB+FdG4kCzqIEuXiTtqM7QIydxSKNdv2MYqIFs+LiTdqOzgDdFe5HAULz9Ojo5SKaSgMyYiPdhTJb7DKKRdVqCCjrYnjRHp5Al262vMJVhO7YkUAwH5nmzosXL6ObSHoUS6kYefuIQ4mY1BYQakc4dxy6wl15kFnXg2IuoHhDAPHsLHiGawBKz/zJpTS8ySpRMERA/IKq9tH9il17L1fdU8/qAEkkEJ0Bok//Vaj2oj0/D6oPSCaB6AZQiyDddD1IJSC7woNuo2W0BH+36gNSNsw3UfVHXNeDiASCep/bKBEgtDYNFxBtuJkHtdaoADWIQa2lYj2okZoAMk1z2jOgRkG6kaQSiKKmO1tbO2u6+jeTii7WTDIJxADUH6CRaMMB/YuvGhZ6C9LrkWJADRftByzVHrRxGgagAe+KoDwG0Yv2qtvRmeESy6pjELOiqLodnRkusawBaUAakBrDJZYFgAzisUSCRXvV7ejMcIllESDxsuvGD/P/SfUlPSh4ELEMy7egYi42CkBf/vulAlB5ZOkCUDf7rBaN7srt9Sz0IOJMhwSghoQYQFmbVAIqGGX34ORbkAjSRh0PajZZLQHUyWbYu+d9AmqoMg/qZiNa1YBiY/2A0gChOgZ1A6jOKKa0i43AgyTEgdE6Udx0QK2nGhpQRTvWBEg+DxoioAp1ZrjEsmJADdfsvx5ADaUBqWtHZ4ZLLKsGhFOmeq34mgARc/+O2tGZ4RLLwwDU6AKq2oYbXUClHlBh1sa7EKXFXs8bB8jmAKKvdmLaUQ7IrA2IUe07OCkP0gU+1BfZs8u/GgAy6b2wpUTbubhhb1e9Vg+iRSIpAVS21zMhN98svCYhCpAZREulgCTO+sgDsm3kSbU9yCU2fW7rQcvohtm2o5UHSZwFrLyIMw3HdrkHMe0oNinD4ysI0qubZf0u9rtUk/SAAyi/9L4akEGN8sWLThsAwruoEwWtAAU/l+9PKgQ0+eWEBUSeGCvxJ/EwX2BRDxDGUzLMM0Ok8Ns+Ae8+lq08KF2VjinPqAWokPLUyoPQTvBleRCTQwi/7RP8/rn6PCjtWkbZwnSHmXTChw+IziEkvu3jwq3TuwFUwoMtaDZZ5QNyEz6VXYzoqqJv+1juvkvttCqWPCCpGNRQXEAe4MMWExIBogw7aLde8uZc6jxIehRTKH/mCvZiI3IIMsMqA+Qd7n8Ok/2MQ+lvPQsBCcXkQQ2YcT5Rf0ZtiV3hQcTzKkBwE/LkZrfpblRrB1R5DrZcHBIgAAWygKS6mIe2Bsf3UezPg5QB8twZtSV2WR5E7nRYlQd5Hopo6D6KKmOQUJ0AcnB/qAYkb9hEO/Yhi6vBAZLId1lAgE8UKgNkPprCu5N+AoBWb773YB/rCxDnzgsS+S4LCHSwlTpA0IPgDrfg2PzpCN7jXh5Qe1V3J6l8lwGURKD2gDL5Puhh8GAa+7WTxXYSxRuJfJdeMPPBGK/m7vYZV887TO6FFw/Lg6QGY9qDQDwtXfirJwKQ+5OZAXKGB6gy36UBWdCBFANyn10kdhbFXefXCCi/WzIzilXnuxQgMKnk7LbaCtAc7S2fOqjVEyD+NL5+FwMhunzhr57Sl/ne7J/ZfmvWE6u3LsaZzUrku0VAPuxhagE5vvt0mffg3jwIP2/wld60lmiGBHrYMpQBVJaCMtupgwmYFWUb0plPLM/pN0g3uWU7rCSaYztgjF/JACpLQcnVbszc8XwwyGd2QKrYJ6C2HuR9j2YZQkClKWgcE4Awc8+//jnfZ2TRI6D2X5mf+yBEy/1qafiPs3O2MHNG26l/IWze4z3V13WTE9EoJiP0MeIgAcbjT9xNtEpiEBdQMQbBW9j/QNyAHCZCczCDXfsWfvw8SEawfrjCDsjolmEdQJwUlAX0YrlN2FlAQOHothFFFQZzpohGI/Qg4jlvRdHzrIj0IATI6XMUq628lt7h/r+DuoCoLkYlWHD3zb8uQxoQc9c9Be3gSikgx7NmF7U8iE1Bs2sl4nxvQMIrwUi5WEBAzkAASaRzOSAQov/OXJ/SMpMG0KP3mQeZ700AaBEPBpBMOpclinPuQkc7QI5jza5zD1q9WaWAnCEAkkrnEkDmLywQoleqAXneUUTYuYNdbHEP9yNxBgBIKp1LVhTn3/h+dHOhuH7fWI8jOie8v79HG7Mpfiu+mgOiY5Dj+B/+sWR9p5UHTR88nn2i768NPSgclgdVpnNJPgenTBEHTStA8wnwIDPmA5oPB1DxOW/BDG60eh3drBQD+tNsFh2RdmBKvTi6N81wMpmbMDs1t82t7QEAKk/nUkCLL9GtYg9aoWuHCQ/angJCR39+ubOz/eDB1oMdM5xuQW33nAdVpnN4NAaAPtxcqO5iFR5kTuYT7EGTra3BZ9KQz3V0wUPTLgYBu8w+IygGgSg0x/MNPOIraAdX6gBdR8tlHUBSS67EjiZlgJKcUUE7uFIDaA4nBBF/oaMEkNySqwCQgx6coU9WYdZmwTup13iF3JJrOH9MAbpdLtMbt0f5V0CiYNCA0Ad9FNXbiFZuyXXLelzYEye7rT1BCB2q3uo+kxpA+6Ca1BJoc0CFGMTzoIIP4YOBe9A+rOjSbAKIl6OLYhC3QEE7uFICyNmH6VxTDyKejxCQ1IKZM4fZipouJjGKDQmQ3IJZc0Ccs/7iPGhAgGQXzI4WL7vZoW7ogCQXzKZ/eXG03UHlRg2osGgPPKi0BV+FB1UOxqCK9zAEqQfU2eaJNdR4wWwdgMbjQTHdxajTPp0BgtuqjgBQ9WD8dQOSkQYkkAYkkAYkFDrXWVNls7ziOe2NANTIg0q/aFVYD/p6AVXM8jYQ0OJ+Ud6CshhUfkoSF+CrIpp0XqUaLqBYe1DMm+XZIwvSEmNNWw8inttx4aT2CADJjDWKu9ioPEhqrGkDiPdFqzEBkhprRHfBa64KHqMBBFXdgnZTjZEAqhxrNCDBWNMdIL7gRa/b4GE6BYfT7Wm3X4xScZUriETcw7LiGuJYm347jR9ub02nOzvb325vPex4f+ymK4r9AVJjWFpqljs0IIE0oK9XGpBAGpBAGpBAGpBArQHZ2TzEzu5aTov4peQl0pZJa6oM11JbQDZe+EgriB/QH/xg28Qvxex5/SrL6Z84e0zNIChNDdeTgi6WVjFtBgkobg4oLr4+LgKiSwYPKOtmyjwoBZT2ptRM1u2aG64jFYDSf7TrJA1sDijtuwXXSUtbGK4jlYDiLgAl7zBiQDYXkK0CUMwBZMcjA5QNJ2zwaQkoHRPHDYhISLLYWZbA1EtX7NxMzJgZTx608dKABNKABNKABNKABNKABOoFUH67veF/Pr3VcPhosDQggXoGhDaqwBvmZPsPDQvdAAChrTyS/TyMXuvE0wAAZc80IPaNGUBN7iXbqYYGqK/qlEoDEmiIgAZFaWCA9DA/OmlAAmlAAmlAAmlAAmlAAmlAAmlAAmlAAmlAAv0fZ3AEKw1zzx4AAAAASUVORK5CYII=" /><!-- --></p>
<p>Here we can see that <code>loess</code> with smaller spans have
smoothed the data somewhat but are still sensitive to outliers. However,
<code>loess</code> with a larger span has introduced significant bias.
To fix this, we might explore other smoothing methods, or combining
<code>loess</code> with other smoothing methods.</p>
</div>
<div id="smoothing-with-gam" class="section level2">
<h2>Smoothing with GAM</h2>
<p>For <code>gam</code>, the primary tuning parameter is the
<code>k</code> argument. <code>gam</code> works by doing fits on subsets
of the data and linking these fits together. <code>k</code> determines
how many link points (“knots”) it can use. If not specified, the default
<code>k</code> value for smoothing a time series is 10, with
<strong>smaller values being more “smoothed”</strong> (note this is
opposite the trend with other smoothing methods). However,
<strong>unlike earlier methods, <code>k</code> values that are too large
are also problematic</strong>, as they will tend to ‘overfit’ the data.
<code>k</code> cannot be larger than the number of data points, and
should usually be substantially smaller than that. Also note that
<strong><code>gam</code> can sometimes create artifacts</strong>,
especially oscillations in your density and derivatives. You should
check that <code>gam</code> is not doing so before carrying on with your
analyses. Here, we’ll show <code>gam</code> smoothing with
<code>k</code> values of 8 and 15.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>ex_dat_mrg <span class="ot">&lt;-</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">group_by</span>(ex_dat_mrg, Well, Bacteria_strain, Phage, noise),</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">smoothed15 =</span> <span class="fu">smooth_data</span>(<span class="at">x =</span> Time, <span class="at">y =</span> Measurements,</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">sm_method =</span> <span class="st">&quot;gam&quot;</span>, <span class="at">k =</span> <span class="dv">15</span>),</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">smoothed8 =</span> <span class="fu">smooth_data</span>(<span class="at">x =</span> Time, <span class="at">y =</span> Measurements,</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">sm_method =</span> <span class="st">&quot;gam&quot;</span>, <span class="at">k =</span> <span class="dv">8</span>))</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a><span class="co">#What does the smoothed data look like compared to the &#39;true&#39; noiseless data?</span></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(ex_dat_mrg, Well <span class="sc">%in%</span> sample_wells),</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> Time, <span class="at">y =</span> Measurements, <span class="at">color =</span> noise)) <span class="sc">+</span></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.75</span>, <span class="at">size =</span> <span class="fl">0.75</span>) <span class="sc">+</span></span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="fl">1.25</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="fu">aes</span>(<span class="at">y =</span> smoothed15)) <span class="sc">+</span></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Well, <span class="at">scales =</span> <span class="st">&quot;free_y&quot;</span>) <span class="sc">+</span></span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;k = 15&quot;</span>) <span class="sc">+</span></span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>()</span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Warning: Transformation introduced infinite values in continuous y-axis</span></span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Warning in self$trans$transform(x): NaNs produced</span></span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Warning: Transformation introduced infinite values in continuous y-axis</span></span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Warning: Removed 1 row containing missing values (`geom_line()`).</span></span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="co">#What does the smoothed data look like compared to the &#39;true&#39; noiseless data?</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(ex_dat_mrg, Well <span class="sc">%in%</span> sample_wells),</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> Time, <span class="at">y =</span> Measurements, <span class="at">color =</span> noise)) <span class="sc">+</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.75</span>, <span class="at">size =</span> <span class="fl">0.75</span>) <span class="sc">+</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="fl">1.25</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="fu">aes</span>(<span class="at">y =</span> smoothed8)) <span class="sc">+</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Well, <span class="at">scales =</span> <span class="st">&quot;free_y&quot;</span>) <span class="sc">+</span></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;k = 8&quot;</span>) <span class="sc">+</span></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>()</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Warning: Transformation introduced infinite values in continuous y-axis</span></span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Warning in self$trans$transform(x): NaNs produced</span></span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Warning: Transformation introduced infinite values in continuous y-axis</span></span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Warning: Removed 2 rows containing missing values (`geom_line()`).</span></span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Here we can see that <code>gam</code> does alright when working with
the no phage-added wells (A1 and F1): higher <code>k</code> values have
smoothed the data but are still sensitive to those early outliers, while
lower <code>k</code> values have introduced significant bias. However,
<code>gam</code> is struggling when phage have been added (E11 and F10).
Across both the <code>k</code> values it has added many fluctuations and
often dips into values of 0 or lower (plotted here as breaks in the
line, since the log of numbers &lt;= 0 are undefined). To fix this, we
might explore other smoothing methods or combining <code>gam</code> with
other smoothing methods.</p>
</div>
<div id="combining-multiple-smoothing-methods" class="section level2">
<h2>Combining multiple smoothing methods</h2>
<p>Often, combining multiple smoothing methods can provide improved
results. For instance, <code>moving-median</code> is particularly good
at removing outliers, but not very good at producing continuously smooth
data. In contrast, <code>moving-average</code>, <code>loess</code>, and
<code>gam</code> work better at producing continuously smooth data, but
aren’t as good at removing outliers. Here’s an example using the
strengths of both <code>moving-median</code> and
<code>moving-average</code>. (Note that earlier columns created in
<code>mutate</code> are available during creation of later columns, so
both can be done in one step):</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>ex_dat_mrg <span class="ot">&lt;-</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">group_by</span>(ex_dat_mrg, Well, Bacteria_strain, Phage, noise),</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">smoothed_med3 =</span> </span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>           <span class="fu">smooth_data</span>(<span class="at">x =</span> Time, <span class="at">y =</span> Measurements,</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>                       <span class="at">sm_method =</span> <span class="st">&quot;moving-median&quot;</span>, <span class="at">window_width_n =</span> <span class="dv">3</span>),</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>         <span class="co">#Note that for the second round, we&#39;re using the </span></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>         <span class="co">#first smoothing as the input y</span></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">smoothed =</span> </span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>           <span class="fu">smooth_data</span>(<span class="at">x =</span> Time, <span class="at">y =</span> smoothed_med3,</span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>                       <span class="at">sm_method =</span> <span class="st">&quot;moving-average&quot;</span>, <span class="at">window_width_n =</span> <span class="dv">3</span>))</span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a><span class="co">#What does the smoothed data look like compared to the &#39;true&#39; noiseless data?</span></span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(ex_dat_mrg, Well <span class="sc">%in%</span> sample_wells),</span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> Time, <span class="at">y =</span> Measurements, <span class="at">color =</span> noise)) <span class="sc">+</span></span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.75</span>, <span class="at">size =</span> <span class="fl">0.75</span>) <span class="sc">+</span></span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="fl">1.25</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="fu">aes</span>(<span class="at">y =</span> smoothed)) <span class="sc">+</span></span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Well, <span class="at">scales =</span> <span class="st">&quot;free_y&quot;</span>) <span class="sc">+</span></span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;median then average smoothing&quot;</span>) <span class="sc">+</span></span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>()</span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Warning: Transformation introduced infinite values in continuous y-axis</span></span>
<span id="cb19-21"><a href="#cb19-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Transformation introduced infinite values in continuous y-axis</span></span>
<span id="cb19-22"><a href="#cb19-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Warning: Removed 8 rows containing missing values (`geom_line()`).</span></span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Here we can see that the combination of minimal
<code>moving-median</code> and <code>moving-average</code> smoothing has
produced a curve that has most of the noise removed with minimal
introduction of bias. (Note that the first and last 2 data points are
now <code>NA</code> because of the smoothing)</p>
</div>
</div>
<div id="DerivsOfSmoothed" class="section level1">
<h1>Calculating derivatives of smoothed data</h1>
<p>Once you’ve smoothed your data, you can calculate derivatives using
the smoothed data. Combining smoothing of raw data and fitting using
multiple points for calculating derivatives can be a powerful
combination for reducing the effects of noise while minimizing the
introduction of bias.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Note here that we&#39;re calculating derivatives of the smoothed column generated</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="co"># in the previous section by combining moving median and moving average smoothing</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>ex_dat_mrg <span class="ot">&lt;-</span> </span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">group_by</span>(ex_dat_mrg, Well, Bacteria_strain, Phage, noise),</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">deriv_raw =</span> <span class="fu">calc_deriv</span>(<span class="at">x =</span> Time, <span class="at">y =</span> Measurements, <span class="at">x_scale =</span> <span class="dv">3600</span>),</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">deriv_percap_raw =</span> <span class="fu">calc_deriv</span>(<span class="at">x =</span> Time, <span class="at">y =</span> Measurements,</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">x_scale =</span> <span class="dv">3600</span>, <span class="at">percapita =</span> <span class="cn">TRUE</span>,</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">blank =</span> <span class="dv">0</span>),</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">deriv =</span> <span class="fu">calc_deriv</span>(<span class="at">x =</span> Time, <span class="at">y =</span> smoothed, <span class="at">x_scale =</span> <span class="dv">3600</span>),</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">deriv_percap =</span> <span class="fu">calc_deriv</span>(<span class="at">x =</span> Time, <span class="at">y =</span> smoothed, <span class="at">x_scale =</span> <span class="dv">3600</span>,</span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">percapita =</span> <span class="cn">TRUE</span>, <span class="at">blank =</span> <span class="dv">0</span>),</span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>         <span class="at">deriv3 =</span> <span class="fu">calc_deriv</span>(<span class="at">x =</span> Time, <span class="at">y =</span> smoothed, <span class="at">x_scale =</span> <span class="dv">3600</span>,</span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>                            <span class="at">window_width_n =</span> <span class="dv">3</span>),</span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a>         <span class="at">deriv_percap3 =</span> <span class="fu">calc_deriv</span>(<span class="at">x =</span> Time, <span class="at">y =</span> smoothed, <span class="at">x_scale =</span> <span class="dv">3600</span>,</span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">percapita =</span> <span class="cn">TRUE</span>, <span class="at">blank =</span> <span class="dv">0</span>,</span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">window_width_n =</span> <span class="dv">3</span>))</span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a><span class="co">#Plot derivative of smoothed data</span></span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(ex_dat_mrg, Well <span class="sc">%in%</span> sample_wells),</span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> Time, <span class="at">y =</span> deriv_raw, <span class="at">color =</span> noise)) <span class="sc">+</span></span>
<span id="cb20-21"><a href="#cb20-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.75</span>, <span class="at">size =</span> <span class="fl">0.75</span>) <span class="sc">+</span></span>
<span id="cb20-22"><a href="#cb20-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="fl">1.25</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="fu">aes</span>(<span class="at">y =</span> deriv)) <span class="sc">+</span></span>
<span id="cb20-23"><a href="#cb20-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Well, <span class="at">scales =</span> <span class="st">&quot;free_y&quot;</span>) <span class="sc">+</span></span>
<span id="cb20-24"><a href="#cb20-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;smoothed raw data&quot;</span>)</span>
<span id="cb20-25"><a href="#cb20-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Warning: Removed 8 rows containing missing values (`geom_point()`).</span></span>
<span id="cb20-26"><a href="#cb20-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Warning: Removed 10 rows containing missing values (`geom_line()`).</span></span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="co">#Plot derivative of smoothed data with smoothing during calc_deriv</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(ex_dat_mrg, Well <span class="sc">%in%</span> sample_wells),</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> Time, <span class="at">y =</span> deriv_raw, <span class="at">color =</span> noise)) <span class="sc">+</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.75</span>, <span class="at">size =</span> <span class="fl">0.75</span>) <span class="sc">+</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="fl">1.25</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="fu">aes</span>(<span class="at">y =</span> deriv3)) <span class="sc">+</span></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Well, <span class="at">scales =</span> <span class="st">&quot;free_y&quot;</span>) <span class="sc">+</span></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;smoothed data and calc_deriv window_width_n = 3&quot;</span>)</span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Warning: Removed 8 rows containing missing values (`geom_point()`).</span></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Warning: Removed 12 rows containing missing values (`geom_line()`).</span></span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="co">#Plot per-capita derivative of smoothed data</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(ex_dat_mrg, Well <span class="sc">%in%</span> sample_wells),</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> Time, <span class="at">y =</span> deriv_percap_raw, <span class="at">color =</span> noise)) <span class="sc">+</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.75</span>, <span class="at">size =</span> <span class="fl">0.75</span>) <span class="sc">+</span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="fl">1.25</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="fu">aes</span>(<span class="at">y =</span> deriv_percap)) <span class="sc">+</span></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Well, <span class="at">scales =</span> <span class="st">&quot;free_y&quot;</span>) <span class="sc">+</span></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;smoothed raw data&quot;</span>) <span class="sc">+</span></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="cn">NA</span>, <span class="dv">10</span>)</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Warning: Removed 22 rows containing missing values (`geom_point()`).</span></span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Warning: Removed 10 rows containing missing values (`geom_line()`).</span></span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAA9lBMVEUAAAAAv8QBv8QCv8QEwMUHwMUIwcYPwscQw8gaGhodxMkexcogx8szMzM7ys4+ra4/ra9Az9NCrq9NTU1NsLFfpKRoaGhsn55tn55woJ90nZx11dd2nZx4nJp5nJp5uLh52Nt6m5p6qal7m5l7np17oqF8fHx8m5l8nJp8nJt8nZt8n518o6J9rKt9vb1/3+GMjIyampqnp6eysrK9vb2+iYTHx8fJi4XKjIfQ0NDZ2dnh4eHoe3Ppe3Pp6enr6+vse3PsfHTw8PDxeHDysKzy8vL1k431tK/3dm73fXX3hX34dm34d274eXH4enH5f3b7urb///+iSW2RAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAQTUlEQVR4nO2dCWOcuBXHiROCnW693SFxk6GEtjMxy3o74yPr1k7HbJ009XTSbPT9v0x1cAgQPA6Jw6N/4hkO8ZB+8yTEpWcgrUoZQ2dg7NKAAGlAgDQgQBoQIA0IkAYESAMCpBDQe5vYL91B+ZpaG1DrPUghIFogZYAab95SGhC016YbXNnGyXtEM3hunKO7E+P8Hs/eXRjGxR3ipgyDlAH/XRr2JVlxT1bc0ySneMukhIbxwT5F6PbcIAlvjAu87Na4wZ/n9DOzQZQqsp7MqlNTQJckZ8Z7kkOcN+P6BH9c4MLbZLF9z03FgEgyg5SBrjhBUZJzDtApNnFDDeOEhk13c4lSL0k3SFMZmVl1au7nd/jntcnEBbomebsmOb00sA+ckpymU1EVO71HV2SDK7b2PUtyf8oBIgU8Ma4R+oAXXhgfCEybzF2wFOkGSSpmPZ1Vpqa2beOCuT0hhT/uWVZPyNwd8Y90KgJ0h+IkdLPzJEkKiFZNdHdzRSDcGFf4J7g0btH7uIbxG0SpYu+KZ5Wpqe0b7O0ncZnTD5ZHwRQ/y8QvQ9zEabL6FLvMPXar82wK+nmaNZLMKlNz2x9ODPtWPqAL3PbfUC+5MO7tc3RuU2/jUrB1cSq6LJ1Vpja232eLD1QxlCSJty9UseTznrW8V7hpuca17LqwQZoqtX4/KkA2bhs+sEYacR8VjTRKkuBl12TtFWm4TwuAbuOW2yCtEi62cR+lSDdIU0Upb/nmXoXaHeav8oAEh3m83OYBsRXkEFU4zKeG44qDiNucxjtNN7jk6qmd2UiVGtu+xEfgK5QHJOgo4pqYAURXnN7SJOfZjiL9omvp9A097l8lNYzfIElFrXMbqZJK249CGhAgDQiQBgRIAwKkAQHSgABpQIA0IEAaEKCGgG67aSDTXaQBAdKAAGlAgDQgQBoQIA0IkAYESAMCJA/QUeZLEqAjqjrmu0CokjRARyzvR5IBpaT4r+kCOpLtQRnrVea7QKiSbA9SBGj6Vewozrxug0oA5QoiC1B+arqAbtV40GMBlLY/GlC/gB5NG1RPA5nuIg0IkAYESAMCpAEB0oAAVQJibxzZdvrmURiG5C8UfJeu4BI0Nm0dHzx7Zh0eW+AuZELhVQWI5d5OilNWihaAapu2QssKkQXvQjaYWBWAbFRaCqsjoArTgIUxAUK5Uvweiy0//OGw637LTI9ODQARSfKgCtMT9iCgFBoQUAoNCCjF3gIatB80ckBFSQPUyLQGBJjWgADTGhBnWtTF0oBS0xY5L9WAKkxrD2phekKA9k/agwBNEJC4Fe8CoUrTA0SOcxpQ1S60B+k2qKlpDQgwrQEBpjUgwPTIAdncdT/JgGqaHjsgblo2oHqmxw0oMySoXEB1TY8cUFwN5N/+VGhamup5kKI2aPK3fTIlgUrR8iimAT16QIJ6YEkCVLOKWciy8D634cEoARVvf9IL67L6QVnToi3pU2YHx5vP/7QOBgYEDycn14MEpp06HmQN50HQoITV5e8OyHEceBfW8eFggOiiCkSjADSkB0HVbFhAzuCNNDjq56CAHGc9MCD4kNYPIEETwwCdOcMCGtSDqNZY6HnJQ7Trs7+d4c/aZZOihm2QQsUehDWv8CDqY8N2FOGj2JZk6jD3eoCUKrY0l87M/9nnt3Tib2e5XjoDA6rVD9p+xoSsZ88s6YC2rxavXN/13/rplphIBGj5V//dkiAafU+aeNBWlQcFC3/l+6YAkBOsguCdPyAgWEmmtp9/K5a/OyBn7vmLYIWdKAOIHLw+OZ638nwsR9Qf6gKhSoWjWHUlY5lxnG24Rf7WtELJgOZv/Ne+efjSD3hAa+w0nz55GBCufFiuoD8khYZA+X6QUe1U7Gd2lq929Lf03Y+WXA9yvcB00Cx47QsBeb7p+gvfHxRQFaEIkIl/5599JlcmIAzBIzVohilkADkeAfQtcMynM7LXcQPynJn70v3D91lEEgB9igGFru9vsoCIvn7eOiZurHEb5Q4ESFDH8le1WF5nrmVZuEowRlWPXlYAypn+9onyIYBwW+27BUDftmTedFZRNeu/kUbFY33huijNqjf/x4ZlbsW8yG8BKG+aA0QJ+XlA1JT1wlp7nO9aAx/m86X4gt07CObOJim2G7mRS/8H8UTyn349PMCAdr4XLON+D2awwAfLHbb3E7U6WyzZWSx9wsz1k51uHvqsYgXl3pv88kDz9Zc5n2blx/kt1W73AJrGyX788Sw+G125b2e/7TgTC/9f3FnsKtnl7qFoWpoaACLCvx9mMd8u5/ka5BUcp7kH+Qtnu01PtTzXC//nJx5kLrb56yAravvX3jxISChfirXjlDUxrAJEpbBQ8VykmengdRDiVslhfVP+HCwLyurxXEzQky400gCgDo10DtDs7SwDKFphhdYPxYEG5KOJmIAperw3nwPkzTzScwyzgMhduWHvauQXK3klU2g6D2jlUQei87wHjeBsvsyxJAPKmV47ZimgsOp2x94AMl/wN20xIC8FBOyiI4dSjQtQ1oNCCqjmLjpyKNXIAGUPkATQjM7Tm/N0hfC5gPqAGt+SGBWg50VAs5ekTbbI4x20cRY/WbInHlTo3ijwoMYaE6BC92bldm6DjPhmaNQBNtJJ8BZOJYlRyH3jrlaZJY3HLYqpMCL5yRrlF120r0ge/2qCzpoED8pvgT0oyHhQPJhZEw8SA0KtABmCZcJSiN76U1HFvOBdkLFQPthbfUDxJcF6MWzbAVLjQayRtnhAOQ9q0wYVAaUVr4ZaAhKXvyMg6kG8c65ct3sjLQIE3t4qMMmZqyqFQkB559wsFm7OggRAHRppI1V5KUqeblLRSKONSztAh2GJyfqA+jrMC3pzKgGFtAt9EO+yBaDOav7wQp8eFIZdPaizWj280COg2ruQQkOgNg8v7DugcZ9+9C0NCFCNhxf2W/DDC5PWv8VqYOEx0RBIAwIkG1C905MJSTIg+Gx+alERNCANSAOaEiD4Mu2+AwL1yAAZMANRFdsjQHC/5tED+k+sr/FExoO4y7A1AMGEpgvo63+/VgAqv4ghvGjfohSq4qxmzR41jfUMehB3kbAGIFjlgJISyQWUMVsVhbMMENhIG70CUhQM++h2JIBo9WrVDzoqTMgEdKsQEDIatEHgJddyQHHzIL8NUg2owVGsC6DChBxAmQnpgGpIA9KAJALqcLLaC6A2/SC5gEBVlb6GejetAfUMSF8PqgakryhqQBqQUkD5G4cjCgIZvcRivjDp2KXHFvk4+O5J8oJZL4ByD3GOIRh28s1AOCZ5H4i+UE2ezXuevmDWC6CsGkasbgKodTBsNoxgsoB7waxnQAaKC6AoYnVL02QUwfLZonoFRCTJg1pH6pXrQTXu+uw3oDoPHD56QH+OZcYTAkDpo/f7C8j8nVkExN8YK/EnGNA4+kGdAQk9iOv5lV2Mr3U/MZU0QI1MKzzMx1XLKLswrQFlS1u3irUoxcQB1WqD6o7l+tgANTiKDTxke/k7u6oAgSq6VCUitYAq3voeD6BqRGoBaQ9qkDGxBj9ZHfBNllqIB/agJkexQnSUIY5i3HwvgGAlmSvG1xkloO4y+Cn4EbxwYh7UXdPuSfcNCKalAQHac0AwoT0H1KSR3ktAsCQDahwMe5SAVEYL56YnAUj4nLS6aOHNg2EP3QaJrqqpjBbeOBh2/uwUPFvtrBqAFEYLRx1v+4zGg0YT63mMgOqWYh8AlT7E2We8efGI7NEKAoQOD5wCsvoEJFK+FDLHMBPcWRUN8snAkRUECBn0P7547Tjm8dCha3KlUD4K3mg9CB5EEQ0wCl7OwuBtUHFR7VL0AWg9/FGssKx2KTQgoBQaULYUhVCe8gCJwsmPA1D9EckFoc27Akp0WBILG0WxsnMLatlsr7bXg+QDqutBmRA2o7geJJT8n46WN7S2VYjHDyjO3EaJB60d89dftukWh7kwGtMBtPn7XA0gh/cg3GnPBmKZDqCMB1nAQyuNADkkFjlijlPwIBpPlMYZc8YNyGGNdFSKfOD5joC2n7dow05Gc07qRICc9KmOcQIieTSXa+b+Cjxo+9vn+dYKLXPtZCxMCZD5p1dnrL1I3F0aoOCXL67/RxbUlr0PNkFAxIOWuDLgahZnVg4gEg8K00nj2rqVgMKk0e4CoUrtAJGAzGe+vwxd98mZ6Vi0lsFPGEIXzNYsovP3/mt/5ieQ0r5pDMgZOyAasvonXAR34UeVAf9//uJJQ0DFMKJeFIkcuyhuhJ6TKNKLjRCQMx5AheuirBirwJ1lwzlTTq4IkFUPEIlY7AZBsDLZS7y4efMC91O42ZFQxklM4yDa1273dddvMGyhilfW2c+88jz/rb/78jEJ6cyTIjHDaQNLrjDHx7tSQGkwbKIvG3y6Sk9YD9F6tVptdr5Yu92u32DYQuUBPWAiQeB7vuktF/igTI4kpmU+/T4KpJ4j9bZJMGxsYr7dbuPWjFybn3le+NEXepCPPWg3Ig9iP/PDQ1T4+WL+CwtvTk9b8dThd08Qct2iR4Hh1IlCQZxt3A69nHnhNxptNelJp0czrhbLwVFUcw9a4LJvlzvHN51t5kQJhWmPmhzWvsV1rbYHiQKRzzyXxBkLs4DCEQOKjiBOvjRV/aD4nBMwLbRAAh2WAHJGCSjuvTYBFIob6VqvZHouPh44jx1QKAbEK2SVtBBnlh4wU0D0TJmeMI8FkKAfFGYBSTtZRXTYEhGgMAWUrBgNIF5x5iwOkAW85SXDg6IFkwHEHiSIMyfPg0RbEkCzkP0qESCLds4jQBab7wKhSu09SFB+VYBoRGzyqzBA5EUaPMMAWWQoocNxARLXKHWAZhPzoOTMqidAM9KZZppIG6TGg1BJqOvVarb6Fk1n7sapv6tK1P5Je/kv1FnPhM29F6xiC+P3oFQVd9DbqRSQ/+6n6QBS6kHih9c2b3yxB2WfD+gCoUoTeOPQdTOA0p7kvgLKP+X68c3HqIdN702n5yIjBiS6iSELECaQ2/Ij7lk8oX2L56YTRrGN8axprtM8dIFQpVaA6K+YH2hDmQeR74PjA7Lm6VM2ECd9qoEGyk7y0AVClcbnQeLv6DmA6D4A8yDLQiP1oLLyKwQE7qILhCppQICadxTz74wV3iEDEwxhurU0IEAaECANCNBwAypNRBoQIA0IkAYESAMC1BSQHY8zEH3bvFB+KpOc++rbdAc1BGRH/5IBodmfzQJBxF92uiBKnqZDZcVQaLqLGgNCabZQIftcKaJUTQApM91FrQFF1SCpGbnCsATtAEk33UVtAMV5Kf6+fCloSZoCUmO6i9oCimZKC4NQa0DyTXdRqyqWzohKYXcApMZ0FzUHlIlbJKoH3DGmISBVpruoVT+I1Qabm89+xcuTLz75EKY7SPekAWlAgDQgQBoQIA0IkAYEqEdA6QBXU/pVes7rlNAwaUCABgFEB7RkA+smUYfGim4wQHTIz2jcT3BsuQE1nAeh9EMDyu2uAAgaGWxAjQNQv5loJA0I0HgAjZTSKADpw/yEpQEB0oAAaUCANCBAGhAgDQiQBgRIAwKkAQH6P73b+sqUnO/0AAAAAElFTkSuQmCC" /><!-- --></p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="co">#Plot per-capita derivative of smoothed data with smoothing during calc_deriv</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(ex_dat_mrg, Well <span class="sc">%in%</span> sample_wells),</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> Time, <span class="at">y =</span> deriv_percap_raw, <span class="at">color =</span> noise)) <span class="sc">+</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.75</span>, <span class="at">size =</span> <span class="fl">0.75</span>) <span class="sc">+</span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="fl">1.25</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="fu">aes</span>(<span class="at">y =</span> deriv_percap3)) <span class="sc">+</span></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Well, <span class="at">scales =</span> <span class="st">&quot;free_y&quot;</span>) <span class="sc">+</span></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;smoothed data and calc_deriv window_width_n = 3&quot;</span>) <span class="sc">+</span></span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="cn">NA</span>, <span class="dv">10</span>)</span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Warning: Removed 22 rows containing missing values (`geom_point()`).</span></span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Warning: Removed 12 rows containing missing values (`geom_line()`).</span></span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Here we can see that smoothing our raw data has improved our
derivatives dramatically. On top of that, the combination of smoothing
raw data points and smoothing during derivative calculations can even
further lead to less noisy derivatives. However, our per-capita
derivatives are still somewhat noisy in some cases (like Well F10). In
the next section, we’ll discuss a final strategy for dealing with this
sort of per-capita derivative specific noise.</p>
</div>
<div id="SubsetAnalysis" class="section level1">
<h1>Summarizing on subsets of derivatives</h1>
<p>There is one final strategy we can employ when dealing with noisy
data: since noise often has relatively stronger effects when densities
are near 0, we can simply exclude data points where the density is near
0.</p>
<p>Let’s look again at our smoothed per-capita growth rates:</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Plot per-capita derivative of smoothed data with smoothing during calc_deriv</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(ex_dat_mrg, Well <span class="sc">%in%</span> sample_wells),</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> Time, <span class="at">y =</span> deriv_percap_raw, <span class="at">color =</span> noise)) <span class="sc">+</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.75</span>, <span class="at">size =</span> <span class="fl">0.75</span>) <span class="sc">+</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="fl">1.25</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="fu">aes</span>(<span class="at">y =</span> deriv_percap3)) <span class="sc">+</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Well, <span class="at">scales =</span> <span class="st">&quot;free_y&quot;</span>) <span class="sc">+</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;smoothed data and calc_deriv window_width_n = 3&quot;</span>) <span class="sc">+</span></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="cn">NA</span>, <span class="dv">10</span>)</span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Warning: Removed 22 rows containing missing values (`geom_point()`).</span></span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Warning: Removed 12 rows containing missing values (`geom_line()`).</span></span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>And now let’s compare to the density plots:</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(ex_dat_mrg, Well <span class="sc">%in%</span> sample_wells),</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> Time, <span class="at">y =</span> Measurements, <span class="at">color =</span> noise)) <span class="sc">+</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.75</span>, <span class="at">size =</span> <span class="fl">0.75</span>) <span class="sc">+</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="fl">1.25</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="fu">aes</span>(<span class="at">y =</span> smoothed)) <span class="sc">+</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Well, <span class="at">scales =</span> <span class="st">&quot;free_y&quot;</span>)</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Warning: Removed 8 rows containing missing values (`geom_line()`).</span></span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Clearly we can see that most of the noise in the per-capita growth
rate occurs when the bacterial population density is very low. Indeed,
<strong>this is common with per-capita growth rates, which are very
sensitive to noise at low densities</strong>. What can we do about it?
We can simply exclude all the values when the <em>density</em> is really
low.</p>
<p>Let’s plot our per-capita growth rate data at different cutoffs for
the minimum <em>density</em> of bacteria:</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (my_well <span class="cf">in</span> sample_wells) {</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Title</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>  title <span class="ot">&lt;-</span> cowplot<span class="sc">::</span><span class="fu">ggdraw</span>() <span class="sc">+</span> </span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>    cowplot<span class="sc">::</span><span class="fu">draw_label</span>(<span class="fu">paste</span>(<span class="st">&quot;Well&quot;</span>, my_well), </span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>                        <span class="at">fontface =</span> <span class="st">&quot;bold&quot;</span>, <span class="at">x =</span> <span class="dv">0</span>, <span class="at">hjust =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">plot.margin =</span> <span class="fu">margin</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">7</span>))</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Save x and y limits for all plots so they&#39;re all on the same axes</span></span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>  xdat <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(ex_dat_mrg, Well <span class="sc">==</span> my_well)<span class="sc">$</span>Time</span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>  ydat <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(ex_dat_mrg, Well <span class="sc">==</span> my_well)<span class="sc">$</span>deriv_percap3</span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>  xlims <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">min</span>(xdat[<span class="fu">is.finite</span>(xdat)], <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a>             <span class="fu">max</span>(xdat[<span class="fu">is.finite</span>(xdat)], <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a>  ylims <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">min</span>(ydat[<span class="fu">is.finite</span>(ydat)], <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a>             <span class="fu">max</span>(ydat[<span class="fu">is.finite</span>(ydat)], <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Plot unfiltered data</span></span>
<span id="cb26-17"><a href="#cb26-17" aria-hidden="true" tabindex="-1"></a>  p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(ex_dat_mrg, Well <span class="sc">==</span> my_well),</span>
<span id="cb26-18"><a href="#cb26-18" aria-hidden="true" tabindex="-1"></a>               <span class="fu">aes</span>(<span class="at">x =</span> Time, <span class="at">y =</span> deriv_percap3, <span class="at">color =</span> noise)) <span class="sc">+</span></span>
<span id="cb26-19"><a href="#cb26-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span> <span class="fu">facet_wrap</span>(<span class="sc">~</span>Well, <span class="at">scales =</span> <span class="st">&quot;free&quot;</span>) <span class="sc">+</span></span>
<span id="cb26-20"><a href="#cb26-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggtitle</span>(<span class="st">&quot;all data&quot;</span>) <span class="sc">+</span></span>
<span id="cb26-21"><a href="#cb26-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">xlim</span>(xlims[<span class="dv">1</span>], xlims[<span class="dv">2</span>]) <span class="sc">+</span> <span class="fu">ylim</span>(ylims[<span class="dv">1</span>], ylims[<span class="dv">2</span>])</span>
<span id="cb26-22"><a href="#cb26-22" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb26-23"><a href="#cb26-23" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Plot data with filters for density</span></span>
<span id="cb26-24"><a href="#cb26-24" aria-hidden="true" tabindex="-1"></a>  p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(ex_dat_mrg, </span>
<span id="cb26-25"><a href="#cb26-25" aria-hidden="true" tabindex="-1"></a>                                    Well <span class="sc">==</span> my_well, smoothed <span class="sc">&gt;</span> <span class="fl">0.001</span>),</span>
<span id="cb26-26"><a href="#cb26-26" aria-hidden="true" tabindex="-1"></a>               <span class="fu">aes</span>(<span class="at">x =</span> Time, <span class="at">y =</span> deriv_percap3, <span class="at">color =</span> noise)) <span class="sc">+</span></span>
<span id="cb26-27"><a href="#cb26-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span> <span class="fu">facet_wrap</span>(<span class="sc">~</span>Well, <span class="at">scales =</span> <span class="st">&quot;free&quot;</span>) <span class="sc">+</span></span>
<span id="cb26-28"><a href="#cb26-28" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggtitle</span>(<span class="st">&quot;data where Abs &gt; 0.001&quot;</span>) <span class="sc">+</span></span>
<span id="cb26-29"><a href="#cb26-29" aria-hidden="true" tabindex="-1"></a>    <span class="fu">xlim</span>(xlims[<span class="dv">1</span>], xlims[<span class="dv">2</span>]) <span class="sc">+</span> <span class="fu">ylim</span>(ylims[<span class="dv">1</span>], ylims[<span class="dv">2</span>])</span>
<span id="cb26-30"><a href="#cb26-30" aria-hidden="true" tabindex="-1"></a>  p3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(ex_dat_mrg, </span>
<span id="cb26-31"><a href="#cb26-31" aria-hidden="true" tabindex="-1"></a>                                    Well <span class="sc">==</span> my_well, smoothed <span class="sc">&gt;</span> <span class="fl">0.005</span>),</span>
<span id="cb26-32"><a href="#cb26-32" aria-hidden="true" tabindex="-1"></a>               <span class="fu">aes</span>(<span class="at">x =</span> Time, <span class="at">y =</span> deriv_percap3, <span class="at">color =</span> noise)) <span class="sc">+</span></span>
<span id="cb26-33"><a href="#cb26-33" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span> <span class="fu">facet_wrap</span>(<span class="sc">~</span>Well, <span class="at">scales =</span> <span class="st">&quot;free&quot;</span>) <span class="sc">+</span></span>
<span id="cb26-34"><a href="#cb26-34" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggtitle</span>(<span class="st">&quot;data where Abs &gt; 0.005&quot;</span>) <span class="sc">+</span></span>
<span id="cb26-35"><a href="#cb26-35" aria-hidden="true" tabindex="-1"></a>    <span class="fu">xlim</span>(xlims[<span class="dv">1</span>], xlims[<span class="dv">2</span>]) <span class="sc">+</span> <span class="fu">ylim</span>(ylims[<span class="dv">1</span>], ylims[<span class="dv">2</span>])</span>
<span id="cb26-36"><a href="#cb26-36" aria-hidden="true" tabindex="-1"></a>  p4 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(ex_dat_mrg, </span>
<span id="cb26-37"><a href="#cb26-37" aria-hidden="true" tabindex="-1"></a>                                    Well <span class="sc">==</span> my_well, smoothed <span class="sc">&gt;</span> <span class="fl">0.01</span>),</span>
<span id="cb26-38"><a href="#cb26-38" aria-hidden="true" tabindex="-1"></a>               <span class="fu">aes</span>(<span class="at">x =</span> Time, <span class="at">y =</span> deriv_percap3, <span class="at">color =</span> noise)) <span class="sc">+</span></span>
<span id="cb26-39"><a href="#cb26-39" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span> <span class="fu">facet_wrap</span>(<span class="sc">~</span>Well, <span class="at">scales =</span> <span class="st">&quot;free&quot;</span>) <span class="sc">+</span></span>
<span id="cb26-40"><a href="#cb26-40" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggtitle</span>(<span class="st">&quot;data where Abs &gt; 0.01&quot;</span>) <span class="sc">+</span></span>
<span id="cb26-41"><a href="#cb26-41" aria-hidden="true" tabindex="-1"></a>    <span class="fu">xlim</span>(xlims[<span class="dv">1</span>], xlims[<span class="dv">2</span>]) <span class="sc">+</span> <span class="fu">ylim</span>(ylims[<span class="dv">1</span>], ylims[<span class="dv">2</span>])</span>
<span id="cb26-42"><a href="#cb26-42" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb26-43"><a href="#cb26-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(cowplot<span class="sc">::</span><span class="fu">plot_grid</span>(title, cowplot<span class="sc">::</span><span class="fu">plot_grid</span>(p1, p2, p3, p4, <span class="at">ncol =</span> <span class="dv">2</span>),</span>
<span id="cb26-44"><a href="#cb26-44" aria-hidden="true" tabindex="-1"></a>                           <span class="at">ncol =</span> <span class="dv">1</span>, <span class="at">rel_heights =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="dv">1</span>)))</span>
<span id="cb26-45"><a href="#cb26-45" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb26-46"><a href="#cb26-46" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Warning: Removed 12 rows containing missing values (`geom_point()`).</span></span>
<span id="cb26-47"><a href="#cb26-47" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Warning: Removed 4 rows containing missing values (`geom_point()`).</span></span>
<span id="cb26-48"><a href="#cb26-48" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Warning: Removed 2 rows containing missing values (`geom_point()`).</span></span>
<span id="cb26-49"><a href="#cb26-49" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Removed 2 rows containing missing values (`geom_point()`).</span></span>
<span id="cb26-50"><a href="#cb26-50" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Warning: Removed 12 rows containing missing values (`geom_point()`).</span></span>
<span id="cb26-51"><a href="#cb26-51" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Warning: Removed 4 rows containing missing values (`geom_point()`).</span></span>
<span id="cb26-52"><a href="#cb26-52" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Warning: Removed 2 rows containing missing values (`geom_point()`).</span></span>
<span id="cb26-53"><a href="#cb26-53" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Removed 2 rows containing missing values (`geom_point()`).</span></span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<pre><code>#&gt; Warning: Removed 14 rows containing missing values (`geom_point()`).
#&gt; Warning: Removed 3 rows containing missing values (`geom_point()`).</code></pre>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<pre><code>#&gt; Warning: Removed 12 rows containing missing values (`geom_point()`).
#&gt; Warning: Removed 4 rows containing missing values (`geom_point()`).
#&gt; Warning: Removed 3 rows containing missing values (`geom_point()`).
#&gt; Warning: Removed 2 rows containing missing values (`geom_point()`).</code></pre>
<p><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --></p>
<p>As we can see, as we limit our analyses to data points where the
bacterial population is above a cutoff density, many of the most noisy
points disappear, and the noisy derivative curves look increasingly
similar to the noiseless derivative curves.</p>
<p>To take this to the final step, we can use these cutoffs in our
<code>summarize</code> commands to calculate the maximum growth rate of
the bacteria when their density is at least 0.01.</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>ex_dat_mrg_sum <span class="ot">&lt;-</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="fu">group_by</span>(ex_dat_mrg, Well, Bacteria_strain, Phage, noise),</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">max_growth_rate =</span> <span class="fu">max</span>(deriv_percap3[smoothed <span class="sc">&gt;</span> <span class="fl">0.01</span>], </span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; `summarise()` has grouped output by &#39;Well&#39;, &#39;Bacteria_strain&#39;, &#39;Phage&#39;. You can</span></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; override using the `.groups` argument.</span></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(ex_dat_mrg_sum)</span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 6 × 5</span></span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # Groups:   Well, Bacteria_strain, Phage [3]</span></span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   Well  Bacteria_strain Phage       noise max_growth_rate</span></span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;fct&gt; &lt;chr&gt;           &lt;chr&gt;       &lt;chr&gt;           &lt;dbl&gt;</span></span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 A1    Strain 1        No Phage    No              1.02 </span></span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 A1    Strain 1        No Phage    Yes             1.02 </span></span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3 E11   Strain 29       Phage Added No              1.60 </span></span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4 E11   Strain 29       Phage Added Yes             1.65 </span></span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5 F1    Strain 31       No Phage    No              0.609</span></span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6 F1    Strain 31       No Phage    Yes             0.788</span></span></code></pre></div>
<p>And now we can visualize our findings:</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(ex_dat_mrg, </span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>                            Well <span class="sc">%in%</span> sample_wells, smoothed <span class="sc">&gt;=</span> <span class="fl">0.01</span>),</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> Time, <span class="at">y =</span> deriv_percap3, <span class="at">color =</span> noise)) <span class="sc">+</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Well, <span class="at">scales =</span> <span class="st">&quot;free&quot;</span>) <span class="sc">+</span></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;data where smoothed density &gt; 0.01&quot;</span>) <span class="sc">+</span></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">data =</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(ex_dat_mrg_sum, Well <span class="sc">%in%</span> sample_wells), </span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">yintercept =</span> max_growth_rate, <span class="at">color =</span> noise), <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Warning: Removed 6 rows containing missing values (`geom_point()`).</span></span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Here we can see that by limiting our analyses to just a subset of the
data, the maximum per-capita growth rate has now become nearly identical
in three of the example wells. Unfortunately, in F1 we haven’t been able
to eliminate all of the noise. Hopefully this doesn’t happen in your
data! But if it does, continue to try alternate smoothing, derivative
calculating, and subset strategies to try to further reduce the effects
of noise on your findings.</p>
</div>
<div id="whats-next" class="section level1">
<h1>What’s next?</h1>
<p>Now that you’ve analyzed your data and dealt with any noise, there’s
just some concluding notes on best practices for running statistics,
merging growth curve analyses with other data, and additional resources
for analyzing growth curves.</p>
<ol style="list-style-type: decimal">
<li>Introduction: <code>vignette(&quot;gcplyr&quot;)</code></li>
<li>Importing and transforming data:
<code>vignette(&quot;import_transform&quot;)</code></li>
<li>Incorporating design information:
<code>vignette(&quot;incorporate_designs&quot;)</code></li>
<li>Pre-processing and plotting your data:
<code>vignette(&quot;preprocess_plot&quot;)</code></li>
<li>Processing your data: <code>vignette(&quot;process&quot;)</code></li>
<li>Analyzing your data: <code>vignette(&quot;analyze&quot;)</code></li>
<li>Dealing with noise: <code>vignette(&quot;noise&quot;)</code></li>
<li><strong>Statistics, merging other data, and other
resources:</strong> <code>vignette(&quot;conclusion&quot;)</code></li>
</ol>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
