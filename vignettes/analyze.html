<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Mike Blazanin" />


<title>Analyzing data</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Analyzing data</h1>
<h4 class="author">Mike Blazanin</h4>


<div id="TOC">
<ul>
<li><a href="#where-are-we-so-far" id="toc-where-are-we-so-far">Where
are we so far?</a></li>
<li><a href="#analyzing-data-with-summarize" id="toc-analyzing-data-with-summarize">Analyzing data with summarize</a>
<ul>
<li><a href="#growth" id="toc-growth">Growth</a></li>
<li><a href="#saturation" id="toc-saturation">Saturation</a></li>
<li><a href="#total-growth" id="toc-total-growth">Total growth</a></li>
<li><a href="#diauxic-growth" id="toc-diauxic-growth">Diauxic
growth</a></li>
<li><a href="#growth-with-antagonists-e.g.-phages" id="toc-growth-with-antagonists-e.g.-phages">Growth with antagonists
(e.g. phages)</a></li>
</ul></li>
<li><a href="#another-brief-primer-on-dplyr-summarize" id="toc-another-brief-primer-on-dplyr-summarize">Another brief primer on
dplyr: summarize</a></li>
<li><a href="#plotting-summarized-metrics" id="toc-plotting-summarized-metrics">Plotting summarized
metrics</a></li>
<li><a href="#init_dens" id="toc-init_dens">Initial density</a></li>
<li><a href="#lag" id="toc-lag">Lag time</a></li>
<li><a href="#dens_thresh" id="toc-dens_thresh">Time to reach threshold
density</a></li>
<li><a href="#percap_thresh" id="toc-percap_thresh">Time to reach
threshold growth rate</a></li>
<li><a href="#max_percap" id="toc-max_percap">Maximum growth rate and
minimum doubling time</a></li>
<li><a href="#midpoint" id="toc-midpoint">Mid-point time or inflection
point</a></li>
<li><a href="#maxdens" id="toc-maxdens">Maximum density</a></li>
<li><a href="#auc" id="toc-auc">Area under the curve</a></li>
<li><a href="#diauxie" id="toc-diauxie">Diauxic shifts</a></li>
<li><a href="#diauxic_percap" id="toc-diauxic_percap">Growth rate during
diauxie</a></li>
<li><a href="#peak_dens" id="toc-peak_dens">Peak bacterial
density</a></li>
<li><a href="#extin_time" id="toc-extin_time">Extinction time</a></li>
<li><a href="#whats-next" id="toc-whats-next">What’s next?</a></li>
</ul>
</div>

<div id="where-are-we-so-far" class="section level1">
<h1>Where are we so far?</h1>
<ol style="list-style-type: decimal">
<li>Introduction: <code>vignette(&quot;gcplyr&quot;)</code></li>
<li>Importing and transforming data:
<code>vignette(&quot;import_transform&quot;)</code></li>
<li>Incorporating design information:
<code>vignette(&quot;incorporate_designs&quot;)</code></li>
<li>Pre-processing and plotting your data:
<code>vignette(&quot;preprocess_plot&quot;)</code></li>
<li>Processing your data: <code>vignette(&quot;process&quot;)</code></li>
<li><strong>Analyzing your data:</strong>
<code>vignette(&quot;analyze&quot;)</code></li>
<li>Dealing with noise: <code>vignette(&quot;noise&quot;)</code></li>
<li>Statistics, merging other data, and other resources:
<code>vignette(&quot;conclusion&quot;)</code></li>
</ol>
<p>So far, we’ve imported and transformed our measures, combined them
with our design information, pre-processed, processed, and plotted our
data. Now we’re going to analyze our data by summarizing our growth
curves into a number of metrics.</p>
<p>If you haven’t already, load the necessary packages.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">library</span>(gcplyr)</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="co">#&gt; ## </span></span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a><span class="co">#&gt; ## gcplyr (Version 1.5.2, Build Date: 2023-05-02)</span></span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a><span class="co">#&gt; ## See http://github.com/mikeblazanin/gcplyr for additional documentation</span></span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a><span class="co">#&gt; ## Please cite software as:</span></span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a><span class="co">#&gt; ##   Blazanin, Michael. 2023. gcplyr: an R package for microbial growth</span></span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a><span class="co">#&gt; ##   curve data analysis. bioRxiv doi: 10.1101/2023.04.30.538883</span></span>
<span id="cb1-8"><a href="#cb1-8" tabindex="-1"></a><span class="co">#&gt; ##</span></span>
<span id="cb1-9"><a href="#cb1-9" tabindex="-1"></a></span>
<span id="cb1-10"><a href="#cb1-10" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb1-11"><a href="#cb1-11" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb1-12"><a href="#cb1-12" tabindex="-1"></a><span class="co">#&gt; Attaching package: &#39;dplyr&#39;</span></span>
<span id="cb1-13"><a href="#cb1-13" tabindex="-1"></a><span class="co">#&gt; The following objects are masked from &#39;package:stats&#39;:</span></span>
<span id="cb1-14"><a href="#cb1-14" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb1-15"><a href="#cb1-15" tabindex="-1"></a><span class="co">#&gt;     filter, lag</span></span>
<span id="cb1-16"><a href="#cb1-16" tabindex="-1"></a><span class="co">#&gt; The following objects are masked from &#39;package:base&#39;:</span></span>
<span id="cb1-17"><a href="#cb1-17" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb1-18"><a href="#cb1-18" tabindex="-1"></a><span class="co">#&gt;     intersect, setdiff, setequal, union</span></span>
<span id="cb1-19"><a href="#cb1-19" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="co"># This code was previously explained</span></span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a><span class="co"># Here we&#39;re re-running it so it&#39;s available for us to work with</span></span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a>example_tidydata <span class="ot">&lt;-</span> <span class="fu">trans_wide_to_tidy</span>(example_widedata_noiseless,</span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a>                                       <span class="at">id_cols =</span> <span class="st">&quot;Time&quot;</span>)</span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a>example_design <span class="ot">&lt;-</span> <span class="fu">make_design</span>(</span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a>  <span class="at">pattern_split =</span> <span class="st">&quot;,&quot;</span>, <span class="at">nrows =</span> <span class="dv">8</span>, <span class="at">ncols =</span> <span class="dv">12</span>,</span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a>  <span class="st">&quot;Bacteria_strain&quot;</span> <span class="ot">=</span> <span class="fu">make_designpattern</span>(</span>
<span id="cb2-8"><a href="#cb2-8" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">paste</span>(<span class="st">&quot;Strain&quot;</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">48</span>),</span>
<span id="cb2-9"><a href="#cb2-9" tabindex="-1"></a>    <span class="at">rows =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>, <span class="at">cols =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>, <span class="at">pattern =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">48</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>),</span>
<span id="cb2-10"><a href="#cb2-10" tabindex="-1"></a>  <span class="st">&quot;Bacteria_strain&quot;</span> <span class="ot">=</span> <span class="fu">make_designpattern</span>(</span>
<span id="cb2-11"><a href="#cb2-11" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">paste</span>(<span class="st">&quot;Strain&quot;</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">48</span>),</span>
<span id="cb2-12"><a href="#cb2-12" tabindex="-1"></a>    <span class="at">rows =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>, <span class="at">cols =</span> <span class="dv">7</span><span class="sc">:</span><span class="dv">12</span>, <span class="at">pattern =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">48</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>),</span>
<span id="cb2-13"><a href="#cb2-13" tabindex="-1"></a>  <span class="st">&quot;Phage&quot;</span> <span class="ot">=</span> <span class="fu">make_designpattern</span>(</span>
<span id="cb2-14"><a href="#cb2-14" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;No Phage&quot;</span>), <span class="at">rows =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>, <span class="at">cols =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>, <span class="at">pattern =</span> <span class="st">&quot;1&quot;</span>),</span>
<span id="cb2-15"><a href="#cb2-15" tabindex="-1"></a>  <span class="st">&quot;Phage&quot;</span> <span class="ot">=</span> <span class="fu">make_designpattern</span>(</span>
<span id="cb2-16"><a href="#cb2-16" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;Phage Added&quot;</span>), <span class="at">rows =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>, <span class="at">cols =</span> <span class="dv">7</span><span class="sc">:</span><span class="dv">12</span>, <span class="at">pattern =</span> <span class="st">&quot;1&quot;</span>))</span>
<span id="cb2-17"><a href="#cb2-17" tabindex="-1"></a>ex_dat_mrg <span class="ot">&lt;-</span> <span class="fu">merge_dfs</span>(example_tidydata, example_design)</span>
<span id="cb2-18"><a href="#cb2-18" tabindex="-1"></a><span class="co">#&gt; Joining with `by = join_by(Well)`</span></span>
<span id="cb2-19"><a href="#cb2-19" tabindex="-1"></a>ex_dat_mrg<span class="sc">$</span>Well <span class="ot">&lt;-</span> </span>
<span id="cb2-20"><a href="#cb2-20" tabindex="-1"></a>  <span class="fu">factor</span>(ex_dat_mrg<span class="sc">$</span>Well,</span>
<span id="cb2-21"><a href="#cb2-21" tabindex="-1"></a>         <span class="at">levels =</span> <span class="fu">paste</span>(<span class="fu">rep</span>(LETTERS[<span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>], <span class="at">each =</span> <span class="dv">12</span>), <span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>, <span class="at">sep =</span> <span class="st">&quot;&quot;</span>))</span>
<span id="cb2-22"><a href="#cb2-22" tabindex="-1"></a>ex_dat_mrg<span class="sc">$</span>Time <span class="ot">&lt;-</span> ex_dat_mrg<span class="sc">$</span>Time<span class="sc">/</span><span class="dv">3600</span> <span class="co">#Convert time to hours</span></span>
<span id="cb2-23"><a href="#cb2-23" tabindex="-1"></a>ex_dat_mrg <span class="ot">&lt;-</span></span>
<span id="cb2-24"><a href="#cb2-24" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">group_by</span>(ex_dat_mrg, Well, Bacteria_strain, Phage),</span>
<span id="cb2-25"><a href="#cb2-25" tabindex="-1"></a>         <span class="at">deriv =</span> <span class="fu">calc_deriv</span>(<span class="at">x =</span> Time, <span class="at">y =</span> Measurements),</span>
<span id="cb2-26"><a href="#cb2-26" tabindex="-1"></a>         <span class="at">deriv_percap5 =</span> <span class="fu">calc_deriv</span>(<span class="at">x =</span> Time, <span class="at">y =</span> Measurements, </span>
<span id="cb2-27"><a href="#cb2-27" tabindex="-1"></a>                                        <span class="at">percapita =</span> <span class="cn">TRUE</span>, <span class="at">blank =</span> <span class="dv">0</span>,</span>
<span id="cb2-28"><a href="#cb2-28" tabindex="-1"></a>                                        <span class="at">window_width_n =</span> <span class="dv">5</span>, <span class="at">trans_y =</span> <span class="st">&quot;log&quot;</span>),</span>
<span id="cb2-29"><a href="#cb2-29" tabindex="-1"></a>         <span class="at">doub_time =</span> <span class="fu">doubling_time</span>(<span class="at">y =</span> deriv_percap5))</span>
<span id="cb2-30"><a href="#cb2-30" tabindex="-1"></a>sample_wells <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;A1&quot;</span>, <span class="st">&quot;F1&quot;</span>, <span class="st">&quot;F10&quot;</span>, <span class="st">&quot;E11&quot;</span>)</span>
<span id="cb2-31"><a href="#cb2-31" tabindex="-1"></a><span class="co"># Drop unneeded columns (optional, but makes things cleaner)</span></span>
<span id="cb2-32"><a href="#cb2-32" tabindex="-1"></a>ex_dat_mrg <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">select</span>(ex_dat_mrg,</span>
<span id="cb2-33"><a href="#cb2-33" tabindex="-1"></a>                            Time, Well, Measurements, Bacteria_strain, Phage,</span>
<span id="cb2-34"><a href="#cb2-34" tabindex="-1"></a>                            deriv, deriv_percap5)</span></code></pre></div>
</div>
<div id="analyzing-data-with-summarize" class="section level1">
<h1>Analyzing data with summarize</h1>
<p>Ultimately, analyzing growth curves requires summarizing the entire
time series of data by some metric or metrics. gcplyr makes it easy to
calculate a number of metrics of interest, which I’ve grouped below into
categories:</p>
<div id="growth" class="section level3">
<h3>Growth</h3>
<ul>
<li><a href="#init_dens">the initial density</a></li>
<li><a href="#lag">the lag time</a></li>
<li><a href="#dens_thresh">the time to reach some density</a></li>
<li><a href="#percap_thresh">the time to reach some growth rate</a></li>
<li><a href="#max_percap">the maximum per-capita growth rate
(i.e. minimum doubling time)</a></li>
</ul>
</div>
<div id="saturation" class="section level3">
<h3>Saturation</h3>
<ul>
<li><a href="#midpoint">the mid-point time or inflection point</a></li>
<li><a href="#maxdens">the maximum density (e.g. carrying
capacity)</a></li>
</ul>
</div>
<div id="total-growth" class="section level3">
<h3>Total growth</h3>
<ul>
<li><a href="#auc">the area under the curve</a></li>
</ul>
</div>
<div id="diauxic-growth" class="section level3">
<h3>Diauxic growth</h3>
<ul>
<li><a href="#diauxie">the density and time when a diauxic shift
occurs</a></li>
<li><a href="#diauxic_percap">the maximum per-capita growth rate during
diauxie</a></li>
</ul>
</div>
<div id="growth-with-antagonists-e.g.-phages" class="section level3">
<h3>Growth with antagonists (e.g. phages)</h3>
<ul>
<li><a href="#peak_dens">the peak bacterial density before a decline
(e.g. from phage predation)</a></li>
<li><a href="#extin_time">the extinction time (e.g. from phage
predation)</a></li>
</ul>
<p>The following sections show how you can use <code>gcplyr</code>
functions to calculate these metrics.</p>
<p>But first, we need to familiarize ourselves with one more
<code>dplyr</code> function: <code>summarize</code>. Why? Because the
upcoming <code>gcplyr</code> analysis functions <em>must</em> be used
<em>within</em> <code>dplyr::summarize</code>. <strong>If you’re already
familiar with <code>dplyr</code>’s <code>summarize</code>, feel free to
skip the primer in the next section.</strong> If you’re not familiar
yet, don’t worry! Continue to the next section, where I provide a primer
that will teach you all you need to know on using <code>summarize</code>
with <code>gcplyr</code> functions.</p>
</div>
</div>
<div id="another-brief-primer-on-dplyr-summarize" class="section level1">
<h1>Another brief primer on dplyr: summarize</h1>
<p>Here we’re going to focus on the <code>summarize</code> function from
<code>dplyr</code>, which <em>must</em> be used with the
<code>group_by</code> function we covered in our first primer: <a href="vignette(%22process%22)">A brief primer on dplyr</a>.
<code>summarize</code> carries out user-specified calculations on
<em>each</em> group in a grouped <code>data.frame</code> independently,
producing a new <code>data.frame</code> where each group is now just a
single row.</p>
<p>For growth curves, this means we will:</p>
<ol style="list-style-type: decimal">
<li><code>group_by</code> our data so that every well is a group</li>
<li><code>summarize</code> each well into one or several metrics</li>
</ol>
<p>As before, to use <code>group_by</code> we simply pass the
<code>data.frame</code> to be grouped, and the names of the columns we
want to group by. Since <code>summarize</code> will drop columns that
the data aren’t grouped by and that aren’t summarized, we will typically
want to list all of our design columns for <code>group_by</code>, along
with the plate name and well. Again, make sure you’re <em>not</em>
grouping by Time, Measurements, or anything else that varies
<em>within</em> a well, since if you do <code>dplyr</code> will group
timepoints within a well separately.</p>
<p>Then, we run <code>summarize</code>. <code>summarize</code> works
much like <code>mutate</code> did, where we specify:</p>
<ol style="list-style-type: decimal">
<li>the name of the variable we want results saved to</li>
<li>the function that calculates the summarized results</li>
</ol>
<p>Just like <code>mutate</code>, if we want additional summary metrics,
we simply add them to the summarize. However, unlike
<code>mutate</code>, <code>summarize</code> functions return just a
single value for each group.</p>
<p>As you’ll see throughout the rest of this article, we’ll be using
<code>group_by</code> and <code>summarize</code> to calculate our
metrics of interest. If you want to learn more, <code>dplyr</code> has
extensive documentation and examples of its own online, but this primer
and the coming example should be sufficient to analyze data with
<code>gcplyr</code>.</p>
</div>
<div id="plotting-summarized-metrics" class="section level1">
<h1>Plotting summarized metrics</h1>
<p>Once you’ve calculated your summarized metrics, you should plot them
on the original data to make sure everything matches what you expect. We
can plot summarized values right on top of our original data:</p>
<ul>
<li>density or rate metrics can be plotted as a horizontal line with
<code>geom_hline</code></li>
<li>time metrics can be plotted as a vertical line with
<code>geom_vline</code></li>
<li>pairs of metrics that correspond to both density/rate and time can
be plotted as a point with <code>geom_point</code></li>
</ul>
<p>You’ll see examples of these plots throughout this article.</p>
</div>
<div id="init_dens" class="section level1">
<h1>Initial density</h1>
<p>If you want to identify the initial density of your bacteria, it will
often be sufficient to use <code>min_gc</code> (this works just like
<code>R</code>’s built-in <code>min</code>, but with better default
settings for growth curve analyses with <code>summarize</code>).</p>
<p>We can also save the time when this minimum occurs using the
<code>which_min_gc</code> function. <code>which_min_gc</code> returns
the <em>index</em> of the minimum value, so then we can get the
<code>Time</code> value at that index and save it to a column titled
<code>min_time</code>. (<code>which_min_gc</code> and
<code>extr_val</code> work just like <code>R</code>’s built-in
<code>which.min</code> and <code>[</code>, but with better default
settings for growth curve analyses with <code>summarize</code>)</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a>ex_dat_mrg_sum <span class="ot">&lt;-</span> </span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="fu">group_by</span>(ex_dat_mrg, Bacteria_strain, Phage, Well),</span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a>            <span class="at">min_dens =</span> <span class="fu">min_gc</span>(Measurements, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a>            <span class="at">min_time =</span> <span class="fu">extr_val</span>(Time, <span class="fu">which_min_gc</span>(Measurements)))</span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a><span class="co">#&gt; `summarise()` has grouped output by &#39;Bacteria_strain&#39;, &#39;Phage&#39;. You can</span></span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a><span class="co">#&gt; override using the `.groups` argument.</span></span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a><span class="fu">head</span>(ex_dat_mrg_sum)</span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a><span class="co">#&gt; # A tibble: 6 × 5</span></span>
<span id="cb3-9"><a href="#cb3-9" tabindex="-1"></a><span class="co">#&gt; # Groups:   Bacteria_strain, Phage [6]</span></span>
<span id="cb3-10"><a href="#cb3-10" tabindex="-1"></a><span class="co">#&gt;   Bacteria_strain Phage       Well  min_dens min_time</span></span>
<span id="cb3-11"><a href="#cb3-11" tabindex="-1"></a><span class="co">#&gt;   &lt;chr&gt;           &lt;chr&gt;       &lt;fct&gt;    &lt;dbl&gt;    &lt;dbl&gt;</span></span>
<span id="cb3-12"><a href="#cb3-12" tabindex="-1"></a><span class="co">#&gt; 1 Strain 1        No Phage    A1       0.002     0   </span></span>
<span id="cb3-13"><a href="#cb3-13" tabindex="-1"></a><span class="co">#&gt; 2 Strain 1        Phage Added A7       0.001     9.75</span></span>
<span id="cb3-14"><a href="#cb3-14" tabindex="-1"></a><span class="co">#&gt; 3 Strain 10       No Phage    B4       0.002     0   </span></span>
<span id="cb3-15"><a href="#cb3-15" tabindex="-1"></a><span class="co">#&gt; 4 Strain 10       Phage Added B10      0.001    11   </span></span>
<span id="cb3-16"><a href="#cb3-16" tabindex="-1"></a><span class="co">#&gt; 5 Strain 11       No Phage    B5       0.002     0   </span></span>
<span id="cb3-17"><a href="#cb3-17" tabindex="-1"></a><span class="co">#&gt; 6 Strain 11       Phage Added B11      0.001     6</span></span>
<span id="cb3-18"><a href="#cb3-18" tabindex="-1"></a></span>
<span id="cb3-19"><a href="#cb3-19" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(ex_dat_mrg, Well <span class="sc">%in%</span> sample_wells),</span>
<span id="cb3-20"><a href="#cb3-20" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> Time, <span class="at">y =</span> Measurements)) <span class="sc">+</span></span>
<span id="cb3-21"><a href="#cb3-21" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb3-22"><a href="#cb3-22" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Well) <span class="sc">+</span></span>
<span id="cb3-23"><a href="#cb3-23" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(ex_dat_mrg_sum, Well <span class="sc">%in%</span> sample_wells), </span>
<span id="cb3-24"><a href="#cb3-24" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x =</span> min_time, <span class="at">y =</span> min_dens),</span>
<span id="cb3-25"><a href="#cb3-25" tabindex="-1"></a>             <span class="at">size =</span> <span class="dv">2</span>, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>In some cases (e.g. growing with phages), bacteria may later drop to
a lower density than they started in the growth curve. In this case, we
want the first <em>local</em> minima of the Measurements data, rather
than the global minima:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a>ex_dat_mrg_sum <span class="ot">&lt;-</span> </span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="fu">group_by</span>(ex_dat_mrg, Bacteria_strain, Phage, Well),</span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a>            <span class="at">min_dens =</span> <span class="fu">first_minima</span>(<span class="at">y =</span> Measurements, <span class="at">x =</span> Time, <span class="at">return =</span> <span class="st">&quot;y&quot;</span>),</span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a>            <span class="at">min_time =</span> <span class="fu">first_minima</span>(<span class="at">y =</span> Measurements, <span class="at">x =</span> Time, <span class="at">return =</span> <span class="st">&quot;x&quot;</span>))</span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a><span class="co">#&gt; `summarise()` has grouped output by &#39;Bacteria_strain&#39;, &#39;Phage&#39;. You can</span></span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a><span class="co">#&gt; override using the `.groups` argument.</span></span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a><span class="fu">head</span>(ex_dat_mrg_sum)</span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a><span class="co">#&gt; # A tibble: 6 × 5</span></span>
<span id="cb4-9"><a href="#cb4-9" tabindex="-1"></a><span class="co">#&gt; # Groups:   Bacteria_strain, Phage [6]</span></span>
<span id="cb4-10"><a href="#cb4-10" tabindex="-1"></a><span class="co">#&gt;   Bacteria_strain Phage       Well  min_dens min_time</span></span>
<span id="cb4-11"><a href="#cb4-11" tabindex="-1"></a><span class="co">#&gt;   &lt;chr&gt;           &lt;chr&gt;       &lt;fct&gt;    &lt;dbl&gt;    &lt;dbl&gt;</span></span>
<span id="cb4-12"><a href="#cb4-12" tabindex="-1"></a><span class="co">#&gt; 1 Strain 1        No Phage    A1       0.002        0</span></span>
<span id="cb4-13"><a href="#cb4-13" tabindex="-1"></a><span class="co">#&gt; 2 Strain 1        Phage Added A7       0.002        0</span></span>
<span id="cb4-14"><a href="#cb4-14" tabindex="-1"></a><span class="co">#&gt; 3 Strain 10       No Phage    B4       0.002        0</span></span>
<span id="cb4-15"><a href="#cb4-15" tabindex="-1"></a><span class="co">#&gt; 4 Strain 10       Phage Added B10      0.002        0</span></span>
<span id="cb4-16"><a href="#cb4-16" tabindex="-1"></a><span class="co">#&gt; 5 Strain 11       No Phage    B5       0.002        0</span></span>
<span id="cb4-17"><a href="#cb4-17" tabindex="-1"></a><span class="co">#&gt; 6 Strain 11       Phage Added B11      0.002        0</span></span></code></pre></div>
<p>Note that you can tune the sensitivity of <code>first_minima</code>
to different heights and widths of peaks and valleys using the
<code>window_width</code>, <code>window_width_n</code>, and
<code>window_height</code> arguments. You should check that
<code>first_minima</code> is working with your data by plotting it,
although the default sensitivity works much of the time.</p>
</div>
<div id="lag" class="section level1">
<h1>Lag time</h1>
<p>Bacteria often have a period of time before they reach their maximum
growth rate. If you would like to quantify this lag time, you can use
the <code>lag_time</code> function. <code>lag_time</code> needs the x
and y values, as well as the (per-capita) derivative. It will find the
maximum derivative, then project the tangent line with that slope back
until it crosses the starting density.</p>
<p>Below, I calculate lag time. So that you can see a visualization of
what this tangent-line calculation does, I also calculate the
<code>max_percap</code>, <code>max_percap_time</code>,
<code>max_percap_dens</code>, and <code>min_dens</code>, but you don’t
have to do that.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a>ex_dat_mrg_sum <span class="ot">&lt;-</span> </span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="fu">group_by</span>(ex_dat_mrg, Bacteria_strain, Phage, Well),</span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a>            <span class="at">lag_time =</span> <span class="fu">lag_time</span>(<span class="at">y =</span> Measurements, <span class="at">x =</span> Time, </span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a>                                <span class="at">deriv =</span> deriv_percap5),</span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a>            <span class="at">max_percap =</span> <span class="fu">max_gc</span>(deriv_percap5),</span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a>            <span class="at">max_percap_time =</span> Time[<span class="fu">which_max_gc</span>(deriv_percap5)],</span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a>            <span class="at">max_percap_dens =</span> Measurements[<span class="fu">which_max_gc</span>(deriv_percap5)],</span>
<span id="cb5-8"><a href="#cb5-8" tabindex="-1"></a>            <span class="at">min_dens =</span> <span class="fu">min_gc</span>(Measurements))</span>
<span id="cb5-9"><a href="#cb5-9" tabindex="-1"></a><span class="co">#&gt; `summarise()` has grouped output by &#39;Bacteria_strain&#39;, &#39;Phage&#39;. You can</span></span>
<span id="cb5-10"><a href="#cb5-10" tabindex="-1"></a><span class="co">#&gt; override using the `.groups` argument.</span></span>
<span id="cb5-11"><a href="#cb5-11" tabindex="-1"></a><span class="fu">head</span>(ex_dat_mrg_sum)</span>
<span id="cb5-12"><a href="#cb5-12" tabindex="-1"></a><span class="co">#&gt; # A tibble: 6 × 8</span></span>
<span id="cb5-13"><a href="#cb5-13" tabindex="-1"></a><span class="co">#&gt; # Groups:   Bacteria_strain, Phage [6]</span></span>
<span id="cb5-14"><a href="#cb5-14" tabindex="-1"></a><span class="co">#&gt;   Bacteria_strain Phage       Well  lag_time max_percap max_pe…¹ max_p…² min_d…³</span></span>
<span id="cb5-15"><a href="#cb5-15" tabindex="-1"></a><span class="co">#&gt;   &lt;chr&gt;           &lt;chr&gt;       &lt;fct&gt;    &lt;dbl&gt;      &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;</span></span>
<span id="cb5-16"><a href="#cb5-16" tabindex="-1"></a><span class="co">#&gt; 1 Strain 1        No Phage    A1        2.18       1.03     4.25   0.017   0.002</span></span>
<span id="cb5-17"><a href="#cb5-17" tabindex="-1"></a><span class="co">#&gt; 2 Strain 1        Phage Added A7        1.51       1.03     4.25   0.017   0.001</span></span>
<span id="cb5-18"><a href="#cb5-18" tabindex="-1"></a><span class="co">#&gt; 3 Strain 10       No Phage    B4        1.78       1.59     3.5    0.031   0.002</span></span>
<span id="cb5-19"><a href="#cb5-19" tabindex="-1"></a><span class="co">#&gt; 4 Strain 10       Phage Added B10       1.34       1.59     3.5    0.031   0.001</span></span>
<span id="cb5-20"><a href="#cb5-20" tabindex="-1"></a><span class="co">#&gt; 5 Strain 11       No Phage    B5        1.67       1.65     3.5    0.041   0.002</span></span>
<span id="cb5-21"><a href="#cb5-21" tabindex="-1"></a><span class="co">#&gt; 6 Strain 11       Phage Added B11       1.24       1.65     3.5    0.041   0.001</span></span>
<span id="cb5-22"><a href="#cb5-22" tabindex="-1"></a><span class="co">#&gt; # … with abbreviated variable names ¹​max_percap_time, ²​max_percap_dens,</span></span>
<span id="cb5-23"><a href="#cb5-23" tabindex="-1"></a><span class="co">#&gt; #   ³​min_dens</span></span>
<span id="cb5-24"><a href="#cb5-24" tabindex="-1"></a></span>
<span id="cb5-25"><a href="#cb5-25" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(ex_dat_mrg, Well <span class="sc">%in%</span> sample_wells),</span>
<span id="cb5-26"><a href="#cb5-26" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> Time, <span class="at">y =</span> <span class="fu">log</span>(Measurements))) <span class="sc">+</span></span>
<span id="cb5-27"><a href="#cb5-27" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb5-28"><a href="#cb5-28" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Well) <span class="sc">+</span></span>
<span id="cb5-29"><a href="#cb5-29" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">data =</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(ex_dat_mrg_sum, Well <span class="sc">%in%</span> sample_wells),</span>
<span id="cb5-30"><a href="#cb5-30" tabindex="-1"></a>              <span class="at">color =</span> <span class="st">&quot;red&quot;</span>,</span>
<span id="cb5-31"><a href="#cb5-31" tabindex="-1"></a>              <span class="fu">aes</span>(<span class="at">slope =</span> max_percap,</span>
<span id="cb5-32"><a href="#cb5-32" tabindex="-1"></a>                  <span class="at">intercept =</span> <span class="fu">log</span>(max_percap_dens) <span class="sc">-</span> max_percap<span class="sc">*</span>max_percap_time)) <span class="sc">+</span></span>
<span id="cb5-33"><a href="#cb5-33" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">data =</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(ex_dat_mrg_sum, Well <span class="sc">%in%</span> sample_wells),</span>
<span id="cb5-34"><a href="#cb5-34" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">xintercept =</span> lag_time), <span class="at">lty =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb5-35"><a href="#cb5-35" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">data =</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(ex_dat_mrg_sum, Well <span class="sc">%in%</span> sample_wells),</span>
<span id="cb5-36"><a href="#cb5-36" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">yintercept =</span> <span class="fu">log</span>(min_dens)))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Notice how in some of the wells the minimum density value isn’t the
<em>initial</em> density? We can fix that by overriding the default
minimum density calculation with <code>first_minima</code> via the
<code>y0</code> argument of <code>lag_time</code>.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a>ex_dat_mrg_sum <span class="ot">&lt;-</span> </span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="fu">group_by</span>(ex_dat_mrg, Bacteria_strain, Phage, Well),</span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a>            <span class="at">min_dens =</span> <span class="fu">first_minima</span>(Measurements, <span class="at">return =</span> <span class="st">&quot;y&quot;</span>),</span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a>            <span class="at">lag_time =</span> <span class="fu">lag_time</span>(<span class="at">y =</span> Measurements, <span class="at">x =</span> Time, </span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a>                                <span class="at">deriv =</span> deriv_percap5, <span class="at">y0 =</span> min_dens),</span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a>            <span class="at">max_percap =</span> <span class="fu">max_gc</span>(deriv_percap5),</span>
<span id="cb6-7"><a href="#cb6-7" tabindex="-1"></a>            <span class="at">max_percap_time =</span> Time[<span class="fu">which_max_gc</span>(deriv_percap5)],</span>
<span id="cb6-8"><a href="#cb6-8" tabindex="-1"></a>            <span class="at">max_percap_dens =</span> Measurements[<span class="fu">which_max_gc</span>(deriv_percap5)])</span>
<span id="cb6-9"><a href="#cb6-9" tabindex="-1"></a><span class="co">#&gt; `summarise()` has grouped output by &#39;Bacteria_strain&#39;, &#39;Phage&#39;. You can</span></span>
<span id="cb6-10"><a href="#cb6-10" tabindex="-1"></a><span class="co">#&gt; override using the `.groups` argument.</span></span>
<span id="cb6-11"><a href="#cb6-11" tabindex="-1"></a><span class="fu">head</span>(ex_dat_mrg_sum)</span>
<span id="cb6-12"><a href="#cb6-12" tabindex="-1"></a><span class="co">#&gt; # A tibble: 6 × 8</span></span>
<span id="cb6-13"><a href="#cb6-13" tabindex="-1"></a><span class="co">#&gt; # Groups:   Bacteria_strain, Phage [6]</span></span>
<span id="cb6-14"><a href="#cb6-14" tabindex="-1"></a><span class="co">#&gt;   Bacteria_strain Phage       Well  min_dens lag_time max_percap max_p…¹ max_p…²</span></span>
<span id="cb6-15"><a href="#cb6-15" tabindex="-1"></a><span class="co">#&gt;   &lt;chr&gt;           &lt;chr&gt;       &lt;fct&gt;    &lt;dbl&gt;    &lt;dbl&gt;      &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;</span></span>
<span id="cb6-16"><a href="#cb6-16" tabindex="-1"></a><span class="co">#&gt; 1 Strain 1        No Phage    A1       0.002     2.18       1.03    4.25   0.017</span></span>
<span id="cb6-17"><a href="#cb6-17" tabindex="-1"></a><span class="co">#&gt; 2 Strain 1        Phage Added A7       0.002     2.18       1.03    4.25   0.017</span></span>
<span id="cb6-18"><a href="#cb6-18" tabindex="-1"></a><span class="co">#&gt; 3 Strain 10       No Phage    B4       0.002     1.78       1.59    3.5    0.031</span></span>
<span id="cb6-19"><a href="#cb6-19" tabindex="-1"></a><span class="co">#&gt; 4 Strain 10       Phage Added B10      0.002     1.78       1.59    3.5    0.031</span></span>
<span id="cb6-20"><a href="#cb6-20" tabindex="-1"></a><span class="co">#&gt; 5 Strain 11       No Phage    B5       0.002     1.67       1.65    3.5    0.041</span></span>
<span id="cb6-21"><a href="#cb6-21" tabindex="-1"></a><span class="co">#&gt; 6 Strain 11       Phage Added B11      0.002     1.67       1.65    3.5    0.041</span></span>
<span id="cb6-22"><a href="#cb6-22" tabindex="-1"></a><span class="co">#&gt; # … with abbreviated variable names ¹​max_percap_time, ²​max_percap_dens</span></span>
<span id="cb6-23"><a href="#cb6-23" tabindex="-1"></a></span>
<span id="cb6-24"><a href="#cb6-24" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(ex_dat_mrg, Well <span class="sc">%in%</span> sample_wells),</span>
<span id="cb6-25"><a href="#cb6-25" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> Time, <span class="at">y =</span> <span class="fu">log</span>(Measurements))) <span class="sc">+</span></span>
<span id="cb6-26"><a href="#cb6-26" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb6-27"><a href="#cb6-27" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Well) <span class="sc">+</span></span>
<span id="cb6-28"><a href="#cb6-28" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">data =</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(ex_dat_mrg_sum, Well <span class="sc">%in%</span> sample_wells),</span>
<span id="cb6-29"><a href="#cb6-29" tabindex="-1"></a>              <span class="at">color =</span> <span class="st">&quot;red&quot;</span>,</span>
<span id="cb6-30"><a href="#cb6-30" tabindex="-1"></a>              <span class="fu">aes</span>(<span class="at">slope =</span> max_percap,</span>
<span id="cb6-31"><a href="#cb6-31" tabindex="-1"></a>                  <span class="at">intercept =</span> <span class="fu">log</span>(max_percap_dens) <span class="sc">-</span> max_percap<span class="sc">*</span>max_percap_time)) <span class="sc">+</span></span>
<span id="cb6-32"><a href="#cb6-32" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">data =</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(ex_dat_mrg_sum, Well <span class="sc">%in%</span> sample_wells),</span>
<span id="cb6-33"><a href="#cb6-33" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">xintercept =</span> lag_time), <span class="at">lty =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb6-34"><a href="#cb6-34" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">data =</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(ex_dat_mrg_sum, Well <span class="sc">%in%</span> sample_wells),</span>
<span id="cb6-35"><a href="#cb6-35" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">yintercept =</span> <span class="fu">log</span>(min_dens)))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="dens_thresh" class="section level1">
<h1>Time to reach threshold density</h1>
<p>If you want to quantify how long it takes bacteria to reach some
threshold density, you can use the <code>first_above</code> function. In
this example, we’ll use a Measurements value of 0.1 as our
threshold.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a>ex_dat_mrg_sum <span class="ot">&lt;-</span> </span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="fu">group_by</span>(ex_dat_mrg, Bacteria_strain, Phage, Well),</span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a>            <span class="at">above_01 =</span> <span class="fu">first_above</span>(<span class="at">y =</span> Measurements, <span class="at">x =</span> Time, </span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a>                                   <span class="at">threshold =</span> <span class="fl">0.1</span>, <span class="at">return =</span> <span class="st">&quot;x&quot;</span>))</span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a><span class="co">#&gt; `summarise()` has grouped output by &#39;Bacteria_strain&#39;, &#39;Phage&#39;. You can</span></span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a><span class="co">#&gt; override using the `.groups` argument.</span></span>
<span id="cb7-7"><a href="#cb7-7" tabindex="-1"></a><span class="fu">head</span>(ex_dat_mrg_sum)</span>
<span id="cb7-8"><a href="#cb7-8" tabindex="-1"></a><span class="co">#&gt; # A tibble: 6 × 4</span></span>
<span id="cb7-9"><a href="#cb7-9" tabindex="-1"></a><span class="co">#&gt; # Groups:   Bacteria_strain, Phage [6]</span></span>
<span id="cb7-10"><a href="#cb7-10" tabindex="-1"></a><span class="co">#&gt;   Bacteria_strain Phage       Well  above_01</span></span>
<span id="cb7-11"><a href="#cb7-11" tabindex="-1"></a><span class="co">#&gt;   &lt;chr&gt;           &lt;chr&gt;       &lt;fct&gt;    &lt;dbl&gt;</span></span>
<span id="cb7-12"><a href="#cb7-12" tabindex="-1"></a><span class="co">#&gt; 1 Strain 1        No Phage    A1        6.09</span></span>
<span id="cb7-13"><a href="#cb7-13" tabindex="-1"></a><span class="co">#&gt; 2 Strain 1        Phage Added A7        6.09</span></span>
<span id="cb7-14"><a href="#cb7-14" tabindex="-1"></a><span class="co">#&gt; 3 Strain 10       No Phage    B4        4.25</span></span>
<span id="cb7-15"><a href="#cb7-15" tabindex="-1"></a><span class="co">#&gt; 4 Strain 10       Phage Added B10       4.25</span></span>
<span id="cb7-16"><a href="#cb7-16" tabindex="-1"></a><span class="co">#&gt; 5 Strain 11       No Phage    B5        4.04</span></span>
<span id="cb7-17"><a href="#cb7-17" tabindex="-1"></a><span class="co">#&gt; 6 Strain 11       Phage Added B11       4.04</span></span>
<span id="cb7-18"><a href="#cb7-18" tabindex="-1"></a></span>
<span id="cb7-19"><a href="#cb7-19" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(ex_dat_mrg, Well <span class="sc">%in%</span> sample_wells),</span>
<span id="cb7-20"><a href="#cb7-20" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> Time, <span class="at">y =</span> Measurements)) <span class="sc">+</span></span>
<span id="cb7-21"><a href="#cb7-21" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb7-22"><a href="#cb7-22" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Well) <span class="sc">+</span></span>
<span id="cb7-23"><a href="#cb7-23" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">data =</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(ex_dat_mrg_sum, Well <span class="sc">%in%</span> sample_wells), </span>
<span id="cb7-24"><a href="#cb7-24" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">xintercept =</span> above_01), <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAABCFBMVEUAAAAAADoAAGYAOpAAZrYZGT8ZGWIZP4EZYp8aGhozMzM6AAA6ADo6AGY6kNs/GRk/GWI/P4E/gb1NTU1NTW5NTY5NbqtNjshiGRliGT9iGWJiP4FiYmJin9lmAABmADpmtv9uTU1uTW5uTY5ubqtuq8huq+SBPxmBPz+BP2KBn4GBvZ+BvdmOTU2OTW6OTY6ObquOyP+QOgCQtpCQ2/+fYhmf2dmrbk2rbm6rbo6rjk2ryKur5P+2ZgC2//+9gT+92dnIjk3I///Zn2LZvYHZ2Z/Z2b3Z2dnbkDrb/7bb///kq27k///r6+v/AAD/tmb/yI7/25D/5Kv//7b//8j//9v//+T///8SDrTiAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAOKUlEQVR4nO2dDXvUNhLHVQiFHBwtbFrau4NLetfSF7g2OV56bQMJhCTXNJslJNnv/01q+U2SLWlmZFm2vJrngSheOf/Z345lezwrsWUyq7GhHRi7JUCAJUCAJUCAJUCAJUCA0QEdBbZhZRMgQDYBAmQTIEA2AQJkEyBANgECZBMgQDYBAmTDAHr35ZP858GnL5w9Je1z8Ml6ZjeeCE2ydFBAb/9xP/+x/nEoQDWOUpMuHRLQ4bc//H3v6Oj5je+DRVAlVGo6SIcEdHBv7/lDxW8HT2mKQiiGQ+z1/aO3t5y8lDwl7VOMQTf3jqIAdPg4czYfAlIE6b29xweghy5eSp7SJKMC9JqzyY+xBEhnh99x1/JLocBj0LoUtSMG1NWGlU2AANkECJBNgADZBAiQtQM6/9eb4ufWbLZdbTzlVvzfaOatOfA6aqP8ul127kHBJmsFtJh9lgO6+M9vy/OvfkuAGra/8WsRQYsH/LcqhAClFQIkDrEyipbLv2Rm22GChgR09fKbaqPvjwraCZQdQwRdPK35BAPEGJM97UHBupEE6HxrW2z07Yl+p4LOaRyAFD4BBmnGajwRDNLZv5MZt1BnsRxOJGcxrQFKHQGVsZMA6TeKkaflqeEvxAeI7InYKI88LU+9KMQMKBuYrZ52V6DtNDJAjZE5akDejZ/Vh/bBbEMP0kw78Ex5kKYA4nRA91cUEKsulxMgjSfgcTUkIPUeOfxZrIgcwk6grFdA1Uc3FKBaH79TSEAisjGALp7OPv8jb51vldnpjoAkffxO4QDJl6oIQFcvt5cnDwpSWatk1QUQ020cDyCmk7UAuvjxTZkQOv/3H2VOGgHIOEibbiUg9+2y/gZpfZbFAkhgES1E0n5u2N7TxbJJjmwm/8x+Lz6vsOSH2Ea3CDLfa0Gfr13WVwSZ0lCoCOKD9Nc/TxpQ++QKAxJjUPUbCpC+ab5o9jhIG+5bEIDMeTrrWeyb6iyWxVHRcgXUDOBeAJlu7PoCVF4H8SBazGb1Wd4FUCuARwZId3mGAGQwh/eaAEktzSDdDuA+BulMxfFKy5YKT4BGAEgTwAlQTID0t4jugKgWKCHPnKXse/V/FoOS8sDnC8sWTS4zjggivlcGvD44IPvzygQoOKDGIM0gT30N0gmQvkcFiFneq1XBdPkdCBD8ACNiQCJpf/VyVufLEqDKRNKeF5Ev3JL2vQOqmq6AGCCLSpiJZBkVEANeh9w/HTMgOWn/S3mIUSvtg5W1MFc5cBdM0p6XAXNchVGCIVgEFVfDw0WQ43Mxpnmd5P4pCKgcpF0BgYVtuDHopwRIYyJpz89i6ENsdQBJSfushS5ekAC1HsZR3Zc9NfQoAJU35IEBGQz/XkMAKpqugCyP6yYJiFw/MiwgXK1UApQAqS0xSAcBpAzSVEC2J+LugACrC3bC3GbMFSmiJqZ7fxGkKQigfb7qR2nokUdQHTijiCDgvU4a0IdHmx8esWuvugCqm2EA5U1HQNaaCi2g3bXl8bVXx2s+AGErfmMClAXQ5c7a8sweQsj3OlFAHx7djQ8Q07R6AXS5c/fso2f8QMtNJO0XM/LNqrZiguR+w1NDDy7nCMhelaMDtHx/m60td6//nv8ikvb8hh5dozhpQIqpVa6iBbzXKQPKxiD+oxyD1ERrEUHoSvtg2fq5IkaSxXU2AxJJe562Rz84pH6U3QdpKQtEiSCgrqsN6JhVVgzSagShc9JUT+MBVEdQhUQZg9BTdDV9nhIg1UTSXj7YxgdIfrjeN6DsNM+tvFAUSfuTGbF4IRyguSsgqDJQB4jfZ8AGvNfivDtNQOoYFAkg5dkxHhBYGaiPID+AjM+70RtHCgi6TUUBOg0L6NQNEFwZqAP04RGTB2lXQOanleiNIwXkyYLOdcMsv2H38tW1NCgYLM+a0BvxEdSoQELeIyMqA/WAstuNzeMy3eEIaB4WUONLvThAmLouLaDd6/8vsq5dAAGvozaiAbGggPKU62a3lCuLABCqbKknQCxsBDGnQ8wZ0PKYH2I8b+8KyOG7cx0BNTpjAOGqcrSAlmf8MqjiI5L2omUHBN3foDciAbXLIxCAkDUVekCyiaS9VHNvA8S0l2k9AtLM1gQDwj7whQGplfZA0p6hJrRDb8QA0s7WBABi6Cme9ICUfJB1ehzWMPE3vM1Xo7O2ZFOu6ZjJTbyk1FavgEQekZRRnPKqCGo+yEOlPcoTyP0RAVLzQaQxSLSmDEi9RBRJe6nmfvUMlbRXroNWzBrVHYP5MVqjJ+1XzOhJ+xUzdQz6KyJpv2JGT9qvmI14NvlxGB3QQIsNDiTrkLQfyNOBZB2S9gN5OpCsQ056IE8Hkk2AAFmHpP1Ang4ka0vaJ0BtQBgbyNOBZB3uxchSB5+sZ3aftz594expF8l3X6zf3HOTdbibJwpJWN6ufxwKkCJ5+Pjh0etbbrLNQdp+jdgN0PMb3weLIEXy3d9e0INXH0GYm1WazpF8YIU7xBTJg3t7R+++fOIkG2KQzgeEW6rfdE87SL69OXJAk4mgqR5i3sagEtM/n00sgg4f3/d0FivszH4uIwqNAJC366AKULpZPbIC2vUcQX48HUhWN0h/5HkM8uPpQLLpZhWQTYAAWYfZXwbydCBZ++wvVVHQ+dZsVn2nF6oPUpvzvuuD1ObcScEma539ZVHO2MGry86/In0tfLKA5Nlf9jd+LSJo8WBJ/Fr4RAE1Zn+RJ+zALwI5NTPP/rKUAfEqvNI6BIPTTqBswBrFptWALp7WfBIgDSA+JXkCtGwWcdaAFD4rPkhf7mxKzzY4oOzfyYxbOovlj31270L5IJLS9AAd+5omsPZ4QoD4FVBGB3g61uG9Ou1EAdT3IM0ryXehfJBvT6CdxgQoWdv6nNPez+cLyoaMIA8zL6jNqQ3SHmZeUJvTAuRj5oVGMwFaKUDdZ15w8US/U35TKHvqXQHYqAWEKuL07Ul7Y8VG8dSrAmInPSDFxBcxz7fw80l3db+A43iIBQUkJqS4eJq13BaBpLqvmW1itIDEl8FJ35tXm7RBWjtxBAVQ34O0YtapKbBGmajCaeYIdzmk1U5d7tQzXDTnk84PsY2eI8g0OcoSlA0VQdkZTCmTlg6sbJD++ud+AYFLxaHea++3GjIjdUIKsRgtUQkHCF7HqqsCdSctoOJAKxmJCSl4HKFXRXBxnyEW2emmQN/JAChn1JqaYjHDTdHl6D5qeYJOCg47mSMISCj6B4SbGryLgstOOkAIOlRAiEEaOfM16r32fBZD0PEPCJwZbiyAWtdBYQDpZ78fI6B+DLq09Szf55U02ogfhfV109zlIx2kgwMyXj4nQHnTfPmcACVA5U/bWcxyfxH1WYykZAFkW2EwAZoEIJG0v3qJX/xIbZoBWe9QowAkzSK9v53nFx0AGV+336FGMUirc7kK8+PJBADJSftfykPMW6V9PGVJZk9F0p6XAXNchXn5qIAcR3QR5Pu5GLR4VRSDtDQG/eQZELg2UxSApFmk950PsSkDUueTdixe0AKC12aKA5DBiEpBAQUdpHsDhFibaaUBYZYeWmVAqKWHogZEsnYWvVfB+JL2rbMYbm2m1TmLNQEh12ZKgBIg/evYxauiHqS7eJIA2UWRy8RqPe3wXp12SoBwsrik/WLm5WYVv9h5FIO0SNrzG3rHGsUpA1KrXNELsKlNGZC+FCheQGqitYigLpX2IfL0QW815KUfz7ccHxxKTVMlPfT5grJDDdJqBDnmpEXTVCsVLyB1DHKcout0GEC0nKVNFpW0J62zamiav4sBue8AiAUBJCXtT2Zdixcs38WA3KcAKs9igQAZjKQ0CCBGfLBkkw0EyPZlFch9MiB2Gh0gW62Ud0C5WDSA8qb92zyQ+xRAdbQOCYhuQWtdmGfJABEEfN0J+nxBWeWPlWIRHWIMKAVacUBz0FO/g3T9aVAqkGyyQxaSI90nAapbcQBiLCwgFhkgFjiCWFwRpJmnBO2eCyD1BiwEIJG0Fy0sIKadpwTtngOgxt1eAEAiaS/V3KMAZXQInkDuYwCx1tQEAQCplfZg0p4Jo3kCuW+TlRSbrxMqsW2yrtPjsJbp/4jnLDokOjd3JZgqaXRG5BE7ZBQnNgueYn1W2k8CEHEM0m+cMiCRtJdq7ivTPj7UP1PEd4U39q/Q2oittBfXQUSlCQOyWQIEWAKUrLQECLAECLAECLAECDAXQO3Losz4AkCfvWlszK+/m93zjWr3chFFtWe5se6pldXq+pR1AKSmhyrb3273zBdJbHYvVk5UupeLKKo9q5UVq556WZ2uV1kHQI3KqtL9eq5Xyfd8kcRmIVa+Ue1eLqKo9iw31j21sjpdv7IOgNSb+9KyMJWWGq278vW3mt3Lm5dG96xL+w9nv9U9tbJ6XZ+yDoDU9FAln0Vl+9PM5zltds/db3bnN8Stnnxj3VMrq9f1KesrgnJrjQfGj7LZPV9EsdlTrKzIe5plW7o+ZX2NQVpHi7Budtd4WiwS2OgprRzIe5pltYB8yTqdxVrpoeIAuPqf7jTf6l4dAKJ76ZPas9xY99TK6nV9yvq8Dtpoxb/1gkR0rxZRVHpWG+uexuuglq5P2XQlDVgCBFgCBFgCBFgCBFgCBNgYAdWTo6+9v4OaRb5PGyMgbiNAU1gCBNi4AWX/v7/z39uM3eUrvW8WR599TQLfNn5At6//vjxm/L9rr/IlTqGFYP1aBICywCn+u/MsX8CTr+QZzsYPiDeq/46LsxuwTKVXiwxQ0KMrt7gAneFW1/FpcQG63MlCKCyluADlp/mwUTRWQKOxBAiwBAiwBAiwBAiwBAiwBAiwBAiwBAiwBAiwPwF9lDXPy9V1sQAAAABJRU5ErkJggg==" /><!-- --></p>
</div>
<div id="percap_thresh" class="section level1">
<h1>Time to reach threshold growth rate</h1>
<p>If you want to quantify how long it takes bacteria to reach some
threshold per-capita growth rate, you can use the
<code>first_above</code> function. In this example, we’ll use a
per-capita derivative of 1 as our threshold.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a>ex_dat_mrg_sum <span class="ot">&lt;-</span> </span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="fu">group_by</span>(ex_dat_mrg, Bacteria_strain, Phage, Well),</span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a>            <span class="at">percap_above_1 =</span> <span class="fu">first_above</span>(<span class="at">y =</span> deriv_percap5, <span class="at">x =</span> Time, </span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a>                                   <span class="at">threshold =</span> <span class="dv">1</span>, <span class="at">return =</span> <span class="st">&quot;x&quot;</span>))</span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a><span class="co">#&gt; `summarise()` has grouped output by &#39;Bacteria_strain&#39;, &#39;Phage&#39;. You can</span></span>
<span id="cb8-6"><a href="#cb8-6" tabindex="-1"></a><span class="co">#&gt; override using the `.groups` argument.</span></span>
<span id="cb8-7"><a href="#cb8-7" tabindex="-1"></a><span class="fu">head</span>(ex_dat_mrg_sum)</span>
<span id="cb8-8"><a href="#cb8-8" tabindex="-1"></a><span class="co">#&gt; # A tibble: 6 × 4</span></span>
<span id="cb8-9"><a href="#cb8-9" tabindex="-1"></a><span class="co">#&gt; # Groups:   Bacteria_strain, Phage [6]</span></span>
<span id="cb8-10"><a href="#cb8-10" tabindex="-1"></a><span class="co">#&gt;   Bacteria_strain Phage       Well  percap_above_1</span></span>
<span id="cb8-11"><a href="#cb8-11" tabindex="-1"></a><span class="co">#&gt;   &lt;chr&gt;           &lt;chr&gt;       &lt;fct&gt;          &lt;dbl&gt;</span></span>
<span id="cb8-12"><a href="#cb8-12" tabindex="-1"></a><span class="co">#&gt; 1 Strain 1        No Phage    A1              3.95</span></span>
<span id="cb8-13"><a href="#cb8-13" tabindex="-1"></a><span class="co">#&gt; 2 Strain 1        Phage Added A7              3.95</span></span>
<span id="cb8-14"><a href="#cb8-14" tabindex="-1"></a><span class="co">#&gt; 3 Strain 10       No Phage    B4              2.28</span></span>
<span id="cb8-15"><a href="#cb8-15" tabindex="-1"></a><span class="co">#&gt; 4 Strain 10       Phage Added B10             2.28</span></span>
<span id="cb8-16"><a href="#cb8-16" tabindex="-1"></a><span class="co">#&gt; 5 Strain 11       No Phage    B5              2.11</span></span>
<span id="cb8-17"><a href="#cb8-17" tabindex="-1"></a><span class="co">#&gt; 6 Strain 11       Phage Added B11             2.11</span></span>
<span id="cb8-18"><a href="#cb8-18" tabindex="-1"></a></span>
<span id="cb8-19"><a href="#cb8-19" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(ex_dat_mrg, Well <span class="sc">%in%</span> sample_wells),</span>
<span id="cb8-20"><a href="#cb8-20" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> Time, <span class="at">y =</span> deriv_percap5)) <span class="sc">+</span></span>
<span id="cb8-21"><a href="#cb8-21" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb8-22"><a href="#cb8-22" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Well) <span class="sc">+</span></span>
<span id="cb8-23"><a href="#cb8-23" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">data =</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(ex_dat_mrg_sum, Well <span class="sc">%in%</span> sample_wells),</span>
<span id="cb8-24"><a href="#cb8-24" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">xintercept =</span> percap_above_1), <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb8-25"><a href="#cb8-25" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="cn">NA</span>))</span>
<span id="cb8-26"><a href="#cb8-26" tabindex="-1"></a><span class="co">#&gt; Warning: Removed 4 rows containing missing values (`geom_line()`).</span></span>
<span id="cb8-27"><a href="#cb8-27" tabindex="-1"></a><span class="co">#&gt; Warning: Removed 2 rows containing missing values (`geom_vline()`).</span></span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAABAlBMVEUAAAAAADoAAGYAOpAAZrYZGT8ZGWIZP4EZYp8aGhozMzM6AAA6ADo6Ojo6kNs/GRk/GWI/P4E/gb1NTU1NTW5NTY5NbqtNjshiGRliGT9iGWJiP4FiYmJin9lmAABmADpmAGZmtv9uTU1uTW5uTY5ubqtuq+SBPxmBPz+BP2KBn4GBvZ+BvdmOTU2OTW6OTY6OyP+QOgCQtpCQ2/+fYhmf2dmrbk2rbm6rbo6ryKur5P+2ZgC2//+9gT+92dnIjk3I///Zn2LZvYHZ2Z/Z2b3Z2dnbkDrb/7bb///kq27k///r6+v/AAD/tmb/yI7/25D/5Kv//7b//8j//9v//+T///8q7N7nAAAACXBIWXMAAA7DAAAOwwHHb6hkAAALr0lEQVR4nO2dC3vUthKGRYFCCoXCttAbtGlP4ZwW2qRc2kJJIGTTwiYQkuz//yvHsr22JY00kizJsnfmedgMjuxv8q48uli22ZLMaGzoAHI3AoQYAUKMACFGgBAjQIi5AJqnt8GVCRCiTIAQZQKEKBMgRJkAIcoECFEmQIgyAUKUowN6/dWD8ufeZ096hOm41971jcIuPmh13eVTAXr17c3yx8bHKQE1OGpdD/lEgPb/+8s3O/P544s/J61BK7Fa10c+EaC9GzuP7wgxe4XpqtqK5X6Kvbg5f3XZL8JumI57VTno0s48e0D794tAy9OfahAc6Q2egO54RdgN01V2NIBecDblOUaAINv/Hw+r7AoNkIM2OjU3U0D9bXBlAoQoEyBEmQAhygQIUXYCtOBWfXbcQ3CrlYsXhZUP/eSc4iFASDwECIknHKBAAcFuLGUC1Due8QNijMWMZwKAFiMBNFCS5nSYtzIB6h2PDyDYDnsfwUuyDDzB8q+x1qAy//DPnGpQmCjCJGkCJISpbK/4ECAMUEGIAEHKrHXs5fCy02nmPQExpCwBWjBmKjtBQAtmLVfQ4amLWcYzbkCt6wao+mkVTzhAPVxfQMwP0IIAmdymz6SfBFhrQO3ANjCg4/+8zBkQ2nQDVLSTAD6A3s2+QAANPGk/MKDdz//CatAhn/tMCoj1BKQdwvU5xT4pDC5wWByCJb0vj3WnoOyUmfG/Dnuqhuag6hRruqipa9CSgTtKrtS2a6p8hCTN2qlzYyc+LKBFX0Caxi8GoEV78cXUiR8WEBsSUHvobAExFRCc28MDEhOPoRM/JCAWF1DH1Ci4TKcfxByvw/gBYtLiBax5YMApBnMNDohJgFwniacPiH8mBsQCAYJ2SwDIbRZ9PQBJW+3nHzwBMaWWmntgq2vUcoEEgMCWIDogtbQfIGC3JIBsR482vwcAgV0JYw+MAPkCUreGBbTKfMp8kNXgyOr3OkDyIs5cAAnGWL2vuvwl5twHAyVNikz7e6s4fWtQ239XZxStZz5C1SDjIEdfg5TdQp5ifBhfucCUq+3MRzJAGpG4gEwNuuXAPlSSNl2pMDYa0m4BAZX11vD32Q3s3QHpyBOgRRRA0gWOwICMfx9awOb39oD0l3KQfhmLD0hzXUwdMqmuLyDgZpbxAbIZ2KcAhI0N2XCA8HFrDoDaNVXpAaHDsiwAdcZG4QDZTs8jlxOdARl6oLqUZzP9Ah02DaC2AmcNaBWlB6CTh7Nbb/sAWiwMt3VlAwjoltgBOnu6tXxzux+gcmDLwHSUEaCFvEbFDtDJby87Vw7bw3UBWa4PYm5mBATd1NsX0KL+IiVlBNDxT2+XJ78+WwrLX/hROmUGuh1KtiYkGXVPLfP+726tAHGD0WdyW3hTg6wGOXg8doDaGkSAQNPlIGfpsICMSTopoLOn98BWzFl6qoB0/SBn6QkA+nB3k38UaX9TR8tVb3qAPnz3qPCeX3MCtC5JmgM6OP9v4R199DcBggEdTQCQ2yhIHw8AiLFzn5an2IUxn2LRABX2/gq7UIDS8RlHko4JCLMe0gSod0Cw66DMUgA6YKPtByUBdMDbrw93df0g2DKZ7lj9JaHX3nSPV3amx9rMp6hBBEhVFmvk0blHplMMPvIaASqHqpWBlaiH9ESSNGI9pAlQ74BgNzNAxVhDe34RoOXydPva6fZm3ZZZA1qrJL3JZ8uqSQ8CBAM6uED9oK6ymIOel3QOqAbpABVJaPmc8d6iA6BAAcGug3IFyHKFticgyHJ8+ktOgPCnvwQKCHYzA8RPsdPt7pSrxdNfAgUEu5kBKqfrRUIWT38xV8EYZpgPCn4rFjrdYfn0l97fGOzCyoZWLGoNEgHtzma3CRA+5UqAunbEx6rifFkHUN6WIAeBNhpAkUwczWuv+KyvAUmarGtiktYNU9fYoEl73XTHWlrSByCO0QgQYsrihU19IhruTYPDKUuD1fP/3N2UBqsEqLWimS9XKuqS9HBhDqdMgBBluR/0D2ekW7wwXJjDKeODVQJkb8OFOZwyAUKUnRZxuqvsXd8o7Cb3PnvSI8x+sq+/3Li046nstIjTVaOD5dXGxykBCbL79+/MX1z2VHZao+iq0Ub6+OLPSWuQIPv66yceFTgtoNSnmCC7d2Nn/vqrB37KTos4HSXmdTK4LMbsE2Yv2VeXQgHCFnE6SsynV4MQc5RQIvWwEIDC5aBOXfp+QjVo//7NQK3YRAEF7AcFB9TbBlcmQIgyAUKUCRCiTIAQZQKEKE/oZpbA8UCAsLtVowYEu3kBKufLDAs8ogYEu5kBKuw5G+tK+0SAOKNx3i+WrgZpV79EDQh2MwNkOr8IEL4EL2pAsJsXIMyiBgS7GQEqVy7QEjzFqAY5nGLYOumoAcFuXoAoSavKTuukowYEu3kBwpJ01IBgNy9AmEUNCHYJEOLmBsi8TjpqQLCbGSBknXTUgGA3L0DYMuCoAcEuAULcvACB66RH82iKJElaXSc9nkdTJAGk2IgeTTEMIItHU0zchAduQ+vvKAd1rF4nLYzpCVBrfg83CRQQ7BIgxM0LkN/DTQIFBLuZAar6QWN6Ijn+LtfozXzOgOrX7hlfNLnegKrX7vV7eOLEAdVuj/fVTBhQl0r5NsOQ8UwNUPP/UPFMEVD70ua8ANVvlq/aEqd2NzSgtg7lB4gVwZUtSvnPIyDYhZWrbAM1XbbKaQFVbNqtDHq5NBYQ7ILKRTpmC03bnv5pwFpbvQOXVT6TfxvtyUT80ExVlMIKpuZQVvkeq5+6L4TBb8DuXYOKCrpk+u5z2teI9gHEM5M5a/oCWrRnWL6AVmEaXifftm0hAbHFmABZtBoGgr0A6XbMChCzalaZ7l3wawDIUlqTr70Bmb8PqyNj8YQA5NS1h/I1ARJcNV9PHpBrFNWZRoBMLuumoykD8o+CpyPrEZOqjDdS4we0WFWkCQA6eTi79TYCoPIQrHO+jRTQ2dOt5ZvbkQC1dYlpx7W5Azr57WXn0mqYKDQBMdHEMDul8wJ0/NPb5cmvz5bC+qDqLzDuF8ushFfzVJ4GH01j726tAHFz/UKcvjHY9VGua5DH7GufGkSAQNPnoCDu+AGdPb2nacWCuOMHpO8HBXEnAEgwVz0C1NclQA4BwS4BQlwChLgECHEJEOISIMQlQIg7LkAjMSb8CHQ0K3P9QtauBrnqDQrIZ7nimgCqLtkRIL1LgAiQHKbbgQkQAZLDdDswASJAcphuByZABEgO0+3AaQGN8LbwpIDG+HiclIBG+XicQU6xMT0ehzUfoQ5mMspBOtudzW4TIKpBIQGVBmei3lstilofjfGt0B/mE88UAQWNxznZEyDECBCZYAQIMQKEGAFCjAAh5gZIWBXc2JvZrDMpUlvZf1LKl1vF8sc/zGZbStF6a1M0hjIsLSk7ARLvjmpsd0stWs4jKeWr2SWhPL/T4fjHZ1LRemtTNIYyLC0rOwES70xY2dkfz5SS1TySXL7aKpZ/x0Pb3ZKK1lubojGUYWlZ2QmQeG/LyooaWlZKqWwhqZbnW9XyRRng0MV/m6KxlGHprrITIPHuqEa6qJDqd8kDUsuXwcvl+R0halG+tSkaSRmWFpQD1KDSlGyg/x7l8icP7wGHLrc2ReMow9KicoAcpA9TLQ+EefzDFnDoamtTNIoyLC0pO7Zi94C2hFfRsz+hxlYtv6r+bfk6HqlovbUpGkMZlpaVA/WDPldqv7k30pbn/Q2eDsWiq61N0QjKsLSsTD1pxAgQYgQIMQKEGAFCjAAhlh2g0+36EREX3l81vJg7mWUHiFseaCojQIhlDKj4fH/19yuMXXt/pXzbBz/7kr+oO3NAV87/uzxg/OOjv8u3UyIvEw5vuQMqKk71cfXREfDuqviWOSDurD4OqtbtGrp7UBsToNRnV2kjAnR0boi2bUSATreLKpSc0ogAlc188lqUJaCcjAAhRoAQI0CIESDECBBiBAgxAoQYAUKMACH2f2UZfcp3E40GAAAAAElFTkSuQmCC" /><!-- --></p>
</div>
<div id="max_percap" class="section level1">
<h1>Maximum growth rate and minimum doubling time</h1>
<p>If you want to calculate the bacterial maximum growth rate (i.e. the
minimum doubling time), it will often be sufficient to use
<code>max_gc</code> on the per-capita derivatives we calculated in
<code>vignette(&quot;process&quot;)</code>. (<code>max_gc</code> works just like
<code>R</code>’s built-in <code>max</code>, but with better default
settings for growth curve analyses with <code>summarize</code>).</p>
<p>We can also save the time when this maximum occurs using the
<code>which_max_gc</code> function. <code>which_max_gc</code> returns
the <em>index</em> of the maximum value, so then we can get the
<code>Time</code> value at that index and save it to a column titled
<code>max_percap_time</code>. (<code>which_max_gc</code> and
<code>extr_val</code> work just like <code>R</code>’s built-in
<code>which.max</code> and <code>[</code>, but with better default
settings for growth curve analyses with <code>summarize</code>)</p>
<p>If you would like the equivalent minimum doubling time, you can
simply calculate the maximum growth rate as above and then convert that
into the equivalent minimum doubling time using the
<code>doubling_time</code> function.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a>ex_dat_mrg_sum <span class="ot">&lt;-</span> </span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="fu">group_by</span>(ex_dat_mrg, Bacteria_strain, Phage, Well),</span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a>            <span class="at">max_percap =</span> <span class="fu">max_gc</span>(deriv_percap5, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a>            <span class="at">max_percap_time =</span> <span class="fu">extr_val</span>(Time, <span class="fu">which_max_gc</span>(deriv_percap5)),</span>
<span id="cb9-5"><a href="#cb9-5" tabindex="-1"></a>            <span class="at">doub_time =</span> <span class="fu">doubling_time</span>(<span class="at">y =</span> max_percap))</span>
<span id="cb9-6"><a href="#cb9-6" tabindex="-1"></a><span class="co">#&gt; `summarise()` has grouped output by &#39;Bacteria_strain&#39;, &#39;Phage&#39;. You can</span></span>
<span id="cb9-7"><a href="#cb9-7" tabindex="-1"></a><span class="co">#&gt; override using the `.groups` argument.</span></span>
<span id="cb9-8"><a href="#cb9-8" tabindex="-1"></a><span class="fu">head</span>(ex_dat_mrg_sum)</span>
<span id="cb9-9"><a href="#cb9-9" tabindex="-1"></a><span class="co">#&gt; # A tibble: 6 × 6</span></span>
<span id="cb9-10"><a href="#cb9-10" tabindex="-1"></a><span class="co">#&gt; # Groups:   Bacteria_strain, Phage [6]</span></span>
<span id="cb9-11"><a href="#cb9-11" tabindex="-1"></a><span class="co">#&gt;   Bacteria_strain Phage       Well  max_percap max_percap_time doub_time</span></span>
<span id="cb9-12"><a href="#cb9-12" tabindex="-1"></a><span class="co">#&gt;   &lt;chr&gt;           &lt;chr&gt;       &lt;fct&gt;      &lt;dbl&gt;           &lt;dbl&gt;     &lt;dbl&gt;</span></span>
<span id="cb9-13"><a href="#cb9-13" tabindex="-1"></a><span class="co">#&gt; 1 Strain 1        No Phage    A1          1.03            4.25     0.670</span></span>
<span id="cb9-14"><a href="#cb9-14" tabindex="-1"></a><span class="co">#&gt; 2 Strain 1        Phage Added A7          1.03            4.25     0.670</span></span>
<span id="cb9-15"><a href="#cb9-15" tabindex="-1"></a><span class="co">#&gt; 3 Strain 10       No Phage    B4          1.59            3.5      0.436</span></span>
<span id="cb9-16"><a href="#cb9-16" tabindex="-1"></a><span class="co">#&gt; 4 Strain 10       Phage Added B10         1.59            3.5      0.436</span></span>
<span id="cb9-17"><a href="#cb9-17" tabindex="-1"></a><span class="co">#&gt; 5 Strain 11       No Phage    B5          1.65            3.5      0.421</span></span>
<span id="cb9-18"><a href="#cb9-18" tabindex="-1"></a><span class="co">#&gt; 6 Strain 11       Phage Added B11         1.65            3.5      0.421</span></span>
<span id="cb9-19"><a href="#cb9-19" tabindex="-1"></a></span>
<span id="cb9-20"><a href="#cb9-20" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(ex_dat_mrg, Well <span class="sc">%in%</span> sample_wells),</span>
<span id="cb9-21"><a href="#cb9-21" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> Time, <span class="at">y =</span> deriv_percap5)) <span class="sc">+</span></span>
<span id="cb9-22"><a href="#cb9-22" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb9-23"><a href="#cb9-23" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Well) <span class="sc">+</span></span>
<span id="cb9-24"><a href="#cb9-24" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(ex_dat_mrg_sum, Well <span class="sc">%in%</span> sample_wells), </span>
<span id="cb9-25"><a href="#cb9-25" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x =</span> max_percap_time, <span class="at">y =</span> max_percap),</span>
<span id="cb9-26"><a href="#cb9-26" tabindex="-1"></a>             <span class="at">size =</span> <span class="dv">2</span>, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb9-27"><a href="#cb9-27" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="cn">NA</span>))</span>
<span id="cb9-28"><a href="#cb9-28" tabindex="-1"></a><span class="co">#&gt; Warning: Removed 4 rows containing missing values (`geom_line()`).</span></span></code></pre></div>
<p><img src="data:image/png;base64,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Cyjjr4XrwqSAxnh7nJSARnl7nEFOsTHdHofVL6EOZhK1QTodzmb3CRDVoJCAhOCWqPdWi6LWR2N8K/SH+eQzRUBB83Fu7AkQIgJEkkSAEBEgRAQIEQFC5AZIWhVc6/1s1rooUkmMn5TyYqtc/uz72WxXKVptrYvGcIatO85OgORvR9U63FWLiutISvny6pJUnn/T4exvrzpFq6110RjOsHXX2QmQ/M2EtS7/80opWV5H6pYvt8rlP/LUDnc7RautddEYzrB119kJkPzdlrWKGioqZadsYamW51vV8kUZ4NDFf+uisZxh67azEyD521G1dVEh1feSJ6SWF8l3y/NvhKhF+da6aCRn2FpyDlCDhJTWQP8+dsufP30EHFpsrYvGcYatZecAbZA+TbU8kObZ97vAocutddEozrB1x9mxF3sE9CW8il7+F+ps1fLr6t+Ur/LpFK221kVjOMPWXedA46BvlNpvHo005fl4gzeHctH11rpoBGfYuutMI2lEBAgRAUJEgBARIEQECFF2gC72qltEXPt02/Bg7mTKDhBXHmhKESBEGQMqXj/d/vctxrY/3RJP++BnX/IHdWcO6NbV31YnjL988Yt4OiXyMOHwyh1QUXHKl9vPToFnV8VX5oB4sH45KXu3bXT3oBoToNRnl9CIAJ1eGaJvGxGgi72iCiWnNCJAoptPXouyBJSTCBAiAoSIACEiQIgIECIChIgAISJAiAgQov8Dg4eFU+mETqoAAAAASUVORK5CYII=" /><!-- --></p>
</div>
<div id="midpoint" class="section level1">
<h1>Mid-point time or inflection point</h1>
<p>If you want to find the mid-point or inflection point of bacterial
growth, there are two different approaches:</p>
<ol style="list-style-type: decimal">
<li>Mid-point: find the point when the density first reaches half the
maximum density.</li>
<li>Inflection point: find the point when the derivative is at a
maximum.</li>
</ol>
<p>In growth curve analysis approaches using fitting of a symmetric
function (e.g. when other <code>R</code> packages fit a logistic
function to data), these two points will be equivalent. However, since
<code>gcplyr</code> does model-free analyses, we do not assume symmetry,
and so the points may be very similar or very different.</p>
<p>For the mid-point, we use the <code>first_above</code> function, with
the threshold equal to the maximum bacterial density divided by 2. For
the inflection point, we find the time when the <code>deriv</code> was
at a maximum using <code>which_max_gc</code> (<code>which_max_gc</code>
and <code>extr_val</code> work just like <code>R</code>’s built-in
<code>which.max</code> and <code>[</code>, but with better default
settings for growth curve analyses with <code>summarize</code>).</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a>ex_dat_mrg_sum <span class="ot">&lt;-</span> </span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="fu">group_by</span>(ex_dat_mrg, Bacteria_strain, Phage, Well),</span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a>            <span class="at">mid_point =</span> <span class="fu">first_above</span>(<span class="at">y =</span> Measurements, <span class="at">x =</span> Time, <span class="at">return =</span> <span class="st">&quot;x&quot;</span>,</span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a>                                    <span class="at">threshold =</span> <span class="fu">max_gc</span>(Measurements)<span class="sc">/</span><span class="dv">2</span>),</span>
<span id="cb10-5"><a href="#cb10-5" tabindex="-1"></a>            <span class="at">infl_point =</span> <span class="fu">extr_val</span>(Time, <span class="fu">which_max_gc</span>(deriv)))</span>
<span id="cb10-6"><a href="#cb10-6" tabindex="-1"></a><span class="co">#&gt; `summarise()` has grouped output by &#39;Bacteria_strain&#39;, &#39;Phage&#39;. You can</span></span>
<span id="cb10-7"><a href="#cb10-7" tabindex="-1"></a><span class="co">#&gt; override using the `.groups` argument.</span></span>
<span id="cb10-8"><a href="#cb10-8" tabindex="-1"></a><span class="fu">head</span>(ex_dat_mrg_sum)</span>
<span id="cb10-9"><a href="#cb10-9" tabindex="-1"></a><span class="co">#&gt; # A tibble: 6 × 5</span></span>
<span id="cb10-10"><a href="#cb10-10" tabindex="-1"></a><span class="co">#&gt; # Groups:   Bacteria_strain, Phage [6]</span></span>
<span id="cb10-11"><a href="#cb10-11" tabindex="-1"></a><span class="co">#&gt;   Bacteria_strain Phage       Well  mid_point infl_point</span></span>
<span id="cb10-12"><a href="#cb10-12" tabindex="-1"></a><span class="co">#&gt;   &lt;chr&gt;           &lt;chr&gt;       &lt;fct&gt;     &lt;dbl&gt;      &lt;dbl&gt;</span></span>
<span id="cb10-13"><a href="#cb10-13" tabindex="-1"></a><span class="co">#&gt; 1 Strain 1        No Phage    A1         9.15       8.25</span></span>
<span id="cb10-14"><a href="#cb10-14" tabindex="-1"></a><span class="co">#&gt; 2 Strain 1        Phage Added A7         7.29       8.25</span></span>
<span id="cb10-15"><a href="#cb10-15" tabindex="-1"></a><span class="co">#&gt; 3 Strain 10       No Phage    B4         6.06       5.5 </span></span>
<span id="cb10-16"><a href="#cb10-16" tabindex="-1"></a><span class="co">#&gt; 4 Strain 10       Phage Added B10        5.67       5.5 </span></span>
<span id="cb10-17"><a href="#cb10-17" tabindex="-1"></a><span class="co">#&gt; 5 Strain 11       No Phage    B5         5.71       5   </span></span>
<span id="cb10-18"><a href="#cb10-18" tabindex="-1"></a><span class="co">#&gt; 6 Strain 11       Phage Added B11       16.7        5</span></span>
<span id="cb10-19"><a href="#cb10-19" tabindex="-1"></a></span>
<span id="cb10-20"><a href="#cb10-20" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(ex_dat_mrg, Well <span class="sc">%in%</span> sample_wells),</span>
<span id="cb10-21"><a href="#cb10-21" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> Time, <span class="at">y =</span> Measurements)) <span class="sc">+</span></span>
<span id="cb10-22"><a href="#cb10-22" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb10-23"><a href="#cb10-23" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Well) <span class="sc">+</span></span>
<span id="cb10-24"><a href="#cb10-24" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">data =</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(ex_dat_mrg_sum, Well <span class="sc">%in%</span> sample_wells),</span>
<span id="cb10-25"><a href="#cb10-25" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">xintercept =</span> mid_point), <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb10-26"><a href="#cb10-26" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">data =</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(ex_dat_mrg_sum, Well <span class="sc">%in%</span> sample_wells),</span>
<span id="cb10-27"><a href="#cb10-27" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">xintercept =</span> infl_point), <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">color =</span> <span class="st">&quot;blue&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="maxdens" class="section level1">
<h1>Maximum density</h1>
<p>The maximum bacterial density can be a measure of bacterial carrying
capacity in a given media or as a measure of bacterial growth
yield/efficiency. If you want to quantify the maximum bacterial density,
we can use <code>max_gc</code> to get the global maxima of
<code>Measurements</code> (<code>max_gc</code>,
<code>which_max_gc</code>, and <code>extr_val</code> work just like
<code>R</code>’s built-in <code>max</code>, <code>which.max</code>, and
<code>[</code>, but with better default settings for growth curve
analyses with <code>summarize</code>).</p>
<p>See <a href="#peak_dens">Peak bacterial density</a> for identifying
<em>local</em> maxima of <code>Measurements</code> (e.g. if you wanted
the first peak in Well E11 shown below).</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a>ex_dat_mrg_sum <span class="ot">&lt;-</span> </span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="fu">group_by</span>(ex_dat_mrg, Bacteria_strain, Phage, Well),</span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a>            <span class="at">max_dens =</span> <span class="fu">max_gc</span>(Measurements, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a>            <span class="at">max_time =</span> <span class="fu">extr_val</span>(Time, <span class="fu">which_max_gc</span>(Measurements)))</span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a><span class="co">#&gt; `summarise()` has grouped output by &#39;Bacteria_strain&#39;, &#39;Phage&#39;. You can</span></span>
<span id="cb11-6"><a href="#cb11-6" tabindex="-1"></a><span class="co">#&gt; override using the `.groups` argument.</span></span>
<span id="cb11-7"><a href="#cb11-7" tabindex="-1"></a><span class="fu">head</span>(ex_dat_mrg_sum)</span>
<span id="cb11-8"><a href="#cb11-8" tabindex="-1"></a><span class="co">#&gt; # A tibble: 6 × 5</span></span>
<span id="cb11-9"><a href="#cb11-9" tabindex="-1"></a><span class="co">#&gt; # Groups:   Bacteria_strain, Phage [6]</span></span>
<span id="cb11-10"><a href="#cb11-10" tabindex="-1"></a><span class="co">#&gt;   Bacteria_strain Phage       Well  max_dens max_time</span></span>
<span id="cb11-11"><a href="#cb11-11" tabindex="-1"></a><span class="co">#&gt;   &lt;chr&gt;           &lt;chr&gt;       &lt;fct&gt;    &lt;dbl&gt;    &lt;dbl&gt;</span></span>
<span id="cb11-12"><a href="#cb11-12" tabindex="-1"></a><span class="co">#&gt; 1 Strain 1        No Phage    A1       1.18     24   </span></span>
<span id="cb11-13"><a href="#cb11-13" tabindex="-1"></a><span class="co">#&gt; 2 Strain 1        Phage Added A7       0.499     8.75</span></span>
<span id="cb11-14"><a href="#cb11-14" tabindex="-1"></a><span class="co">#&gt; 3 Strain 10       No Phage    B4       1.21     23.8 </span></span>
<span id="cb11-15"><a href="#cb11-15" tabindex="-1"></a><span class="co">#&gt; 4 Strain 10       Phage Added B10      0.962     8.5 </span></span>
<span id="cb11-16"><a href="#cb11-16" tabindex="-1"></a><span class="co">#&gt; 5 Strain 11       No Phage    B5       1.21     19.5 </span></span>
<span id="cb11-17"><a href="#cb11-17" tabindex="-1"></a><span class="co">#&gt; 6 Strain 11       Phage Added B11      1.03     24</span></span>
<span id="cb11-18"><a href="#cb11-18" tabindex="-1"></a></span>
<span id="cb11-19"><a href="#cb11-19" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(ex_dat_mrg, Well <span class="sc">%in%</span> sample_wells),</span>
<span id="cb11-20"><a href="#cb11-20" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> Time, <span class="at">y =</span> Measurements)) <span class="sc">+</span></span>
<span id="cb11-21"><a href="#cb11-21" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb11-22"><a href="#cb11-22" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Well) <span class="sc">+</span></span>
<span id="cb11-23"><a href="#cb11-23" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(ex_dat_mrg_sum, Well <span class="sc">%in%</span> sample_wells), </span>
<span id="cb11-24"><a href="#cb11-24" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x =</span> max_time, <span class="at">y =</span> max_dens),</span>
<span id="cb11-25"><a href="#cb11-25" tabindex="-1"></a>             <span class="at">size =</span> <span class="dv">2</span>, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="auc" class="section level1">
<h1>Area under the curve</h1>
<p>The area under the curve is a common metric of total bacterial
growth, for instance in the presence of antagonists like antibiotics or
phages. If you want to calculate the area under the curve, you can use
the <code>gcplyr</code> function <code>auc</code>. Simply specify Time
as the x and Measurements as the y data whose area-under-the-curve you
want to calculate.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a>ex_dat_mrg_sum <span class="ot">&lt;-</span></span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="fu">group_by</span>(ex_dat_mrg, Bacteria_strain, Phage, Well),</span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a>            <span class="at">auc =</span> <span class="fu">auc</span>(<span class="at">x =</span> Time, <span class="at">y =</span> Measurements))</span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a><span class="co">#&gt; `summarise()` has grouped output by &#39;Bacteria_strain&#39;, &#39;Phage&#39;. You can</span></span>
<span id="cb12-5"><a href="#cb12-5" tabindex="-1"></a><span class="co">#&gt; override using the `.groups` argument.</span></span>
<span id="cb12-6"><a href="#cb12-6" tabindex="-1"></a><span class="fu">head</span>(ex_dat_mrg_sum)</span>
<span id="cb12-7"><a href="#cb12-7" tabindex="-1"></a><span class="co">#&gt; # A tibble: 6 × 4</span></span>
<span id="cb12-8"><a href="#cb12-8" tabindex="-1"></a><span class="co">#&gt; # Groups:   Bacteria_strain, Phage [6]</span></span>
<span id="cb12-9"><a href="#cb12-9" tabindex="-1"></a><span class="co">#&gt;   Bacteria_strain Phage       Well    auc</span></span>
<span id="cb12-10"><a href="#cb12-10" tabindex="-1"></a><span class="co">#&gt;   &lt;chr&gt;           &lt;chr&gt;       &lt;fct&gt; &lt;dbl&gt;</span></span>
<span id="cb12-11"><a href="#cb12-11" tabindex="-1"></a><span class="co">#&gt; 1 Strain 1        No Phage    A1    15.9 </span></span>
<span id="cb12-12"><a href="#cb12-12" tabindex="-1"></a><span class="co">#&gt; 2 Strain 1        Phage Added A7     1.07</span></span>
<span id="cb12-13"><a href="#cb12-13" tabindex="-1"></a><span class="co">#&gt; 3 Strain 10       No Phage    B4    20.4 </span></span>
<span id="cb12-14"><a href="#cb12-14" tabindex="-1"></a><span class="co">#&gt; 4 Strain 10       Phage Added B10    6.15</span></span>
<span id="cb12-15"><a href="#cb12-15" tabindex="-1"></a><span class="co">#&gt; 5 Strain 11       No Phage    B5    20.9 </span></span>
<span id="cb12-16"><a href="#cb12-16" tabindex="-1"></a><span class="co">#&gt; 6 Strain 11       Phage Added B11    7.77</span></span></code></pre></div>
</div>
<div id="diauxie" class="section level1">
<h1>Diauxic shifts</h1>
<p>Bacteria frequently exhibit a second, slower, burst of growth after
their first period of rapid growth. This is common in growth curves and
is called <em>diauxic growth</em>.</p>
<p>If we plot the data from some of our example data wells with no phage
added, we’ll see this pattern repeatedly:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a>nophage_wells <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;A1&quot;</span>, <span class="st">&quot;A4&quot;</span>, <span class="st">&quot;E2&quot;</span>, <span class="st">&quot;F1&quot;</span>)</span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(ex_dat_mrg, Well <span class="sc">%in%</span> nophage_wells),</span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> Time, <span class="at">y =</span> Measurements)) <span class="sc">+</span></span>
<span id="cb13-4"><a href="#cb13-4" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb13-5"><a href="#cb13-5" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Well, <span class="at">scales =</span> <span class="st">&quot;free&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAABDlBMVEUAAAAAADoAAGYAOpAAZrYZGT8ZGWIZP4EZYp8aGhozMzM6AAA6ADo6AGY6kNs/GRk/GT8/GWI/P2I/P4E/gb1NTU1NTW5NTY5NbqtNjshiGRliGT9iPxliP4FiYmJin9lmAABmADpmtv9uTU1uTW5uTY5ubqtuq8huq+SBPxmBPz+BP2KBn4GBvZ+Bvb2BvdmOTU2OTW6OTY6ObquOyP+QOgCQtpCQ2/+fYhmf2dmrbk2rbm6rbo6rjk2ryKur5P+2ZgC2//+9gT+92dnIjk3I///Zn2LZvYHZ2Z/Z2b3Z2dnbkDrb/7bb///kq27k///r6+v/tmb/yI7/25D/5Kv//7b//8j//9v//+T///+PxA2pAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAPVElEQVR4nO2dC3fVxhHHFR4pLpQ0re2Gpi0USBvStNAWF0IfGGMwtpukNsa2vv8XqVZaaXclrWZmd/ZxuTvn4Hvx2XP190+zr7mj2aoutmhVagG5WwEEWAEEWAEEWAEEWAEEmDOgo5CWkYQCCJBQAAESCiBAQgEESCiAAAkFECChAAIkFECAhAiA3n35uH09+Pw7qjpuCYeP7lIlRAD09neb7cvGp8kASQlHexsZAjr85s+/fX109Pz6t8k8SEo4OvjFbzIEdPDL189bWem6mJRw+M1fcuxie5tHb2+0MpMBkhL2NnMcgw4fbWx0o08yQFJC40c5AmpkNQOQ0JUMkJSwtyFskyghOKA9wabtY8kAKQkZetDhnwSVdh2SCpAmIUNAbpaRhAIIkFAAARIKIEBC7oDOvnrTvT7Y2npa1z9sbW396k1ugEYiO/tfY+0P5BtS28FOJY7zv76szx6+rPefarqiSEAAGouMqG5/+z/dzTm9I/739PKfLzVhmQAai4ypTnlvd4POn2xJJ/5pY/C9ZTBKF6s7L4qoTr/25YuvWwdWXpSJB41FBlZXWTzo/El/aWYnrqbmDEiJDASoEzcH6OzBMDxzAdJwMHmQJjIIICl2DpC89OkXP9aX/3rDIKEjw9vFDD7sgIRgyyDd/BPrHzE8N6/bL/0lDHeCD5AmMgQg09ERmnwk9HjYALGqm30zuqGumnBG+5MzADQMPXE8aHHoydCDtKEnBqBuDo8BiMcqn+s7AKrQbQeFEdWN3/R9K5oHwZNXPoCqamEu0S7Tr8GaXVizBupf3CQgJq9MAFXASKCu0kcSLl80a6A7/YuThKY3rwKgSrkOQt0QSTj/W7sUky9kCdC6ORtA1dycheliZ3/4UUQS5EtNCyh4zQQxAVn2hRhAYhPWkJEvFAmV6lqBPEiNi2cPVDw4zhRi9yCkBGOwCwNIjYvnT5p3wxxCvCJm/7MAyHEMMpcRYQApTeTbZwByUjcAEpG6dhb7mjKLjbd4QQApLG4jJPIy1st3kQS3dVAUQGpcbLvYtpMHuc6xywZ92mQPHASQ1rGaQfqPThFz5AZxNQGZ46L4HxkQdnanAgKMZx+OmMX6cVH4kdM6PxQg4NMm82YYD5LjonCi0y2nnSI6xMALaDpvBgLkpG46EhRAIQANs7r2rYZazX8cgMZTCUWdGd0QCw58dsdcJDcqIKz5XMCYQcUcQcjuSA4Ie0UfDzI2N8KVCNkdXHc+a0B6dKN9xWd3zK3ds/Qgr2CM7kGnwwoDlbywHoD0MWh/SCwpgLRZbIhudB0Lnd0xu/vLEVDlp06t4mVPw2Z3xASkQjCXL8i5J56AnO9RREDaYq3p/Ke0kGvlqW4VAKmBUoU6MgFkN8blLynk+m/ZxdAh17DrdDtlS95hEA9SizWRgidwQerUG+/vXFYB0FzQvgDSTBuD/l4AzZi2WNsndjEzMdNFnVpiyEAQ7msfW9pREED6Yu0J7atnb0DmEqMeB4gyAWSxGIBU95ZbeORXzysCyP+LcTUtyEAQ8stdztVF1oC0JUYXCEKmv2ThQbD5f7S5sGjGIeRKIwtA4IUYMgfMIacB9FGNQQyA1BJDBoKQ6S9rA0hbYshAUI7rIEdALKkVbhJsX1WuHSCbsU48qwzI9iGRPUh1+9MtwlZjbQCp7U87Vt5Za0Af7t3/cK+68kr/nbn0wOfgpgNk/S7XH9Dutfr4yqvja/rvzMVr50GIkCvPQGkksU+Km0QH1DjQxc61+sRwIX37c/YA/bUPS/6blsROKG4SFNCHe7dHgEwPwkYUebKXVPemFDcJB+hi5/bJJ89ER9Nssh+KCGhyczDpL8zbb+Pj3t+srtW7V7/Xf2fuh5AexJS9ZFwRW9xk4UFGBwmkkCu+7AETIN2D0MVNAgJqxiDxYo5BNosBSOve+OImqwCIKzlHdW98cZOFx4o8AR0P5XOMQTolINW98cVNwgEaPMjbYhUriA7IX133hi/3hC5h6aFhf0DNNC/Mcwxi/N6Xbuzeay4UUaNPZ9Y/kTPeSZawXFXKRYLzGLSOgC52Vh0QUPHCF9D8CkiFHDBfKVifjndSN7k2ICEwoA/3qukgrUIOmNQK3mXs5NqQhNAeNGdmEudiRLFaKrDiom5y7WUJUOmLMICWnpsfFbCEPopsk2svS2C/fnsB43/NduP+sRnuUCEHh8oinrdvcu34EkYx6av/7aKumvkkcfqqW/CgJIDakOv90VxGGIPY1RHHoDSAVMjBTK0QNg16In5DaDK5dnwJZhc7Fl1MxO11M5I41SIkirrJteNLMAfpEzEZ3B43tlpwdRlI8JobC6Bi7vGgdTHneNC6WIiY9EdlzvGgdTE4HmSzyZLEzE0R1i569XbtL7RmMqllOcslrQTnQdoMzbRm5KbUslKt3q4rXauayaQWIMslrYRRdgdGl/xkM+ujrkelWfpKtVq77hdaM5nUAmS5pJXgPEiPnqOo9dIsQxtRBFFvJzcNerPJHt3IckkvwXmQNkMz7aUfjgv8tIXPvhipM5uJ7SeQ5ZJWgjkG/Qw/SE9vX2vGIDB7+4xmbVILkOWSVgIYtLfZdACYV2e0G6vrkjaALJe0Epz3YtPQjJmb0osx2vUOL5tJLUCWS1oJ7pvV2UXItuHw1kWIbNYntcwVu9tGTGQxJIBB+3U3MGi/7gbGpNfdCiDA4KD9mptX0H4drMSkASsBM8Ccd/NRTqLOQMJokMavEaOoy0CC82Y1iroMJDgP0lHUZSChAAIklC4GSJh60IffP8tGXQYSZrrYCWoui6IuAwlzgEoXO1oEtMvpQQefbTR2/XH75i5VHQ+gTsOmePf5d1QJM4P0J5xjUC/p3ZcNo58/JqpjAtRjebvxqRcgkhHFvb3R/HiOdaEwgJ5f/9bPg0ICEia8iKaOF5B3F5ut/uILqO3/P3ndvD18tElVxwRIaLjRvvMENFf9xRfQIOndr9F8cvWg2eovXIAOPkPPYTkDmlZ/YQJE4pMroNnqL76A2jFo4+5e90JUlxmg2eovvuqcjBeQl4QS7gAkFECABOckzijqMpAwGqQvdu5r3230yUZzyblR1GUGSKDZva3iQacSx2xybhR16h7NPS8WRcIY0LFaKHYpszWtBB3v85DDPUI+Nx/4kUyxAmroqG/HtARAZAk6ZhvuUR7PrLaZ5LtaPEhpwZag4/agIbPS9tx8cFuc5tUZp9gSdFRA1dRmAUV9bt6QgAKEL0GHVafRcPOgYICkKAugURKnmTmMPoERUtf7ib3tBFCkMai/ZdZBepTE2aapU0rQYdRV1lqrC4Bmn5tnBtTSoRcWsJmjuqUCMTZAtufmWQGNurs/IDdjLdHCCWhcGEop1q9ISeJ0Urc89Mx5UCRA0/LXs4AoSZwO6qACSMkAzfR7CyCC0dXZqps5A+KyRQbRACEmrzQeNL/kwAFa2koT1WEmr0SAliUsAeLbSldLJVbTAoIW8wOgi51hNzQOd3guY6F1c1JA1rKPE0BiBhunSTNspUMVpxPGAMh+gsLwB+hX3B0x8t1KV1Wq49SRgBbqYs4C6jqaYuS5lWY8iFbbDoInswQF1DIathpeW+nx5sYBkDktCA/GnMyCB7RUONTuQVqCmc9WmuPwI+OWCOflDYsvVi+fA2TSqf220hyAjE4t7g1rWBw3e+izGC45UVoMQPq00L6yhsWXi3NPAE3XQV6AWE6H0j3odHBerrA4ERCzsXyuPgbt918bsIXFUfco1GaV53QobVroOhZbWNy2BVsxQHqp0q6n8YTF0wNiOvzI6x4tS7DsUUmAPJaxawHIZxmbPSAwuokA5LGMZTsdKpQRBhZ7U49lbKRqBe4eRPju0v63eCxjI3mQMyD7Jp4CyH0Zm/L4rIiA3JexuQMiffu9NIu5LmPXBJD7MjZzQKhvWDCAXNUxnlCnIlBykcqR3fERAdLWqvtPR7/IHpDd+D5SzRNyecGSYfYReZBaachFKkeWK/EvzhqQWqvKRSpHlutiIDGGBzGecTgq97v/lCHLlZrDlTWgyVn3DGMQIyDHOZYRkHnWfbNI9c9yJSe5oeJBpDmW8xjRyVn3vusgKE5GAeQ6xyY9iDYmINc5Nl7pSjoghzRJTDyINsfm7EGsgFzn2HiAyObi3MiYNGGOzdiDXBJtMfEg2hybLyBEIJECyHGOZT0MO29AbuoKIMAiFqjOG5Dt8wOdNz9X24D4sW7J/lkDAg4eW0lA9sxsB3XAwWO0j3V8GiJrQAsHj9Ejio5/KSrcQRgAWAEBB4+RPhYXSKR4kNsAEMyDPGsbOD9Pg9lqEAaAhdx+B3XAwWOJATkNALyrIODgMQIgbCCRAshpAOD1ILXb8axtgI6TuXoQegBgBrRsiQG5DABLj88kBISPk9FmMfoAkCcgQhiIAshlAFgvQA7q4gLCmtfUygpo8Qk1fkDIT6u8JLAuXCIfVob7Wz2fK+b0oOUHsFzU+QMyiiYVQJM3/g9eMwICnlBLAIjhwWtcuAP3UG8AQFQJ5ptJVSleQCrcgStuAj2h5qCOKkF/owrahQKkthqowgJQeSkXdUQJmpZqbjxkBqQ2q9biJnoBTevneBhRQhAtmHBH1Dqh+u3LQIKbB8VSl4EEvjEohLoMJKDCHbPFTYRN466I3xCaZCAB+bTPzCIkiroMJHiN+MHVZSChAAKaRI5QrJ4VQIAVQIAVQIAVQIC5A5osScz0GGHtoldv1/5CaybzapYTbdJKcAZkhmZaM9JjalksV2/XVc9VzWReDZBok1aCM6BRIn5dj6rD9MVytXbdL7RmMq8GSLRJK8EZ0OhRjlqvDjO0EXUY9XZy06A3m+zRjUSb9BKcAZmhmfbSD8c1hoQYo10r12gmtp9Aok1aCYwe1JoxCMzePqNZm1cDJNqklcA4Bs2rM9qN1XV5I0CiTVoJHrPYODRjpsf0Yox2vcPLZlILkGiTVgLzOmjbcHjrIkQ26/Nq5urtbSMmshgSykoasAIIsAIIsAIIsAIIsAIIsEwBDfXRr72/RSkkz2+ZAhKWGk1nBRBg2QNqfr6/9Y+bVXVbHPZ+v+t9AU9hHNtKALp59fv6uBI/rrxqTznVzoINbasBqHGc7setZ+0ZnuIwz0i2EoDEm/7HcTe74U6qZLDVAxSvd7W2coBOSAfs+NvKAbrYaVwoIqWVA9RO8xG9KGNAeVgBBFgBBFgBBFgBBFgBBFgBBFgBBFgBBFgBBNj/Acid73Pir5NQAAAAAElFTkSuQmCC" /><!-- --></p>
<p>We can identify the time when bacteria switch from their first period
of rapid growth to their second period by finding a minima in the
derivative values. Specifically, we want to identify the second minima
(the first minima will occur at the beginning of the growth curve, when
bacteria are just starting to grow). Let’s look at some of the
derivative values to see this.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(ex_dat_mrg, Well <span class="sc">%in%</span> nophage_wells),</span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> Time, <span class="at">y =</span> deriv)) <span class="sc">+</span></span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb14-4"><a href="#cb14-4" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Well, <span class="at">scales =</span> <span class="st">&quot;free&quot;</span>)</span>
<span id="cb14-5"><a href="#cb14-5" tabindex="-1"></a><span class="co">#&gt; Warning: Removed 1 row containing missing values (`geom_line()`).</span></span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>We can use the <code>gcplyr</code> function
<code>find_local_extrema</code> to find that minima. Specify
<code>deriv</code> as the y data and <code>Time</code> as the x data,
and that we want <code>find_local_extrema</code> to <code>return</code>
the <code>x</code> values associated with local minima. It will return a
vector of those <code>x</code> values, and we’re going to save just the
second one.</p>
<p>At the same time, we’re also going to save the density where the
diauxic shift occurs. First, we’ll use <code>find_local_extrema</code>
again, but this time to save the <em>index</em> where the diauxic shift
occurs to a column titled <code>diauxie_idx</code>. Then, we can get the
<code>Measurements</code> value at that index. (Note that it wouldn’t
work to just specify <code>return = &quot;y&quot;</code>, because the
<code>y</code> values in this case are the <code>deriv</code> values).
(<code>extr_val</code> works just like <code>R</code>’s built-in
<code>[</code>, but with better default settings for growth curve
analyses with <code>summarize</code>).</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a>ex_dat_mrg_sum <span class="ot">&lt;-</span></span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="fu">group_by</span>(ex_dat_mrg, Bacteria_strain, Phage, Well),</span>
<span id="cb15-3"><a href="#cb15-3" tabindex="-1"></a>    <span class="at">diauxie_time =</span> <span class="fu">find_local_extrema</span>(<span class="at">x =</span> Time, <span class="at">y =</span> deriv, <span class="at">return =</span> <span class="st">&quot;x&quot;</span>,</span>
<span id="cb15-4"><a href="#cb15-4" tabindex="-1"></a>                                   <span class="at">return_maxima =</span> <span class="cn">FALSE</span>, <span class="at">return_minima =</span> <span class="cn">TRUE</span>,</span>
<span id="cb15-5"><a href="#cb15-5" tabindex="-1"></a>                                   <span class="at">window_width_n =</span> <span class="dv">39</span>)[<span class="dv">2</span>],</span>
<span id="cb15-6"><a href="#cb15-6" tabindex="-1"></a>    <span class="at">diauxie_idx =</span> <span class="fu">find_local_extrema</span>(<span class="at">x =</span> Time, <span class="at">y =</span> deriv, <span class="at">return =</span> <span class="st">&quot;index&quot;</span>,</span>
<span id="cb15-7"><a href="#cb15-7" tabindex="-1"></a>                                   <span class="at">return_maxima =</span> <span class="cn">FALSE</span>, <span class="at">return_minima =</span> <span class="cn">TRUE</span>,</span>
<span id="cb15-8"><a href="#cb15-8" tabindex="-1"></a>                                   <span class="at">window_width_n =</span> <span class="dv">39</span>)[<span class="dv">2</span>],</span>
<span id="cb15-9"><a href="#cb15-9" tabindex="-1"></a>    <span class="at">diauxie_dens =</span> <span class="fu">extr_val</span>(Measurements, diauxie_idx))</span>
<span id="cb15-10"><a href="#cb15-10" tabindex="-1"></a><span class="co">#&gt; `summarise()` has grouped output by &#39;Bacteria_strain&#39;, &#39;Phage&#39;. You can</span></span>
<span id="cb15-11"><a href="#cb15-11" tabindex="-1"></a><span class="co">#&gt; override using the `.groups` argument.</span></span>
<span id="cb15-12"><a href="#cb15-12" tabindex="-1"></a><span class="fu">head</span>(ex_dat_mrg_sum)</span>
<span id="cb15-13"><a href="#cb15-13" tabindex="-1"></a><span class="co">#&gt; # A tibble: 6 × 6</span></span>
<span id="cb15-14"><a href="#cb15-14" tabindex="-1"></a><span class="co">#&gt; # Groups:   Bacteria_strain, Phage [6]</span></span>
<span id="cb15-15"><a href="#cb15-15" tabindex="-1"></a><span class="co">#&gt;   Bacteria_strain Phage       Well  diauxie_time diauxie_idx diauxie_dens</span></span>
<span id="cb15-16"><a href="#cb15-16" tabindex="-1"></a><span class="co">#&gt;   &lt;chr&gt;           &lt;chr&gt;       &lt;fct&gt;        &lt;dbl&gt;       &lt;int&gt;        &lt;dbl&gt;</span></span>
<span id="cb15-17"><a href="#cb15-17" tabindex="-1"></a><span class="co">#&gt; 1 Strain 1        No Phage    A1           16             65        1.01 </span></span>
<span id="cb15-18"><a href="#cb15-18" tabindex="-1"></a><span class="co">#&gt; 2 Strain 1        Phage Added A7            9             37        0.379</span></span>
<span id="cb15-19"><a href="#cb15-19" tabindex="-1"></a><span class="co">#&gt; 3 Strain 10       No Phage    B4            9.75          40        0.999</span></span>
<span id="cb15-20"><a href="#cb15-20" tabindex="-1"></a><span class="co">#&gt; 4 Strain 10       Phage Added B10           9.25          38        0.682</span></span>
<span id="cb15-21"><a href="#cb15-21" tabindex="-1"></a><span class="co">#&gt; 5 Strain 11       No Phage    B5            9.5           39        1.01 </span></span>
<span id="cb15-22"><a href="#cb15-22" tabindex="-1"></a><span class="co">#&gt; 6 Strain 11       Phage Added B11           5.5           23        0.346</span></span>
<span id="cb15-23"><a href="#cb15-23" tabindex="-1"></a></span>
<span id="cb15-24"><a href="#cb15-24" tabindex="-1"></a><span class="co"># Plot data with a point at the moment of diauxic shift</span></span>
<span id="cb15-25"><a href="#cb15-25" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(ex_dat_mrg, Well <span class="sc">%in%</span> nophage_wells),</span>
<span id="cb15-26"><a href="#cb15-26" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> Time, <span class="at">y =</span> Measurements)) <span class="sc">+</span></span>
<span id="cb15-27"><a href="#cb15-27" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb15-28"><a href="#cb15-28" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Well, <span class="at">scales =</span> <span class="st">&quot;free&quot;</span>) <span class="sc">+</span></span>
<span id="cb15-29"><a href="#cb15-29" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(ex_dat_mrg_sum, Well <span class="sc">%in%</span> nophage_wells), </span>
<span id="cb15-30"><a href="#cb15-30" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x =</span> diauxie_time, <span class="at">y =</span> diauxie_dens),</span>
<span id="cb15-31"><a href="#cb15-31" tabindex="-1"></a>             <span class="at">size =</span> <span class="dv">2</span>, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>If needed, you can tune the sensitivity of
<code>find_local_extrema</code> to different heights and widths of peaks
and valleys using the <code>window_width</code>,
<code>window_width_n</code>, and <code>window_height</code>
arguments.</p>
</div>
<div id="diauxic_percap" class="section level1">
<h1>Growth rate during diauxie</h1>
<p>In the previous section we identified when bacteria shifted into
their second period of rapid growth (‘diauxic growth’). If you want to
find out what the peak per-capita growth rate was during that second
burst, we’ll have to use <code>max</code> on the subset of data after
the diauxic shift identified by <code>find_local_extrema</code></p>
<p>Just as we did in the previous section, we’ll use
<code>find_local_extrema</code> to save the time when the diauxic shift
occurs. Then, we’ll find the maximum of the per-capita derivative after
that shift occurs. Finally, we’ll find the time when that post-diauxie
maximum growth rate occurs. Note that we’re using <code>max_gc</code>
and <code>which_max_gc</code>, which work just like <code>R</code>’s
built-in <code>max</code> and <code>which.max</code>, but with better
default settings for growth curve analyses with
<code>summarize</code>.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a>ex_dat_mrg_sum <span class="ot">&lt;-</span></span>
<span id="cb16-2"><a href="#cb16-2" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb16-3"><a href="#cb16-3" tabindex="-1"></a>    <span class="fu">group_by</span>(ex_dat_mrg, Bacteria_strain, Phage, Well),</span>
<span id="cb16-4"><a href="#cb16-4" tabindex="-1"></a>    <span class="at">diauxie_time =</span> </span>
<span id="cb16-5"><a href="#cb16-5" tabindex="-1"></a>      <span class="fu">find_local_extrema</span>(<span class="at">x =</span> Time, <span class="at">y =</span> deriv, <span class="at">return =</span> <span class="st">&quot;x&quot;</span>,</span>
<span id="cb16-6"><a href="#cb16-6" tabindex="-1"></a>                         <span class="at">return_maxima =</span> <span class="cn">FALSE</span>, <span class="at">return_minima =</span> <span class="cn">TRUE</span>,</span>
<span id="cb16-7"><a href="#cb16-7" tabindex="-1"></a>                         <span class="at">window_width_n =</span> <span class="dv">39</span>)[<span class="dv">2</span>],</span>
<span id="cb16-8"><a href="#cb16-8" tabindex="-1"></a>    <span class="at">diauxie_percap =</span> <span class="fu">max_gc</span>(deriv_percap5[Time <span class="sc">&gt;=</span> diauxie_time]),</span>
<span id="cb16-9"><a href="#cb16-9" tabindex="-1"></a>    <span class="at">diauxie_percap_time =</span> </span>
<span id="cb16-10"><a href="#cb16-10" tabindex="-1"></a>      <span class="fu">extr_val</span>(Time[Time <span class="sc">&gt;=</span> diauxie_time],</span>
<span id="cb16-11"><a href="#cb16-11" tabindex="-1"></a>               <span class="fu">which_max_gc</span>(deriv_percap5[Time <span class="sc">&gt;=</span> diauxie_time]))</span>
<span id="cb16-12"><a href="#cb16-12" tabindex="-1"></a>  )</span>
<span id="cb16-13"><a href="#cb16-13" tabindex="-1"></a><span class="co">#&gt; `summarise()` has grouped output by &#39;Bacteria_strain&#39;, &#39;Phage&#39;. You can</span></span>
<span id="cb16-14"><a href="#cb16-14" tabindex="-1"></a><span class="co">#&gt; override using the `.groups` argument.</span></span>
<span id="cb16-15"><a href="#cb16-15" tabindex="-1"></a><span class="fu">head</span>(ex_dat_mrg_sum)</span>
<span id="cb16-16"><a href="#cb16-16" tabindex="-1"></a><span class="co">#&gt; # A tibble: 6 × 6</span></span>
<span id="cb16-17"><a href="#cb16-17" tabindex="-1"></a><span class="co">#&gt; # Groups:   Bacteria_strain, Phage [6]</span></span>
<span id="cb16-18"><a href="#cb16-18" tabindex="-1"></a><span class="co">#&gt;   Bacteria_strain Phage       Well  diauxie_time diauxie_percap diauxie_percap…¹</span></span>
<span id="cb16-19"><a href="#cb16-19" tabindex="-1"></a><span class="co">#&gt;   &lt;chr&gt;           &lt;chr&gt;       &lt;fct&gt;        &lt;dbl&gt;          &lt;dbl&gt;            &lt;dbl&gt;</span></span>
<span id="cb16-20"><a href="#cb16-20" tabindex="-1"></a><span class="co">#&gt; 1 Strain 1        No Phage    A1           16            0.0257             20  </span></span>
<span id="cb16-21"><a href="#cb16-21" tabindex="-1"></a><span class="co">#&gt; 2 Strain 1        Phage Added A7            9            0.832              19.8</span></span>
<span id="cb16-22"><a href="#cb16-22" tabindex="-1"></a><span class="co">#&gt; 3 Strain 10       No Phage    B4            9.75         0.0398             13.2</span></span>
<span id="cb16-23"><a href="#cb16-23" tabindex="-1"></a><span class="co">#&gt; 4 Strain 10       Phage Added B10           9.25         1.24               17.8</span></span>
<span id="cb16-24"><a href="#cb16-24" tabindex="-1"></a><span class="co">#&gt; 5 Strain 11       No Phage    B5            9.5          0.0438             12.2</span></span>
<span id="cb16-25"><a href="#cb16-25" tabindex="-1"></a><span class="co">#&gt; 6 Strain 11       Phage Added B11           5.5          1.43               12.8</span></span>
<span id="cb16-26"><a href="#cb16-26" tabindex="-1"></a><span class="co">#&gt; # … with abbreviated variable name ¹​diauxie_percap_time</span></span>
<span id="cb16-27"><a href="#cb16-27" tabindex="-1"></a></span>
<span id="cb16-28"><a href="#cb16-28" tabindex="-1"></a><span class="co"># Plot data with a point at the moment of peak diauxic growth rate</span></span>
<span id="cb16-29"><a href="#cb16-29" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(ex_dat_mrg, Well <span class="sc">%in%</span> nophage_wells),</span>
<span id="cb16-30"><a href="#cb16-30" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> Time, <span class="at">y =</span> deriv_percap5)) <span class="sc">+</span></span>
<span id="cb16-31"><a href="#cb16-31" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb16-32"><a href="#cb16-32" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Well, <span class="at">scales =</span> <span class="st">&quot;free&quot;</span>) <span class="sc">+</span></span>
<span id="cb16-33"><a href="#cb16-33" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(ex_dat_mrg_sum, Well <span class="sc">%in%</span> nophage_wells), </span>
<span id="cb16-34"><a href="#cb16-34" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x =</span> diauxie_percap_time, <span class="at">y =</span> diauxie_percap),</span>
<span id="cb16-35"><a href="#cb16-35" tabindex="-1"></a>             <span class="at">size =</span> <span class="dv">2</span>, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>)</span>
<span id="cb16-36"><a href="#cb16-36" tabindex="-1"></a><span class="co">#&gt; Warning: Removed 4 rows containing missing values (`geom_line()`).</span></span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="peak_dens" class="section level1">
<h1>Peak bacterial density</h1>
<p><a href="#maxdens">We previously found the global maximum in
bacterial density</a> using the simple <code>max_gc</code> and
<code>which_max_gc</code> functions. The first <em>local</em> maxima can
also be of interest. This is especially true when bacteria are grown
with phages, where their first peak density can act as a proxy measure
for their susceptibility to the phage. If you’re interested in finding
the first local maxima in bacterial density, you can use the
<code>gcplyr</code> function <code>first_maxima</code>.</p>
<p><code>first_maxima</code> simply requires the <code>y</code> data you
want to identify the peak in. Specify <code>Measurements</code> as the y
data and <code>Time</code> as the x data, and that we want
<code>first_peak</code> to <code>return</code> the <code>x</code> and
<code>y</code> values associated with the peak. We’ll save those in
columns <code>first_maxima_x</code> and <code>first_maxima_y</code>,
respectively.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a>ex_dat_mrg_sum <span class="ot">&lt;-</span></span>
<span id="cb17-2"><a href="#cb17-2" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="fu">group_by</span>(ex_dat_mrg, Bacteria_strain, Phage, Well),</span>
<span id="cb17-3"><a href="#cb17-3" tabindex="-1"></a>            <span class="at">first_maxima_x =</span> <span class="fu">first_maxima</span>(<span class="at">x =</span> Time, <span class="at">y =</span> Measurements, </span>
<span id="cb17-4"><a href="#cb17-4" tabindex="-1"></a>                                          <span class="at">return =</span> <span class="st">&quot;x&quot;</span>),</span>
<span id="cb17-5"><a href="#cb17-5" tabindex="-1"></a>            <span class="at">first_maxima_y =</span> <span class="fu">first_maxima</span>(<span class="at">x =</span> Time, <span class="at">y =</span> Measurements, </span>
<span id="cb17-6"><a href="#cb17-6" tabindex="-1"></a>                                          <span class="at">return =</span> <span class="st">&quot;y&quot;</span>))</span>
<span id="cb17-7"><a href="#cb17-7" tabindex="-1"></a><span class="co">#&gt; `summarise()` has grouped output by &#39;Bacteria_strain&#39;, &#39;Phage&#39;. You can</span></span>
<span id="cb17-8"><a href="#cb17-8" tabindex="-1"></a><span class="co">#&gt; override using the `.groups` argument.</span></span>
<span id="cb17-9"><a href="#cb17-9" tabindex="-1"></a><span class="fu">head</span>(ex_dat_mrg_sum)</span>
<span id="cb17-10"><a href="#cb17-10" tabindex="-1"></a><span class="co">#&gt; # A tibble: 6 × 5</span></span>
<span id="cb17-11"><a href="#cb17-11" tabindex="-1"></a><span class="co">#&gt; # Groups:   Bacteria_strain, Phage [6]</span></span>
<span id="cb17-12"><a href="#cb17-12" tabindex="-1"></a><span class="co">#&gt;   Bacteria_strain Phage       Well  first_maxima_x first_maxima_y</span></span>
<span id="cb17-13"><a href="#cb17-13" tabindex="-1"></a><span class="co">#&gt;   &lt;chr&gt;           &lt;chr&gt;       &lt;fct&gt;          &lt;dbl&gt;          &lt;dbl&gt;</span></span>
<span id="cb17-14"><a href="#cb17-14" tabindex="-1"></a><span class="co">#&gt; 1 Strain 1        No Phage    A1             24             1.18 </span></span>
<span id="cb17-15"><a href="#cb17-15" tabindex="-1"></a><span class="co">#&gt; 2 Strain 1        Phage Added A7              8.75          0.499</span></span>
<span id="cb17-16"><a href="#cb17-16" tabindex="-1"></a><span class="co">#&gt; 3 Strain 10       No Phage    B4             19.8           1.21 </span></span>
<span id="cb17-17"><a href="#cb17-17" tabindex="-1"></a><span class="co">#&gt; 4 Strain 10       Phage Added B10             8.5           0.962</span></span>
<span id="cb17-18"><a href="#cb17-18" tabindex="-1"></a><span class="co">#&gt; 5 Strain 11       No Phage    B5             19.5           1.21 </span></span>
<span id="cb17-19"><a href="#cb17-19" tabindex="-1"></a><span class="co">#&gt; 6 Strain 11       Phage Added B11             5.25          0.439</span></span>
<span id="cb17-20"><a href="#cb17-20" tabindex="-1"></a></span>
<span id="cb17-21"><a href="#cb17-21" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(ex_dat_mrg, Well <span class="sc">%in%</span> sample_wells), </span>
<span id="cb17-22"><a href="#cb17-22" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> Time, <span class="at">y =</span> Measurements)) <span class="sc">+</span></span>
<span id="cb17-23"><a href="#cb17-23" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb17-24"><a href="#cb17-24" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Well) <span class="sc">+</span></span>
<span id="cb17-25"><a href="#cb17-25" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(ex_dat_mrg_sum, Well <span class="sc">%in%</span> sample_wells), </span>
<span id="cb17-26"><a href="#cb17-26" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x =</span> first_maxima_x, <span class="at">y =</span> first_maxima_y), </span>
<span id="cb17-27"><a href="#cb17-27" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">&quot;red&quot;</span>, <span class="at">size =</span> <span class="fl">1.5</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Note that you can tune the sensitivity of <code>first_maxima</code>
to different heights and widths of peaks and valleys using the
<code>window_width</code>, <code>window_width_n</code>, and
<code>window_height</code> arguments, although the defaults work much of
the time.</p>
</div>
<div id="extin_time" class="section level1">
<h1>Extinction time</h1>
<p>The time when bacterial density falls below some threshold can also
be of interest. This is especially true when bacteria are grown with
phages, where this ‘extinction time’ can act as a proxy measure for
their susceptibility to the phage. If you’re interested in finding the
extinction time, you can use the <code>gcplyr</code> function
<code>first_below</code>. In this example, we’ll use a Measurements
value of 0.15 as our threshold.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a>ex_dat_mrg_sum <span class="ot">&lt;-</span></span>
<span id="cb18-2"><a href="#cb18-2" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb18-3"><a href="#cb18-3" tabindex="-1"></a>    <span class="fu">group_by</span>(ex_dat_mrg, Bacteria_strain, Phage, Well),</span>
<span id="cb18-4"><a href="#cb18-4" tabindex="-1"></a>    <span class="at">extin_time =</span> <span class="fu">first_below</span>(<span class="at">x =</span> Time, <span class="at">y =</span> Measurements, <span class="at">threshold =</span> <span class="fl">0.15</span>,</span>
<span id="cb18-5"><a href="#cb18-5" tabindex="-1"></a>                             <span class="at">return =</span> <span class="st">&quot;x&quot;</span>, <span class="at">return_endpoints =</span> <span class="cn">FALSE</span>))</span>
<span id="cb18-6"><a href="#cb18-6" tabindex="-1"></a><span class="co">#&gt; `summarise()` has grouped output by &#39;Bacteria_strain&#39;, &#39;Phage&#39;. You can</span></span>
<span id="cb18-7"><a href="#cb18-7" tabindex="-1"></a><span class="co">#&gt; override using the `.groups` argument.</span></span>
<span id="cb18-8"><a href="#cb18-8" tabindex="-1"></a><span class="fu">head</span>(ex_dat_mrg_sum)</span>
<span id="cb18-9"><a href="#cb18-9" tabindex="-1"></a><span class="co">#&gt; # A tibble: 6 × 4</span></span>
<span id="cb18-10"><a href="#cb18-10" tabindex="-1"></a><span class="co">#&gt; # Groups:   Bacteria_strain, Phage [6]</span></span>
<span id="cb18-11"><a href="#cb18-11" tabindex="-1"></a><span class="co">#&gt;   Bacteria_strain Phage       Well  extin_time</span></span>
<span id="cb18-12"><a href="#cb18-12" tabindex="-1"></a><span class="co">#&gt;   &lt;chr&gt;           &lt;chr&gt;       &lt;fct&gt;      &lt;dbl&gt;</span></span>
<span id="cb18-13"><a href="#cb18-13" tabindex="-1"></a><span class="co">#&gt; 1 Strain 1        No Phage    A1         NA   </span></span>
<span id="cb18-14"><a href="#cb18-14" tabindex="-1"></a><span class="co">#&gt; 2 Strain 1        Phage Added A7          9.18</span></span>
<span id="cb18-15"><a href="#cb18-15" tabindex="-1"></a><span class="co">#&gt; 3 Strain 10       No Phage    B4         NA   </span></span>
<span id="cb18-16"><a href="#cb18-16" tabindex="-1"></a><span class="co">#&gt; 4 Strain 10       Phage Added B10         9.71</span></span>
<span id="cb18-17"><a href="#cb18-17" tabindex="-1"></a><span class="co">#&gt; 5 Strain 11       No Phage    B5         NA   </span></span>
<span id="cb18-18"><a href="#cb18-18" tabindex="-1"></a><span class="co">#&gt; 6 Strain 11       Phage Added B11         5.64</span></span>
<span id="cb18-19"><a href="#cb18-19" tabindex="-1"></a></span>
<span id="cb18-20"><a href="#cb18-20" tabindex="-1"></a>phage_wells <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;A7&quot;</span>, <span class="st">&quot;B10&quot;</span>, <span class="st">&quot;F10&quot;</span>, <span class="st">&quot;H8&quot;</span>)</span>
<span id="cb18-21"><a href="#cb18-21" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(ex_dat_mrg, Well <span class="sc">%in%</span> phage_wells),</span>
<span id="cb18-22"><a href="#cb18-22" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> Time, <span class="at">y =</span> Measurements)) <span class="sc">+</span></span>
<span id="cb18-23"><a href="#cb18-23" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb18-24"><a href="#cb18-24" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Well) <span class="sc">+</span></span>
<span id="cb18-25"><a href="#cb18-25" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">data =</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(ex_dat_mrg_sum, Well <span class="sc">%in%</span> phage_wells),</span>
<span id="cb18-26"><a href="#cb18-26" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">xintercept =</span> extin_time), <span class="at">lty =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="whats-next" class="section level1">
<h1>What’s next?</h1>
<p>Now that you’ve analyzed your data, you can read about approaches to
deal with noise in your growth curve data, or you can read some
concluding notes on best practices for running statistics, merging
growth curve analyses with other data, and additional resources for
analyzing growth curves.</p>
<ol style="list-style-type: decimal">
<li>Introduction: <code>vignette(&quot;gcplyr&quot;)</code></li>
<li>Importing and transforming data:
<code>vignette(&quot;import_transform&quot;)</code></li>
<li>Incorporating design information:
<code>vignette(&quot;incorporate_designs&quot;)</code></li>
<li>Pre-processing and plotting your data:
<code>vignette(&quot;preprocess_plot&quot;)</code></li>
<li>Processing your data: <code>vignette(&quot;process&quot;)</code></li>
<li>Analyzing your data: <code>vignette(&quot;analyze&quot;)</code></li>
<li><strong>Dealing with noise:</strong>
<code>vignette(&quot;noise&quot;)</code></li>
<li><strong>Statistics, merging other data, and other
resources:</strong> <code>vignette(&quot;conclusion&quot;)</code></li>
</ol>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
